/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2025-11-13 10:50:11 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class stock_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\r');
      out.write('\n');
 
    String username = (String) session.getAttribute("username");
    Boolean isLoggedIn = (Boolean) session.getAttribute("isLoggedIn");
    String userRole = (String) session.getAttribute("userRole");
    
    if (username == null || isLoggedIn == null || !isLoggedIn) {
        response.sendRedirect(request.getContextPath() + "/login.jsp");
        return;
    }
    
    boolean canManage = "admin".equals(userRole) || "storekeeper".equals(userRole);
    if (!canManage) {
        response.sendRedirect(request.getContextPath() + "/403.jsp");
        return;
    }

      out.write("\r\n");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("    <meta charset=\"UTF-8\">\r\n");
      out.write("    <title>Tồn kho | Bảng điều khiển quản trị</title>\r\n");
      out.write("    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>\r\n");
      out.write("    <meta name=\"description\" content=\"Admin Panel for Web Application\">\r\n");
      out.write("    <meta name=\"keywords\" content=\"Admin, Bootstrap 3, Template, Theme, Responsive\">\r\n");
      out.write("    \r\n");
      out.write("    <!-- bootstrap 3.0.2 -->\r\n");
      out.write("    <link href=\"");
      out.print(request.getContextPath());
      out.write("/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- font Awesome -->\r\n");
      out.write("    <link href=\"");
      out.print(request.getContextPath());
      out.write("/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- Ionicons -->\r\n");
      out.write("    <link href=\"");
      out.print(request.getContextPath());
      out.write("/css/ionicons.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- Theme style -->\r\n");
      out.write("    <link href=\"");
      out.print(request.getContextPath());
      out.write("/css/style.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>\r\n");
      out.write("    <style>\r\n");
      out.write("        .filter-panel {\r\n");
      out.write("            background-color: #f9f9f9;\r\n");
      out.write("            border-radius: 5px;\r\n");
      out.write("            padding: 15px;\r\n");
      out.write("            margin-bottom: 15px;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel .form-control {\r\n");
      out.write("            border-radius: 4px;\r\n");
      out.write("            border: 1px solid #ccc;\r\n");
      out.write("            transition: border-color 0.3s ease;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel .btn {\r\n");
      out.write("            border-radius: 4px;\r\n");
      out.write("            transition: all 0.3s ease;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel .btn:hover {\r\n");
      out.write("            transform: translateY(-1px);\r\n");
      out.write("            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel .form-control:focus {\r\n");
      out.write("            border-color: #3c8dbc;\r\n");
      out.write("            box-shadow: 0 0 5px rgba(60, 141, 188, 0.3);\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel label {\r\n");
      out.write("            font-weight: bold;\r\n");
      out.write("            color: #333;\r\n");
      out.write("            margin-bottom: 5px;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel .btn-warning {\r\n");
      out.write("            background-color: #f0ad4e;\r\n");
      out.write("            border-color: #eea236;\r\n");
      out.write("            color: #fff;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        .filter-panel .btn-warning:hover {\r\n");
      out.write("            background-color: #ec971f;\r\n");
      out.write("            border-color: #d58512;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        /* Responsive cho filter panel */\r\n");
      out.write("        @media (max-width: 768px) {\r\n");
      out.write("            .filter-panel .col-md-3,\r\n");
      out.write("            .filter-panel .col-md-4,\r\n");
      out.write("            .filter-panel .col-md-1 {\r\n");
      out.write("                margin-bottom: 10px;\r\n");
      out.write("            }\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        @media (max-width: 992px) {\r\n");
      out.write("            .filter-panel .col-md-3,\r\n");
      out.write("            .filter-panel .col-md-4 {\r\n");
      out.write("                margin-bottom: 10px;\r\n");
      out.write("            }\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        body {\r\n");
      out.write("            background: #f5f6f8;\r\n");
      out.write("        }\r\n");
      out.write("        #stockTable img {\r\n");
      out.write("            object-fit: cover;\r\n");
      out.write("        }\r\n");
      out.write("    </style>\r\n");
      out.write("    \r\n");
      out.write("    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->\r\n");
      out.write("    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->\r\n");
      out.write("    <!--[if lt IE 9]>\r\n");
      out.write("      <script src=\"https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js\"></script>\r\n");
      out.write("      <script src=\"https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js\"></script>\r\n");
      out.write("    <![endif]-->\r\n");
      out.write("</head>\r\n");
      out.write("<body class=\"skin-black\">\r\n");
      out.write("    <header class=\"header\">\r\n");
      out.write("      <a href=\"");
      out.print(request.getContextPath());
      out.write("/admin.jsp\" class=\"logo\">\r\n");
      out.write("        Bảng điều khiển \r\n");
      out.write("      </a>\r\n");
      out.write("      <!-- Header Navbar: style can be found in header.less -->\r\n");
      out.write("      <nav class=\"navbar navbar-static-top\" role=\"navigation\">\r\n");
      out.write("        <!-- Sidebar toggle button-->\r\n");
      out.write("        <a href=\"#\" class=\"navbar-btn sidebar-toggle\" data-toggle=\"offcanvas\" role=\"button\">\r\n");
      out.write("          <span class=\"sr-only\">Toggle navigation</span>\r\n");
      out.write("          <span class=\"icon-bar\"></span>\r\n");
      out.write("          <span class=\"icon-bar\"></span>\r\n");
      out.write("          <span class=\"icon-bar\"></span>\r\n");
      out.write("        </a>\r\n");
      out.write("        <div class=\"navbar-right\">\r\n");
      out.write("          <ul class=\"nav navbar-nav\">\r\n");
      out.write("            <!-- User Account: style can be found in dropdown.less -->\r\n");
      out.write("            <li class=\"dropdown user user-menu\">\r\n");
      out.write("              <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\r\n");
      out.write("                <i class=\"fa fa-user\"></i>\r\n");
      out.write("                <span>");
      out.print( username );
      out.write(" <i class=\"caret\"></i></span>\r\n");
      out.write("              </a>\r\n");
      out.write("              <ul class=\"dropdown-menu dropdown-custom dropdown-menu-right\">\r\n");
      out.write("                <li class=\"dropdown-header text-center\">Tài khoản</li>\r\n");
      out.write("                <li>\r\n");
      out.write("                  <a href=\"profile.jsp\">\r\n");
      out.write("                  <i class=\"fa fa-user fa-fw pull-right\"></i>\r\n");
      out.write("                    Hồ sơ\r\n");
      out.write("                  </a>\r\n");
      out.write("                  <a href=\"settings.jsp\">\r\n");
      out.write("                  <i class=\"fa fa-cog fa-fw pull-right\"></i>\r\n");
      out.write("                    Cài đặt\r\n");
      out.write("                  </a>\r\n");
      out.write("                </li>\r\n");
      out.write("                <li class=\"divider\"></li>\r\n");
      out.write("                <li>\r\n");
      out.write("                  <a href=\"");
      out.print(request.getContextPath());
      out.write("/logout\"><i class=\"fa fa-ban fa-fw pull-right\"></i> Đăng xuất</a>\r\n");
      out.write("                </li>\r\n");
      out.write("              </ul>\r\n");
      out.write("            </li>\r\n");
      out.write("          </ul>\r\n");
      out.write("        </div>\r\n");
      out.write("      </nav>\r\n");
      out.write("    </header>\r\n");
      out.write("    <div class=\"wrapper row-offcanvas row-offcanvas-left\">\r\n");
      out.write("        <!-- Left side column. contains the logo and sidebar -->\r\n");
      out.write("\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "partials/sidebar.jsp", out, false);
      out.write("\r\n");
      out.write("        <aside class=\"right-side\">\r\n");
      out.write("            <!-- Main content -->\r\n");
      out.write("            <section class=\"content\">\r\n");
      out.write("                <div class=\"row\">\r\n");
      out.write("                    <div class=\"col-xs-12\">\r\n");
      out.write("                        <div class=\"panel\">\r\n");
      out.write("                            <header class=\"panel-heading\">\r\n");
      out.write("                                <h3 style=\"display: inline-block; margin: 0;\"><i class=\"fa fa-cubes\"></i> Tồn kho</h3>\r\n");
      out.write("                                <div class=\"panel-tools\" style=\"float: right;\">\r\n");
      out.write("                                    <a class=\"btn btn-default btn-sm\" href=\"");
      out.print(request.getContextPath());
      out.write("/inventory.jsp\">\r\n");
      out.write("                                        <i class=\"fa fa-arrow-left\"></i> Quay lại\r\n");
      out.write("                                    </a>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </header>\r\n");
      out.write("                            <!-- Phần lọc tồn kho -->\r\n");
      out.write("                            <div class=\"panel-body filter-panel\">\r\n");
      out.write("                                <div class=\"row\">\r\n");
      out.write("                                    <div class=\"col-md-12\">\r\n");
      out.write("                                        <div class=\"row\">\r\n");
      out.write("                                            <!-- Lọc theo danh mục -->\r\n");
      out.write("                                            <div class=\"col-md-4\">\r\n");
      out.write("                                                <div class=\"form-group\">\r\n");
      out.write("                                                    <label for=\"filterCategory\" style=\"font-weight: bold; margin-bottom: 5px;\">Danh mục:</label>\r\n");
      out.write("                                                    <select class=\"form-control\" id=\"filterCategory\">\r\n");
      out.write("                                                        <option value=\"\">Tất cả danh mục</option>\r\n");
      out.write("                                                        <option value=\"Máy phát điện\">Máy phát điện</option>\r\n");
      out.write("                                                        <option value=\"Máy bơm nước\">Máy bơm nước</option>\r\n");
      out.write("                                                        <option value=\"Máy tiện\">Máy tiện</option>\r\n");
      out.write("                                                    </select>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            \r\n");
      out.write("                                            <!-- Lọc theo trạng thái tồn kho -->\r\n");
      out.write("                                            <div class=\"col-md-3\">\r\n");
      out.write("                                                <div class=\"form-group\">\r\n");
      out.write("                                                    <label for=\"filterStatus\" style=\"font-weight: bold; margin-bottom: 5px;\">Trạng thái:</label>\r\n");
      out.write("                                                    <select class=\"form-control\" id=\"filterStatus\">\r\n");
      out.write("                                                        <option value=\"\">Tất cả trạng thái</option>\r\n");
      out.write("                                                        <option value=\"normal\">Bình thường</option>\r\n");
      out.write("                                                        <option value=\"low\">Sắp hết</option>\r\n");
      out.write("                                                        <option value=\"out\">Hết hàng</option>\r\n");
      out.write("                                                    </select>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            \r\n");
      out.write("                                            <!-- Tìm kiếm tổng quát -->\r\n");
      out.write("                                            <div class=\"col-md-3\">\r\n");
      out.write("                                                <div class=\"form-group\">\r\n");
      out.write("                                                    <label for=\"searchKeyword\" style=\"font-weight: bold; margin-bottom: 5px;\">Tìm kiếm:</label>\r\n");
      out.write("                                                    <input type=\"text\" class=\"form-control\" id=\"searchKeyword\" placeholder=\"Tìm theo tên, mã sản phẩm...\" onkeypress=\"if(event.key==='Enter') loadStockData()\">\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            \r\n");
      out.write("                                            <!-- Nút lọc -->\r\n");
      out.write("                                            <div class=\"col-md-1\">\r\n");
      out.write("                                                <div class=\"form-group\">\r\n");
      out.write("                                                    <label style=\"color: transparent; margin-bottom: 5px;\">Lọc</label>\r\n");
      out.write("                                                    <button type=\"button\" class=\"btn btn-primary btn-sm\" style=\"width: 100%;\" onclick=\"loadStockData()\" title=\"Áp dụng bộ lọc\">\r\n");
      out.write("                                                        <i class=\"fa fa-search\"></i>\r\n");
      out.write("                                                    </button>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            \r\n");
      out.write("                                            <!-- Nút reset -->\r\n");
      out.write("                                            <div class=\"col-md-1\">\r\n");
      out.write("                                                <div class=\"form-group\">\r\n");
      out.write("                                                    <label style=\"color: transparent; margin-bottom: 5px;\">Reset</label>\r\n");
      out.write("                                                    <button type=\"button\" class=\"btn btn-warning btn-sm\" style=\"width: 100%;\" onclick=\"resetFilters()\" title=\"Xóa tất cả bộ lọc\">\r\n");
      out.write("                                                        <i class=\"fa fa-refresh\"></i>\r\n");
      out.write("                                                    </button>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            \r\n");
      out.write("                            <div class=\"panel-body table-responsive\">\r\n");
      out.write("                                <table class=\"table table-hover\" id=\"stockTable\">\r\n");
      out.write("                                    <thead>\r\n");
      out.write("                                        <tr>\r\n");
      out.write("                                            <th>ID</th>\r\n");
      out.write("                                            <th>Hình ảnh</th>\r\n");
      out.write("                                            <th>Mã sản phẩm</th>\r\n");
      out.write("                                            <th>Tên sản phẩm</th>\r\n");
      out.write("                                            <th>Danh mục</th>\r\n");
      out.write("                                            <th>Đơn vị</th>\r\n");
      out.write("                                            <th>Tổng tồn kho</th>\r\n");
      out.write("                                            <th>Giá bán</th>\r\n");
      out.write("                                            <th>Trạng thái</th>\r\n");
      out.write("                                        </tr>\r\n");
      out.write("                                    </thead>\r\n");
      out.write("                                    <tbody>\r\n");
      out.write("                                        <tr>\r\n");
      out.write("                                            <td colspan=\"9\" class=\"text-center\">\r\n");
      out.write("                                                <i class=\"fa fa-spinner fa-spin\"></i> Đang tải dữ liệu...\r\n");
      out.write("                                            </td>\r\n");
      out.write("                                        </tr>\r\n");
      out.write("                                    </tbody>\r\n");
      out.write("                                </table>\r\n");
      out.write("                            </div>\r\n");
      out.write("                                \r\n");
      out.write("                                <!-- Phân trang -->\r\n");
      out.write("                                <div class=\"row\" style=\"margin-top: 20px;\">\r\n");
      out.write("                                    <div class=\"col-md-8\">\r\n");
      out.write("                                        <div class=\"dataTables_info\" id=\"stockInfo\" role=\"status\" aria-live=\"polite\">\r\n");
      out.write("                                            Hiển thị <span id=\"showingStart\">0</span> đến <span id=\"showingEnd\">0</span> \r\n");
      out.write("                                            trong tổng số <span id=\"totalRecords\">0</span> sản phẩm\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"col-md-4\">\r\n");
      out.write("                                        <div class=\"dataTables_paginate paging_simple_numbers\" style=\"text-align: right;\">\r\n");
      out.write("                                            <ul class=\"pagination\" id=\"stockPagination\" style=\"margin:0;\">\r\n");
      out.write("                                                <li class=\"paginate_button previous disabled\">\r\n");
      out.write("                                                    <a href=\"#\" id=\"prevBtn\">Trước</a>\r\n");
      out.write("                                                </li>\r\n");
      out.write("                                                <li class=\"paginate_button active\">\r\n");
      out.write("                                                    <a href=\"#\" class=\"page-link\" data-page=\"1\">1</a>\r\n");
      out.write("                                                </li>\r\n");
      out.write("                                                <li class=\"paginate_button next\">\r\n");
      out.write("                                                    <a href=\"#\" id=\"nextBtn\">Tiếp</a>\r\n");
      out.write("                                                </li>\r\n");
      out.write("                                            </ul>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </section><!-- /.content -->\r\n");
      out.write("        </aside><!-- /.right-side -->\r\n");
      out.write("    </div><!-- ./wrapper -->\r\n");
      out.write("\r\n");
      out.write("    <!-- jQuery 2.0.2 -->\r\n");
      out.write("    <script src=\"http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js\"></script>\r\n");
      out.write("    <script src=\"");
      out.print(request.getContextPath());
      out.write("/js/jquery.min.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- jQuery UI 1.10.3 -->\r\n");
      out.write("    <script src=\"");
      out.print(request.getContextPath());
      out.write("/js/jquery-ui-1.10.3.min.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- Bootstrap -->\r\n");
      out.write("    <script src=\"");
      out.print(request.getContextPath());
      out.write("/js/bootstrap.min.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- Director App -->\r\n");
      out.write("    <script src=\"");
      out.print(request.getContextPath());
      out.write("/js/Director/app.js\" type=\"text/javascript\"></script>\r\n");
      out.write("\r\n");
      out.write("    <script type=\"text/javascript\">\r\n");
      out.write("        var currentPage = 1;\r\n");
      out.write("        var pageSize = 10;\r\n");
      out.write("        var totalItems = 0;\r\n");
      out.write("\r\n");
      out.write("        $(document).ready(function() {\r\n");
      out.write("            loadStockData();\r\n");
      out.write("            \r\n");
      out.write("            $('#searchKeyword').on('keypress', function(e) {\r\n");
      out.write("                if (e.which === 13) {\r\n");
      out.write("                    loadStockData();\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        });\r\n");
      out.write("\r\n");
      out.write("        function loadStockData() {\r\n");
      out.write("            var keyword = $('#searchKeyword').val() || '';\r\n");
      out.write("            var category = $('#filterCategory').val() || '';\r\n");
      out.write("            var status = $('#filterStatus').val() || '';\r\n");
      out.write("            \r\n");
      out.write("            // Hiển thị loading - filter được xử lý hoàn toàn bằng query ở backend\r\n");
      out.write("            $('#stockTable tbody').html('<tr><td colspan=\"9\" class=\"text-center\"><i class=\"fa fa-spinner fa-spin\"></i> Đang tải dữ liệu...</td></tr>');\r\n");
      out.write("            \r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: '");
      out.print(request.getContextPath());
      out.write("/inventory',\r\n");
      out.write("                type: 'GET',\r\n");
      out.write("                data: {\r\n");
      out.write("                    action: 'getStockList',\r\n");
      out.write("                    page: currentPage,\r\n");
      out.write("                    pageSize: pageSize,\r\n");
      out.write("                    keyword: keyword,\r\n");
      out.write("                    category: category,\r\n");
      out.write("                    status: status\r\n");
      out.write("                },\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                beforeSend: function(xhr) {\r\n");
      out.write("                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\r\n");
      out.write("                },\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    if (response && response.success) {\r\n");
      out.write("                        displayStockData(response.data || []);\r\n");
      out.write("                        updatePagination(response.pagination || {});\r\n");
      out.write("                    } else {\r\n");
      out.write("                        $('#stockTable tbody').html('<tr><td colspan=\"9\" class=\"text-center\"><div class=\"alert alert-warning\">Không có dữ liệu tồn kho</div></td></tr>');\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function(xhr, status, error) {\r\n");
      out.write("                    console.error('Error loading stock data:', error);\r\n");
      out.write("                    $('#stockTable tbody').html('<tr><td colspan=\"9\" class=\"text-center\"><div class=\"alert alert-danger\">Lỗi khi tải dữ liệu: ' + error + '</div></td></tr>');\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function displayStockData(data) {\r\n");
      out.write("            var tbody = $('#stockTable tbody');\r\n");
      out.write("            tbody.empty();\r\n");
      out.write("            \r\n");
      out.write("            if (!data || data.length === 0) {\r\n");
      out.write("                tbody.html('<tr><td colspan=\"9\" class=\"text-center\"><div class=\"alert alert-info\">Không có dữ liệu tồn kho</div></td></tr>');\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            data.forEach(function(item) {\r\n");
      out.write("                var statusLabel = getStatusLabel(item.totalStock, item.minStock);\r\n");
      out.write("                var statusText = getStatusText(item.totalStock, item.minStock);\r\n");
      out.write("                \r\n");
      out.write("                var row = '<tr>';\r\n");
      out.write("                row += '<td>' + item.productId + '</td>';\r\n");
      out.write("                row += '<td>';\r\n");
      out.write("                if (item.imageUrl) {\r\n");
      out.write("                    var imgUrl = escapeHtml(item.imageUrl);\r\n");
      out.write("                    if (!imgUrl.startsWith('http') && !imgUrl.startsWith('/')) {\r\n");
      out.write("                        imgUrl = '");
      out.print(request.getContextPath());
      out.write("/' + imgUrl;\r\n");
      out.write("                    } else if (imgUrl.startsWith('/') && !imgUrl.startsWith('");
      out.print(request.getContextPath());
      out.write("')) {\r\n");
      out.write("                        imgUrl = '");
      out.print(request.getContextPath());
      out.write("' + imgUrl;\r\n");
      out.write("                    }\r\n");
      out.write("                    row += '<img src=\"' + imgUrl + '\" style=\"width: 40px; height: 40px; object-fit: cover; border-radius: 4px;\" alt=\"' + escapeHtml(item.productName || '') + '\" />';\r\n");
      out.write("                } else {\r\n");
      out.write("                    row += '<img src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2RkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZTwvdGV4dD48L3N2Zz4=\" style=\"width: 40px; height: 40px; object-fit: cover; border-radius: 4px;\" alt=\"Default Image\" />';\r\n");
      out.write("                }\r\n");
      out.write("                row += '</td>';\r\n");
      out.write("                row += '<td><strong>' + escapeHtml(item.productCode || 'N/A') + '</strong></td>';\r\n");
      out.write("                row += '<td>' + escapeHtml(item.productName || 'N/A') + '</td>';\r\n");
      out.write("                row += '<td>' + escapeHtml(item.category || 'N/A') + '</td>';\r\n");
      out.write("                row += '<td>' + escapeHtml(item.unit || 'N/A') + '</td>';\r\n");
      out.write("                row += '<td><strong>' + (item.totalStock || 0) + '</strong></td>';\r\n");
      out.write("                row += '<td>' + (item.unitPrice ? new Intl.NumberFormat('vi-VN').format(item.unitPrice) + ' VNĐ' : '-') + '</td>';\r\n");
      out.write("                row += '<td><span class=\"label ' + statusLabel + '\">' + statusText + '</span></td>';\r\n");
      out.write("                row += '</tr>';\r\n");
      out.write("                \r\n");
      out.write("                tbody.append(row);\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function getStatusLabel(totalStock, minStock) {\r\n");
      out.write("            if (totalStock === 0) return 'label-danger';\r\n");
      out.write("            if (minStock && totalStock <= minStock) return 'label-warning';\r\n");
      out.write("            return 'label-success';\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function getStatusText(totalStock, minStock) {\r\n");
      out.write("            if (totalStock === 0) return 'Hết hàng';\r\n");
      out.write("            if (minStock && totalStock <= minStock) return 'Sắp hết';\r\n");
      out.write("            return 'Bình thường';\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function updatePagination(pagination) {\r\n");
      out.write("            var totalPages = pagination.totalPages || 1;\r\n");
      out.write("            var total = pagination.total || 0;\r\n");
      out.write("            var from = pagination.from || 0;\r\n");
      out.write("            var to = pagination.to || 0;\r\n");
      out.write("            \r\n");
      out.write("            // Update info\r\n");
      out.write("            $('#showingStart').text(from);\r\n");
      out.write("            $('#showingEnd').text(to);\r\n");
      out.write("            $('#totalRecords').text(total);\r\n");
      out.write("            \r\n");
      out.write("            // Update pagination buttons\r\n");
      out.write("            var paginationHtml = '';\r\n");
      out.write("            \r\n");
      out.write("            // Previous button\r\n");
      out.write("            if (currentPage > 1) {\r\n");
      out.write("                paginationHtml += '<li class=\"paginate_button previous\"><a href=\"#\" id=\"prevBtn\" onclick=\"changePage(' + (currentPage - 1) + '); return false;\">Trước</a></li>';\r\n");
      out.write("            } else {\r\n");
      out.write("                paginationHtml += '<li class=\"paginate_button previous disabled\"><a href=\"#\" id=\"prevBtn\">Trước</a></li>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Page numbers (show max 5 pages)\r\n");
      out.write("            var startPage = Math.max(1, currentPage - 2);\r\n");
      out.write("            var endPage = Math.min(totalPages, currentPage + 2);\r\n");
      out.write("            \r\n");
      out.write("            if (startPage > 1) {\r\n");
      out.write("                paginationHtml += '<li class=\"paginate_button\"><a href=\"#\" class=\"page-link\" onclick=\"changePage(1); return false;\">1</a></li>';\r\n");
      out.write("                if (startPage > 2) {\r\n");
      out.write("                    paginationHtml += '<li class=\"paginate_button disabled\"><a href=\"#\">...</a></li>';\r\n");
      out.write("                }\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            for (var i = startPage; i <= endPage; i++) {\r\n");
      out.write("                if (i === currentPage) {\r\n");
      out.write("                    paginationHtml += '<li class=\"paginate_button active\"><a href=\"#\" class=\"page-link\">' + i + '</a></li>';\r\n");
      out.write("                } else {\r\n");
      out.write("                    paginationHtml += '<li class=\"paginate_button\"><a href=\"#\" class=\"page-link\" onclick=\"changePage(' + i + '); return false;\">' + i + '</a></li>';\r\n");
      out.write("                }\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            if (endPage < totalPages) {\r\n");
      out.write("                if (endPage < totalPages - 1) {\r\n");
      out.write("                    paginationHtml += '<li class=\"paginate_button disabled\"><a href=\"#\">...</a></li>';\r\n");
      out.write("                }\r\n");
      out.write("                paginationHtml += '<li class=\"paginate_button\"><a href=\"#\" class=\"page-link\" onclick=\"changePage(' + totalPages + '); return false;\">' + totalPages + '</a></li>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Next button\r\n");
      out.write("            if (currentPage < totalPages) {\r\n");
      out.write("                paginationHtml += '<li class=\"paginate_button next\"><a href=\"#\" id=\"nextBtn\" onclick=\"changePage(' + (currentPage + 1) + '); return false;\">Tiếp</a></li>';\r\n");
      out.write("            } else {\r\n");
      out.write("                paginationHtml += '<li class=\"paginate_button next disabled\"><a href=\"#\" id=\"nextBtn\">Tiếp</a></li>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            $('#stockPagination').html(paginationHtml);\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function changePage(page) {\r\n");
      out.write("            currentPage = page;\r\n");
      out.write("            loadStockData();\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function resetFilters() {\r\n");
      out.write("            $('#searchKeyword').val('');\r\n");
      out.write("            $('#filterCategory').val('');\r\n");
      out.write("            $('#filterStatus').val('');\r\n");
      out.write("            currentPage = 1;\r\n");
      out.write("            loadStockData();\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function escapeHtml(text) {\r\n");
      out.write("            if (!text) return '';\r\n");
      out.write("            var map = {\r\n");
      out.write("                '&': '&amp;',\r\n");
      out.write("                '<': '&lt;',\r\n");
      out.write("                '>': '&gt;',\r\n");
      out.write("                '\"': '&quot;',\r\n");
      out.write("                \"'\": '&#039;'\r\n");
      out.write("            };\r\n");
      out.write("            return text.toString().replace(/[&<>\"']/g, function(m) { return map[m]; });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("    </script>\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
      out.write("\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}

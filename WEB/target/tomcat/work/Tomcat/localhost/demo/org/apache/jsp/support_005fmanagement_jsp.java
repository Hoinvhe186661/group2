/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2025-11-13 18:55:03 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.util.Set;

public final class support_005fmanagement_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fchoose;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvarStatus_005fvar_005fitems;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fotherwise;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fc_005fchoose = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvarStatus_005fvar_005fitems = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fc_005fotherwise = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fc_005fchoose.release();
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.release();
    _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvarStatus_005fvar_005fitems.release();
    _005fjspx_005ftagPool_005fc_005fotherwise.release();
    _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

    // Kiểm tra đăng nhập
    String username = (String) session.getAttribute("username");
    Boolean isLoggedIn = (Boolean) session.getAttribute("isLoggedIn");
    String userRole = (String) session.getAttribute("userRole");
    
    if (username == null || isLoggedIn == null || !isLoggedIn) {
        response.sendRedirect(request.getContextPath() + "/login.jsp");
        return;
    }
    
    // Kiểm tra quyền: chỉ người có quyền manage_support_requests mới truy cập được
    @SuppressWarnings("unchecked")
    Set<String> userPermissions = (Set<String>) session.getAttribute("userPermissions");
    if (userPermissions == null || !userPermissions.contains("manage_support_requests")) {
        response.sendRedirect(request.getContextPath() + "/error/403.jsp");
        return;
    }

      out.write("\r\n");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("    <meta charset=\"UTF-8\">\r\n");
      out.write("    <title>Quản Lý Yêu Cầu Hỗ Trợ | Bảng Điều Khiển</title>\r\n");
      out.write("    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>\r\n");
      out.write("    \r\n");
      out.write("    <!-- bootstrap 3.0.2 -->\r\n");
      out.write("    <link href=\"css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- font Awesome -->\r\n");
      out.write("    <link href=\"css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- Ionicons -->\r\n");
      out.write("    <link href=\"css/ionicons.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- DataTables -->\r\n");
      out.write("    <link href=\"css/datatables/dataTables.bootstrap.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("    <!-- Theme style -->\r\n");
      out.write("    <link href=\"css/style.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\r\n");
      out.write("    <style>\r\n");
      out.write("         .filter-section {\r\n");
      out.write("             background: #f9f9f9;\r\n");
      out.write("            padding: 15px;\r\n");
      out.write("             margin-bottom: 20px;\r\n");
      out.write("            border-radius: 5px;\r\n");
      out.write("         }\r\n");
      out.write("         .ticket-priority-urgent { border-left: 4px solid #d9534f; }\r\n");
      out.write("         .ticket-priority-high { border-left: 4px solid #d9534f; }\r\n");
      out.write("         .ticket-priority-medium { border-left: 4px solid #5bc0de; }\r\n");
      out.write("         .ticket-priority-low { border-left: 4px solid #5cb85c; }\r\n");
      out.write("         \r\n");
      out.write("         /* Màu cho độ ưu tiên và trạng thái - đồng nhất */\r\n");
      out.write("         .label-priority-high { background-color: #d9534f !important; }\r\n");
      out.write("         .label-priority-urgent { background-color: #d9534f !important; }\r\n");
      out.write("         .label-status-in_progress { background-color: #337ab7 !important; }\r\n");
      out.write("         \r\n");
      out.write("         /* Tối ưu cho tiếng Việt */\r\n");
      out.write("         #detailDescription {\r\n");
      out.write("             font-family: 'Segoe UI', Tahoma, Arial, sans-serif;\r\n");
      out.write("             line-height: 1.5;\r\n");
      out.write("             direction: ltr;\r\n");
      out.write("             unicode-bidi: embed;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Placeholder styling cho tiếng Việt */\r\n");
      out.write("         #detailDescription::placeholder {\r\n");
      out.write("             color: #999;\r\n");
      out.write("             font-style: italic;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Styling cho các trường bị khóa */\r\n");
      out.write("         input[readonly], textarea[readonly], select[disabled] {\r\n");
      out.write("             background-color: #f5f5f5;\r\n");
      out.write("             color: #666;\r\n");
      out.write("             cursor: not-allowed;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Styling cho các trường được phép chỉnh sửa */\r\n");
      out.write("         input:not([readonly]), textarea:not([readonly]), select:not([disabled]) {\r\n");
      out.write("             background-color: #fff;\r\n");
      out.write("             border-color: #5bc0de;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Label styling để phân biệt */\r\n");
      out.write("         .form-group label {\r\n");
      out.write("             font-weight: bold;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         .form-group label:after {\r\n");
      out.write("             content: \" *\";\r\n");
      out.write("             color: #5bc0de;\r\n");
      out.write("             font-weight: normal;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Loại bỏ dấu * cho các trường readonly */\r\n");
      out.write("         input[readonly] + label:after,\r\n");
      out.write("         textarea[readonly] + label:after,\r\n");
      out.write("         select[disabled] + label:after {\r\n");
      out.write("             display: none;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Ẩn phần \"records per page\" của DataTables */\r\n");
      out.write("         .dataTables_length {\r\n");
      out.write("             display: none !important;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Ẩn cột Sort Priority */\r\n");
      out.write("         .hidden {\r\n");
      out.write("             display: none !important;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Tối ưu hiển thị cho modal chi tiết ticket - tránh tràn chữ */\r\n");
      out.write("         .ticket-detail-view {\r\n");
      out.write("             word-wrap: break-word;\r\n");
      out.write("             overflow-wrap: break-word;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         .ticket-detail-view * {\r\n");
      out.write("             max-width: 100%;\r\n");
      out.write("             box-sizing: border-box;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         .ticket-detail-view h5 {\r\n");
      out.write("             margin-top: 0;\r\n");
      out.write("             margin-bottom: 12px;\r\n");
      out.write("             font-size: 16px;\r\n");
      out.write("             font-weight: 600;\r\n");
      out.write("             color: #2c3e50;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Tối ưu cho phần hợp đồng và sản phẩm */\r\n");
      out.write("         .contract-product-section {\r\n");
      out.write("             word-wrap: break-word;\r\n");
      out.write("             word-break: break-word;\r\n");
      out.write("             overflow-wrap: break-word;\r\n");
      out.write("             white-space: normal;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Responsive cho modal */\r\n");
      out.write("         @media (max-width: 768px) {\r\n");
      out.write("             .ticket-detail-view .row {\r\n");
      out.write("                 margin-left: 0;\r\n");
      out.write("                 margin-right: 0;\r\n");
      out.write("             }\r\n");
      out.write("             \r\n");
      out.write("             .ticket-detail-view .col-md-8,\r\n");
      out.write("             .ticket-detail-view .col-md-4 {\r\n");
      out.write("                 padding-left: 0;\r\n");
      out.write("                 padding-right: 0;\r\n");
      out.write("                 width: 100%;\r\n");
      out.write("             }\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Tối ưu cho các box thông tin */\r\n");
      out.write("         .ticket-detail-view > div[style*=\"background\"] {\r\n");
      out.write("             word-wrap: break-word;\r\n");
      out.write("             overflow-wrap: break-word;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Fix tràn chữ trong sidebar */\r\n");
      out.write("         .sidebar-menu li a {\r\n");
      out.write("             overflow: hidden;\r\n");
      out.write("             text-overflow: ellipsis;\r\n");
      out.write("             white-space: nowrap;\r\n");
      out.write("             word-wrap: break-word;\r\n");
      out.write("             max-width: 100%;\r\n");
      out.write("             font-size: 13px !important;\r\n");
      out.write("             padding: 10px 5px 10px 15px !important;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         .sidebar-menu li a span {\r\n");
      out.write("             display: inline-block;\r\n");
      out.write("             max-width: calc(100% - 30px);\r\n");
      out.write("             overflow: hidden;\r\n");
      out.write("             text-overflow: ellipsis;\r\n");
      out.write("             white-space: nowrap;\r\n");
      out.write("             vertical-align: top;\r\n");
      out.write("             font-size: 13px !important;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         .sidebar-menu li a i {\r\n");
      out.write("             margin-right: 8px;\r\n");
      out.write("             width: 20px;\r\n");
      out.write("             text-align: center;\r\n");
      out.write("             flex-shrink: 0;\r\n");
      out.write("             font-size: 14px !important;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Đảm bảo sidebar có đủ không gian */\r\n");
      out.write("         .left-side {\r\n");
      out.write("             overflow-x: hidden;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         .sidebar {\r\n");
      out.write("             overflow-x: hidden;\r\n");
      out.write("             overflow-y: auto;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("         /* Giảm font-size cho logo trong sidebar nếu có */\r\n");
      out.write("         .sidebar .logo {\r\n");
      out.write("             font-size: 16px !important;\r\n");
      out.write("             padding: 15px 10px !important;\r\n");
      out.write("             white-space: nowrap;\r\n");
      out.write("             overflow: hidden;\r\n");
      out.write("             text-overflow: ellipsis;\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("    </style>\r\n");
      out.write("</head>\r\n");
      out.write("<body class=\"skin-black\">\r\n");
      out.write("    <!-- header logo: style can be found in header.less -->\r\n");
      out.write("    <header class=\"header\">\r\n");
      out.write("        <a href=\"support-management\" class=\"logo\">\r\n");
      out.write("            Quản Lý Yêu Cầu Hỗ Trợ\r\n");
      out.write("        </a>\r\n");
      out.write("        <!-- Header Navbar: style can be found in header.less -->\r\n");
      out.write("        <nav class=\"navbar navbar-static-top\" role=\"navigation\">\r\n");
      out.write("            <!-- Sidebar toggle button-->\r\n");
      out.write("            <a href=\"#\" class=\"navbar-btn sidebar-toggle\" data-toggle=\"offcanvas\" role=\"button\">\r\n");
      out.write("                <span class=\"sr-only\">Toggle navigation</span>\r\n");
      out.write("                <span class=\"icon-bar\"></span>\r\n");
      out.write("                <span class=\"icon-bar\"></span>\r\n");
      out.write("                <span class=\"icon-bar\"></span>\r\n");
      out.write("            </a>\r\n");
      out.write("            <div class=\"navbar-right\">\r\n");
      out.write("                <ul class=\"nav navbar-nav\">\r\n");
      out.write("                    <!-- User Account: style can be found in dropdown.less -->\r\n");
      out.write("                    <li class=\"dropdown user user-menu\">\r\n");
      out.write("                        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\r\n");
      out.write("                            <i class=\"fa fa-user\"></i>\r\n");
      out.write("                            <span>");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${sessionScope.username}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(" <i class=\"caret\"></i></span>\r\n");
      out.write("                        </a>\r\n");
      out.write("                        <ul class=\"dropdown-menu dropdown-custom dropdown-menu-right\">\r\n");
      out.write("                            <li class=\"dropdown-header text-center\">Tài khoản</li>\r\n");
      out.write("                            <li>\r\n");
      out.write("                                <a href=\"profile.jsp\">\r\n");
      out.write("                                <i class=\"fa fa-user fa-fw pull-right\"></i>\r\n");
      out.write("                                    Hồ sơ\r\n");
      out.write("                                </a>\r\n");
      out.write("                                <a href=\"settings.jsp\">\r\n");
      out.write("                                <i class=\"fa fa-cog fa-fw pull-right\"></i>\r\n");
      out.write("                                    Cài đặt cá nhân\r\n");
      out.write("                                </a>\r\n");
      out.write("                            </li>\r\n");
      out.write("                            <li class=\"divider\"></li>\r\n");
      out.write("                            <li>\r\n");
      out.write("                                <a href=\"logout\"><i class=\"fa fa-ban fa-fw pull-right\"></i> Đăng xuất</a>\r\n");
      out.write("                            </li>\r\n");
      out.write("                        </ul>\r\n");
      out.write("                    </li>\r\n");
      out.write("                </ul>\r\n");
      out.write("            </div>\r\n");
      out.write("        </nav>\r\n");
      out.write("    </header>\r\n");
      out.write("    \r\n");
      out.write("    <div class=\"wrapper row-offcanvas row-offcanvas-left\">\r\n");
      out.write("        <!-- Left side column. contains the logo and sidebar -->\r\n");
      out.write("\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "partials/sidebar.jsp", out, false);
      out.write("\r\n");
      out.write("\r\n");
      out.write("        <aside class=\"right-side\">\r\n");
      out.write("            <!-- Main content -->\r\n");
      out.write("            <section class=\"content\">\r\n");
      out.write("                <!-- Filter Section -->\r\n");
      out.write("                <div class=\"filter-section\">\r\n");
      out.write("                    <form method=\"GET\" action=\"support-management\">\r\n");
      out.write("                <div class=\"row\">\r\n");
      out.write("                        <div class=\"col-md-3\">\r\n");
      out.write("                            <label>Trạng thái:</label>\r\n");
      out.write("                                <select name=\"status\" class=\"form-control\">\r\n");
      out.write("                                            <option value=\"\">Tất cả</option>\r\n");
      out.write("                                    <option value=\"open\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.status == 'open' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Đang chờ</option>\r\n");
      out.write("                                    <option value=\"in_progress\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.status == 'in_progress' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Đang xử lý</option>\r\n");
      out.write("                                    <option value=\"resolved\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.status == 'resolved' || param.status == 'closed' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Đã giải quyết</option>\r\n");
      out.write("                                        </select>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                        <div class=\"col-md-3\">\r\n");
      out.write("                            <label>Độ ưu tiên:</label>\r\n");
      out.write("                                <select name=\"priority\" class=\"form-control\">\r\n");
      out.write("                                            <option value=\"\">Tất cả</option>\r\n");
      out.write("                                    <option value=\"urgent\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'urgent' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Khẩn cấp</option>\r\n");
      out.write("                                    <option value=\"high\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'high' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Cao</option>\r\n");
      out.write("                                    <option value=\"medium\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'medium' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Trung bình</option>\r\n");
      out.write("                                    <option value=\"low\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'low' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Thấp</option>\r\n");
      out.write("                                        </select>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                        <div class=\"col-md-3\">\r\n");
      out.write("                            <label>Danh mục:</label>\r\n");
      out.write("                                <select name=\"category\" class=\"form-control\">\r\n");
      out.write("                                <option value=\"\">Tất cả</option>\r\n");
      out.write("                                    <option value=\"technical\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'technical' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Kỹ thuật</option>\r\n");
      out.write("                                    <option value=\"billing\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'billing' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Thanh toán</option>\r\n");
      out.write("                                    <option value=\"general\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'general' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Chung</option>\r\n");
      out.write("                                    <option value=\"complaint\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'complaint' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Khiếu nại</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                        <div class=\"col-md-3\">\r\n");
      out.write("                            <label>&nbsp;</label><br>\r\n");
      out.write("                                <button type=\"submit\" class=\"btn btn-primary\">\r\n");
      out.write("                                        <i class=\"fa fa-filter\"></i> Lọc\r\n");
      out.write("                                    </button>\r\n");
      out.write("                                <a href=\"support-management\" class=\"btn btn-default\">\r\n");
      out.write("                                 <i class=\"fa fa-refresh\"></i> Xóa bộ lọc\r\n");
      out.write("                                </a>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </form>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Tickets Table -->\r\n");
      out.write("                <div class=\"row\">\r\n");
      out.write("                    <div class=\"col-md-12\">\r\n");
      out.write("                        <section class=\"panel\">\r\n");
      out.write("                            <header class=\"panel-heading\">\r\n");
      out.write("                                <h3>Danh sách yêu cầu hỗ trợ</h3>\r\n");
      out.write("                            </header>\r\n");
      out.write("                            <div class=\"panel-body\">\r\n");
      out.write("                                <div class=\"table-responsive\">\r\n");
      out.write("                                    <table id=\"ticketsTable\" class=\"table table-striped table-bordered table-hover\">\r\n");
      out.write("                                    <thead>\r\n");
      out.write("                                        <tr>\r\n");
      out.write("                                                <th>STT</th>\r\n");
      out.write("                                                <th class=\"hidden\">Sort Priority</th>\r\n");
      out.write("                                                <th>Mã Ticket</th>\r\n");
      out.write("                                            <th>Khách hàng</th>\r\n");
      out.write("                                            <th>Tiêu đề</th>\r\n");
      out.write("                                                <th>Danh mục</th>\r\n");
      out.write("                                                <th>Độ ưu tiên</th>\r\n");
      out.write("                                                <th>Trạng thái</th>\r\n");
      out.write("                                                <th>Ngày tạo</th>\r\n");
      out.write("                                                <th>Thao tác</th>\r\n");
      out.write("                                        </tr>\r\n");
      out.write("                                    </thead>\r\n");
      out.write("                                    <tbody>\r\n");
      out.write("                                        ");
      if (_jspx_meth_c_005fchoose_005f0(_jspx_page_context))
        return;
      out.write("\r\n");
      out.write("                                    </tbody>\r\n");
      out.write("                                </table>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </section>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("            </section><!-- /.content -->\r\n");
      out.write("        </aside><!-- /.right-side -->\r\n");
      out.write("    </div><!-- ./wrapper -->\r\n");
      out.write("\r\n");
      out.write("    <!-- Modal Xem Chi Tiết Ticket -->\r\n");
      out.write("    <div class=\"modal fade\" id=\"viewTicketModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"viewTicketModalLabel\">\r\n");
      out.write("        <div class=\"modal-dialog modal-lg\" role=\"document\">\r\n");
      out.write("            <div class=\"modal-content\">\r\n");
      out.write("                <div class=\"modal-header\" style=\"background-color: #3c8dbc; color: white;\">\r\n");
      out.write("                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" style=\"color: white; opacity: 0.8;\">\r\n");
      out.write("                        <span aria-hidden=\"true\">&times;</span>\r\n");
      out.write("                    </button>\r\n");
      out.write("                    <h4 class=\"modal-title\" id=\"viewTicketModalLabel\">\r\n");
      out.write("                        <i class=\"fa fa-ticket\"></i> Chi Tiết Yêu Cầu Hỗ Trợ\r\n");
      out.write("                    </h4>\r\n");
      out.write("                </div>\r\n");
      out.write("                <div class=\"modal-body\" id=\"ticketDetailContent\">\r\n");
      out.write("                    <div class=\"text-center\">\r\n");
      out.write("                        <i class=\"fa fa-spinner fa-spin fa-3x\"></i>\r\n");
      out.write("                        <p>Đang tải dữ liệu...</p>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("                <div class=\"modal-footer\">\r\n");
      out.write("                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">\r\n");
      out.write("                        <i class=\"fa fa-times\"></i> Đóng\r\n");
      out.write("                    </button>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("        </div>\r\n");
      out.write("    </div>\r\n");
      out.write("\r\n");
      out.write("    <!-- Modal Sửa Ticket -->\r\n");
      out.write("    <div class=\"modal fade\" id=\"editTicketModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"editTicketModalLabel\">\r\n");
      out.write("        <div class=\"modal-dialog modal-lg\" role=\"document\">\r\n");
      out.write("            <div class=\"modal-content\">\r\n");
      out.write("                <div class=\"modal-header\" style=\"background-color: #f39c12; color: white;\">\r\n");
      out.write("                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" style=\"color: white; opacity: 0.8;\">\r\n");
      out.write("                        <span aria-hidden=\"true\">&times;</span>\r\n");
      out.write("                    </button>\r\n");
      out.write("                    <h4 class=\"modal-title\" id=\"editTicketModalLabel\">\r\n");
      out.write("                        <i class=\"fa fa-edit\"></i> Cập Nhật Yêu Cầu Hỗ Trợ\r\n");
      out.write("                    </h4>\r\n");
      out.write("                </div>\r\n");
      out.write("                <form id=\"editTicketForm\">\r\n");
      out.write("                    <div class=\"modal-body\" id=\"editTicketContent\">\r\n");
      out.write("                        <div class=\"text-center\">\r\n");
      out.write("                            <i class=\"fa fa-spinner fa-spin fa-3x\"></i>\r\n");
      out.write("                            <p>Đang tải dữ liệu...</p>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"modal-footer\">\r\n");
      out.write("                        <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">\r\n");
      out.write("                            <i class=\"fa fa-times\"></i> Hủy\r\n");
      out.write("                        </button>\r\n");
      out.write("                        <button type=\"submit\" class=\"btn btn-warning\" id=\"btnSaveTicket\">\r\n");
      out.write("                            <i class=\"fa fa-check-circle\"></i> Đóng ticket\r\n");
      out.write("                        </button>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </form>\r\n");
      out.write("            </div>\r\n");
      out.write("        </div>\r\n");
      out.write("    </div>\r\n");
      out.write("\r\n");
      out.write("    <!-- Modal Chuyển tiếp Ticket -->\r\n");
      out.write("    <div class=\"modal fade\" id=\"forwardTicketModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"forwardTicketModalLabel\">\r\n");
      out.write("        <div class=\"modal-dialog\" role=\"document\">\r\n");
      out.write("            <div class=\"modal-content\">\r\n");
      out.write("                <div class=\"modal-header\" style=\"background-color: #5cb85c; color: white;\">\r\n");
      out.write("                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" style=\"color: white; opacity: 0.8;\">\r\n");
      out.write("                        <span aria-hidden=\"true\">&times;</span>\r\n");
      out.write("                    </button>\r\n");
      out.write("                    <h4 class=\"modal-title\" id=\"forwardTicketModalLabel\">\r\n");
      out.write("                        <i class=\"fa fa-share\"></i> Chuyển tiếp Ticket cho Trưởng phòng Kỹ thuật\r\n");
      out.write("                    </h4>\r\n");
      out.write("                </div>\r\n");
      out.write("                <form id=\"forwardTicketForm\">\r\n");
      out.write("                    <div class=\"modal-body\">\r\n");
      out.write("                        <div class=\"form-group\">\r\n");
      out.write("                            <label>Mã Ticket:</label>\r\n");
      out.write("                            <input type=\"text\" class=\"form-control\" id=\"forward_ticketNumber\" readonly>\r\n");
      out.write("                            <input type=\"hidden\" id=\"forward_ticketId\">\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"form-group\">\r\n");
      out.write("                            <label>Tiêu đề:</label>\r\n");
      out.write("                            <input type=\"text\" class=\"form-control\" id=\"forward_subject\" readonly>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"form-group\">\r\n");
      out.write("                            <label>Trưởng phòng Kỹ thuật nhận: <span class=\"text-danger\">*</span></label>\r\n");
      out.write("                            <select class=\"form-control\" id=\"forward_assignedTo\" required>\r\n");
      out.write("                                <option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                            <small class=\"text-muted\">Mỗi ticket sẽ được gửi riêng biệt cho từng trưởng phòng kỹ thuật</small>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"form-group\">\r\n");
      out.write("                            <label>Độ ưu tiên:</label>\r\n");
      out.write("                            <select class=\"form-control\" id=\"forward_priority\" disabled>\r\n");
      out.write("                                <option value=\"urgent\">Khẩn cấp</option>\r\n");
      out.write("                                <option value=\"high\">Cao</option>\r\n");
      out.write("                                <option value=\"medium\" selected>Trung bình</option>\r\n");
      out.write("                                <option value=\"low\">Thấp</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                            <small class=\"text-muted\">Độ ưu tiên không thể thay đổi khi chuyển tiếp</small>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"form-group\">\r\n");
      out.write("                            <label>Ngày mong muốn hoàn thành: <span class=\"text-danger\">*</span></label>\r\n");
      out.write("                            <input type=\"date\" class=\"form-control\" id=\"forward_deadline\" required>\r\n");
      out.write("                            <small class=\"text-muted\">Ngày mong muốn hoàn thành của ticket (có thể chỉnh sửa)</small>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"modal-footer\">\r\n");
      out.write("                        <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">\r\n");
      out.write("                            <i class=\"fa fa-times\"></i> Hủy\r\n");
      out.write("                        </button>\r\n");
      out.write("                        <button type=\"submit\" class=\"btn btn-success\" id=\"btnForwardTicket\">\r\n");
      out.write("                            <i class=\"fa fa-share\"></i> Chuyển tiếp\r\n");
      out.write("                        </button>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </form>\r\n");
      out.write("            </div>\r\n");
      out.write("        </div>\r\n");
      out.write("    </div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    <!-- jQuery 2.0.2 -->\r\n");
      out.write("    <script src=\"http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js\"></script>\r\n");
      out.write("    <script src=\"js/jquery.min.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- jQuery UI 1.10.3 -->\r\n");
      out.write("    <script src=\"js/jquery-ui-1.10.3.min.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- Bootstrap -->\r\n");
      out.write("    <script src=\"js/bootstrap.min.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- DataTables -->\r\n");
      out.write("    <script src=\"js/plugins/datatables/jquery.dataTables.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <script src=\"js/plugins/datatables/dataTables.bootstrap.js\" type=\"text/javascript\"></script>\r\n");
      out.write("    <!-- Director App -->\r\n");
      out.write("    <script src=\"js/Director/app.js\" type=\"text/javascript\"></script>\r\n");
      out.write("\r\n");
      out.write("    <script>\r\n");
      out.write("        // Lấy context path để dùng trong AJAX calls\r\n");
      out.write("        var ctx = '");
      out.print(request.getContextPath());
      out.write("';\r\n");
      out.write("        // Đảm bảo context path không có dấu slash thừa\r\n");
      out.write("        if (ctx && ctx.endsWith('/')) {\r\n");
      out.write("            ctx = ctx.substring(0, ctx.length - 1);\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        $(document).ready(function() {\r\n");
      out.write("            // Kiểm tra xem có dữ liệu không trước khi khởi tạo DataTable\r\n");
      out.write("            var table = $('#ticketsTable');\r\n");
      out.write("            var hasData = table.find('tbody tr').length > 0 && \r\n");
      out.write("                         !table.find('tbody tr:first td[colspan]').length;\r\n");
      out.write("            \r\n");
      out.write("            if (hasData) {\r\n");
      out.write("                // Khởi tạo DataTable với dữ liệu đã có sẵn trong HTML\r\n");
      out.write("                table.DataTable({\r\n");
      out.write("                    \"language\": {\r\n");
      out.write("                        \"url\": \"//cdn.datatables.net/plug-ins/1.10.24/i18n/Vietnamese.json\"\r\n");
      out.write("                    },\r\n");
      out.write("                    \"pageLength\": 10, // Hiển thị 10 bản ghi mỗi trang\r\n");
      out.write("                    \"lengthChange\": false, // Ẩn dropdown \"records per page\"\r\n");
      out.write("                    \"paging\": true, // Bật phân trang\r\n");
      out.write("                    \"pagingType\": \"full_numbers\", // Hiển thị số trang đầy đủ\r\n");
      out.write("                    \"order\": [[8, \"desc\"]], // Sắp xếp theo ngày tạo giảm dần (mới nhất lên đầu)\r\n");
      out.write("                    \"columnDefs\": [\r\n");
      out.write("                        { \"orderable\": false, \"targets\": [0, 9] }, // Không sort cột ID và Thao tác\r\n");
      out.write("                        { \"visible\": false, \"targets\": [1] }, // Ẩn cột Sort Priority\r\n");
      out.write("                        { \"orderable\": true, \"targets\": [2, 3, 4, 5, 6, 7, 8] } // Cho phép sắp xếp các cột khác nếu người dùng click\r\n");
      out.write("                    ],\r\n");
      out.write("                    \"autoWidth\": false,\r\n");
      out.write("                    \"responsive\": false,\r\n");
      out.write("                    \"processing\": false,\r\n");
      out.write("                    \"serverSide\": false,\r\n");
      out.write("                    \"deferRender\": false,\r\n");
      out.write("                    \"info\": true,\r\n");
      out.write("                    \"searching\": true\r\n");
      out.write("                });\r\n");
      out.write("            } else {\r\n");
      out.write("                // Nếu không có dữ liệu, không khởi tạo DataTable để giữ nguyên colspan và tránh lỗi\r\n");
      out.write("                // Message đã được hiển thị trong HTML với colspan=\"10\" và icon\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Xử lý click nút Xem\r\n");
      out.write("            $(document).on('click', '.view-ticket-btn', function() {\r\n");
      out.write("                var ticketId = $(this).data('ticket-id');\r\n");
      out.write("                loadTicketDetail(ticketId);\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("            // Xử lý click nút Sửa\r\n");
      out.write("            $(document).on('click', '.edit-ticket-btn', function() {\r\n");
      out.write("                var ticketId = $(this).data('ticket-id');\r\n");
      out.write("                loadTicketForEdit(ticketId);\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("            // Xử lý click nút Chuyển tiếp\r\n");
      out.write("            $(document).on('click', '.forward-ticket-btn', function() {\r\n");
      out.write("                var ticketId = $(this).data('ticket-id');\r\n");
      out.write("                loadTicketForForward(ticketId);\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("            // Xử lý submit form sửa\r\n");
      out.write("            $('#editTicketForm').on('submit', function(e) {\r\n");
      out.write("                e.preventDefault();\r\n");
      out.write("                saveTicketChanges();\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("            // Xử lý submit form chuyển tiếp\r\n");
      out.write("            $('#forwardTicketForm').on('submit', function(e) {\r\n");
      out.write("                e.preventDefault();\r\n");
      out.write("                forwardTicket();\r\n");
      out.write("            });\r\n");
      out.write("        });\r\n");
      out.write("\r\n");
      out.write("        function loadTicketDetail(ticketId) {\r\n");
      out.write("            // Hiển thị modal\r\n");
      out.write("            $('#viewTicketModal').modal('show');\r\n");
      out.write("            \r\n");
      out.write("            // Reset nội dung\r\n");
      out.write("            $('#ticketDetailContent').html('<div class=\"text-center\"><i class=\"fa fa-spinner fa-spin fa-3x\"></i><p>Đang tải dữ liệu...</p></div>');\r\n");
      out.write("            \r\n");
      out.write("            // Gọi AJAX\r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: 'support-detail',\r\n");
      out.write("                type: 'GET',\r\n");
      out.write("                data: { id: ticketId },\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    if (response.success) {\r\n");
      out.write("                        console.log('Ticket data received:', response.data);\r\n");
      out.write("                        console.log('Deadline value:', response.data.deadline);\r\n");
      out.write("                        console.log('Warranty info:', {\r\n");
      out.write("                            warrantyMonths: response.data.warrantyMonths,\r\n");
      out.write("                            stockOutDate: response.data.stockOutDate,\r\n");
      out.write("                            warrantyEndDate: response.data.warrantyEndDate,\r\n");
      out.write("                            warrantyValid: response.data.warrantyValid,\r\n");
      out.write("                            warrantyDaysRemaining: response.data.warrantyDaysRemaining\r\n");
      out.write("                        });\r\n");
      out.write("                        displayTicketDetail(response.data);\r\n");
      out.write("                    } else {\r\n");
      out.write("                        $('#ticketDetailContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> ' + response.message + '</div>');\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function() {\r\n");
      out.write("                    $('#ticketDetailContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> Không thể tải dữ liệu. Vui lòng thử lại!</div>');\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function displayTicketDetail(ticket) {\r\n");
      out.write("            // Định dạng category\r\n");
      out.write("            var categoryBadge = '';\r\n");
      out.write("            switch(ticket.category) {\r\n");
      out.write("                case 'technical': categoryBadge = '<span class=\"label label-info\">Kỹ thuật</span>'; break;\r\n");
      out.write("                case 'billing': categoryBadge = '<span class=\"label label-success\">Thanh toán</span>'; break;\r\n");
      out.write("                case 'general': categoryBadge = '<span class=\"label label-default\">Chung</span>'; break;\r\n");
      out.write("                case 'complaint': categoryBadge = '<span class=\"label label-danger\">Khiếu nại</span>'; break;\r\n");
      out.write("                default: categoryBadge = '<span class=\"label label-default\">' + ticket.category + '</span>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Định dạng priority\r\n");
      out.write("            var priorityBadge = '';\r\n");
      out.write("            switch(ticket.priority) {\r\n");
      out.write("                case 'low': priorityBadge = '<span class=\"label label-info\">Thấp</span>'; break;\r\n");
      out.write("                case 'medium': priorityBadge = '<span class=\"label label-warning\">Trung bình</span>'; break;\r\n");
      out.write("                case 'high': priorityBadge = '<span class=\"label label-danger label-priority-high\">Cao</span>'; break;\r\n");
      out.write("                case 'urgent': priorityBadge = '<span class=\"label label-danger label-priority-urgent\">Khẩn cấp</span>'; break;\r\n");
      out.write("                default: priorityBadge = '<span class=\"label label-default\">' + ticket.priority + '</span>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Định dạng status\r\n");
      out.write("            var statusBadge = '';\r\n");
      out.write("            switch(ticket.status) {\r\n");
      out.write("                case 'open': statusBadge = '<span class=\"label label-primary\">Đang chờ</span>'; break;\r\n");
      out.write("                case 'in_progress': statusBadge = '<span class=\"label label-primary label-status-in_progress\">Đang xử lý</span>'; break;\r\n");
      out.write("                case 'processed': statusBadge = '<span class=\"label label-info\">Đã xử lý</span>'; break;\r\n");
      out.write("                case 'resolved':\r\n");
      out.write("                case 'closed': statusBadge = '<span class=\"label label-success\">Đã giải quyết</span>'; break;\r\n");
      out.write("                default: statusBadge = '<span class=\"label label-default\">' + ticket.status + '</span>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Tách thông tin hợp đồng và sản phẩm từ description\r\n");
      out.write("            var description = ticket.description || '';\r\n");
      out.write("            var contractInfo = '';\r\n");
      out.write("            var productInfo = '';\r\n");
      out.write("            var cleanDescription = description;\r\n");
      out.write("            \r\n");
      out.write("            // Tìm thông tin hợp đồng: [Hợp đồng: ...]\r\n");
      out.write("            var contractMatch = description.match(/\\[Hợp đồng:([^\\]]+)\\]/);\r\n");
      out.write("            if (contractMatch) {\r\n");
      out.write("                contractInfo = contractMatch[1].trim();\r\n");
      out.write("                cleanDescription = cleanDescription.replace(/\\[Hợp đồng:[^\\]]+\\]\\s*/g, '').trim();\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Tìm thông tin sản phẩm: [Sản phẩm: ...]\r\n");
      out.write("            var productMatch = description.match(/\\[Sản phẩm:([^\\]]+)\\]/);\r\n");
      out.write("            if (productMatch) {\r\n");
      out.write("                productInfo = productMatch[1].trim();\r\n");
      out.write("                cleanDescription = cleanDescription.replace(/\\[Sản phẩm:[^\\]]+\\]\\s*/g, '').trim();\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            var html = '<div class=\"ticket-detail-view\">';\r\n");
      out.write("            \r\n");
      out.write("            // Header\r\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; margin-bottom: 20px; border-radius: 5px; border-left: 5px solid #3c8dbc;\">';\r\n");
      out.write("            html += '<h4 style=\"margin-top: 0;\"><strong>#' + escapeHtml(ticket.ticketNumber) + '</strong></h4>';\r\n");
      out.write("            html += '<h5>' + escapeHtml(ticket.subject) + '</h5>';\r\n");
      out.write("            html += '<div style=\"margin-top: 10px;\">';\r\n");
      out.write("            html += 'Trạng thái: ' + statusBadge + ' &nbsp; ';\r\n");
      out.write("            html += 'Độ ưu tiên: ' + priorityBadge + ' &nbsp; ';\r\n");
      out.write("            html += 'Danh mục: ' + categoryBadge;\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("\r\n");
      out.write("            // Row 2 cột\r\n");
      out.write("            html += '<div class=\"row\">';\r\n");
      out.write("            \r\n");
      out.write("            // Cột trái - Chi tiết\r\n");
      out.write("            html += '<div class=\"col-md-8\">';\r\n");
      out.write("            \r\n");
      out.write("            // Hợp đồng và Sản phẩm (nếu có)\r\n");
      out.write("            if (contractInfo || productInfo) {\r\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\r\n");
      out.write("                html += '<h5 style=\"margin-bottom: 12px;\"><i class=\"fa fa-file-text\"></i> <strong>Hợp đồng & Sản phẩm</strong></h5>';\r\n");
      out.write("                html += '<div style=\"background: linear-gradient(135deg, #e7f3ff 0%, #d6e9f5 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #3c8dbc; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">';\r\n");
      out.write("                \r\n");
      out.write("                if (contractInfo) {\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid rgba(60, 141, 188, 0.2);\">';\r\n");
      out.write("                    html += '<div style=\"display: flex; align-items: flex-start; gap: 10px;\">';\r\n");
      out.write("                    html += '<div style=\"flex-shrink: 0; color: #3c8dbc; font-size: 18px; margin-top: 2px;\"><i class=\"fa fa-file-text-o\"></i></div>';\r\n");
      out.write("                    html += '<div style=\"flex: 1; min-width: 0;\">';\r\n");
      out.write("                    html += '<strong style=\"display: block; margin-bottom: 5px; color: #2c3e50; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px;\">Hợp đồng</strong>';\r\n");
      out.write("                    html += '<div style=\"word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; white-space: normal; font-size: 14px; color: #34495e; line-height: 1.5; max-width: 100%;\">' + escapeHtml(contractInfo) + '</div>';\r\n");
      out.write("                    html += '</div></div></div>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                if (productInfo) {\r\n");
      out.write("                    html += '<div style=\"padding-top: 0;\">';\r\n");
      out.write("                    html += '<div style=\"display: flex; align-items: flex-start; gap: 10px;\">';\r\n");
      out.write("                    html += '<div style=\"flex-shrink: 0; color: #27ae60; font-size: 18px; margin-top: 2px;\"><i class=\"fa fa-cube\"></i></div>';\r\n");
      out.write("                    html += '<div style=\"flex: 1; min-width: 0;\">';\r\n");
      out.write("                    html += '<strong style=\"display: block; margin-bottom: 5px; color: #2c3e50; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px;\">Sản phẩm</strong>';\r\n");
      out.write("                    html += '<div style=\"word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; white-space: normal; font-size: 14px; color: #34495e; line-height: 1.5; max-width: 100%;\">' + escapeHtml(productInfo) + '</div>';\r\n");
      out.write("                    html += '</div></div></div>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                html += '</div></div>';\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Thông tin bảo hành (hiển thị khi có hợp đồng/sản phẩm hoặc có thông tin bảo hành)\r\n");
      out.write("            if (contractInfo || productInfo || ticket.warrantyMonths || ticket.warrantyValid !== undefined) {\r\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\r\n");
      out.write("                html += '<h5 style=\"margin-bottom: 12px;\"><i class=\"fa fa-shield\"></i> <strong>Thông tin bảo hành</strong></h5>';\r\n");
      out.write("                \r\n");
      out.write("                var warrantyBgColor = '#fff3cd';\r\n");
      out.write("                var warrantyBorderColor = '#ffc107';\r\n");
      out.write("                var warrantyIconColor = '#856404';\r\n");
      out.write("                var warrantyStatusText = '';\r\n");
      out.write("                var warrantyStatusColor = '#856404';\r\n");
      out.write("                \r\n");
      out.write("                if (ticket.warrantyValid === true) {\r\n");
      out.write("                    warrantyBgColor = '#d4edda';\r\n");
      out.write("                    warrantyBorderColor = '#28a745';\r\n");
      out.write("                    warrantyIconColor = '#155724';\r\n");
      out.write("                    warrantyStatusColor = '#28a745';\r\n");
      out.write("                    warrantyStatusText = '<span style=\"color: ' + warrantyStatusColor + ';\"><i class=\"fa fa-check-circle\"></i> <strong>Còn bảo hành</strong></span>';\r\n");
      out.write("                } else if (ticket.warrantyValid === false) {\r\n");
      out.write("                    warrantyBgColor = '#f8d7da';\r\n");
      out.write("                    warrantyBorderColor = '#dc3545';\r\n");
      out.write("                    warrantyIconColor = '#721c24';\r\n");
      out.write("                    warrantyStatusColor = '#dc3545';\r\n");
      out.write("                    warrantyStatusText = '<span style=\"color: ' + warrantyStatusColor + ';\"><i class=\"fa fa-times-circle\"></i> <strong>Hết bảo hành</strong></span>';\r\n");
      out.write("                } else if (ticket.warrantyMonths) {\r\n");
      out.write("                    warrantyStatusText = '<span style=\"color: ' + warrantyIconColor + ';\"><i class=\"fa fa-info-circle\"></i> <strong>Thông tin bảo hành</strong></span>';\r\n");
      out.write("                } else {\r\n");
      out.write("                    warrantyBgColor = '#e7f3ff';\r\n");
      out.write("                    warrantyBorderColor = '#3c8dbc';\r\n");
      out.write("                    warrantyIconColor = '#2c3e50';\r\n");
      out.write("                    warrantyStatusText = '<span style=\"color: ' + warrantyIconColor + ';\"><i class=\"fa fa-info-circle\"></i> <strong>Thông tin bảo hành</strong></span>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                html += '<div style=\"background: ' + warrantyBgColor + '; padding: 15px; border-radius: 8px; border-left: 4px solid ' + warrantyBorderColor + '; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">';\r\n");
      out.write("                html += '<div style=\"margin-bottom: 10px;\">' + warrantyStatusText + '</div>';\r\n");
      out.write("                \r\n");
      out.write("                if (ticket.warrantyMonths) {\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 8px;\"><strong style=\"color: #2c3e50; font-size: 13px;\">Thời gian bảo hành:</strong> <span style=\"color: #34495e; font-size: 14px;\">' + ticket.warrantyMonths + ' tháng</span></div>';\r\n");
      out.write("                } else if (contractInfo || productInfo) {\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 8px;\"><strong style=\"color: #2c3e50; font-size: 13px;\">Thời gian bảo hành:</strong> <span style=\"color: #999; font-style: italic; font-size: 14px;\">Chưa có thông tin</span></div>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                if (ticket.stockOutDate && ticket.stockOutDate.trim() !== '' && ticket.stockOutDate !== 'null') {\r\n");
      out.write("                    var stockOutDateFormatted = ticket.stockOutDate;\r\n");
      out.write("                    try {\r\n");
      out.write("                        // Nếu là format yyyy-MM-dd, chuyển sang dd/MM/yyyy\r\n");
      out.write("                        if (stockOutDateFormatted.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\r\n");
      out.write("                            var parts = stockOutDateFormatted.split('-');\r\n");
      out.write("                            stockOutDateFormatted = parts[2] + '/' + parts[1] + '/' + parts[0];\r\n");
      out.write("                        } else {\r\n");
      out.write("                            var stockOutDateObj = new Date(ticket.stockOutDate);\r\n");
      out.write("                            if (!isNaN(stockOutDateObj.getTime())) {\r\n");
      out.write("                                var dd = String(stockOutDateObj.getDate()).padStart(2, '0');\r\n");
      out.write("                                var mm = String(stockOutDateObj.getMonth() + 1).padStart(2, '0');\r\n");
      out.write("                                var yyyy = stockOutDateObj.getFullYear();\r\n");
      out.write("                                stockOutDateFormatted = dd + '/' + mm + '/' + yyyy;\r\n");
      out.write("                            }\r\n");
      out.write("                        }\r\n");
      out.write("                    } catch(e) {}\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 8px;\"><strong style=\"color: #2c3e50; font-size: 13px;\">Ngày xuất kho:</strong> <span style=\"color: #34495e; font-size: 14px;\">' + escapeHtml(stockOutDateFormatted) + '</span></div>';\r\n");
      out.write("                } else {\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 8px;\"><strong style=\"color: #2c3e50; font-size: 13px;\">Ngày xuất kho:</strong> <span style=\"color: #999; font-style: italic; font-size: 14px;\">Chưa có (Sản phẩm chưa được xuất kho)</span></div>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                if (ticket.warrantyEndDate && ticket.warrantyEndDate.trim() !== '' && ticket.warrantyEndDate !== 'null') {\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 8px;\"><strong style=\"color: #2c3e50; font-size: 13px;\">Ngày hết hạn bảo hành:</strong> <span style=\"color: #34495e; font-size: 14px;\">' + escapeHtml(ticket.warrantyEndDate) + '</span></div>';\r\n");
      out.write("                } else if (ticket.warrantyMonths) {\r\n");
      out.write("                    html += '<div style=\"margin-bottom: 8px;\"><strong style=\"color: #2c3e50; font-size: 13px;\">Ngày hết hạn bảo hành:</strong> <span style=\"color: #999; font-style: italic; font-size: 14px;\">Chưa có (Chưa xuất kho)</span></div>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                if (ticket.warrantyValid === true && ticket.warrantyDaysRemaining !== undefined && ticket.warrantyDaysRemaining !== null) {\r\n");
      out.write("                    var daysRemaining = parseInt(ticket.warrantyDaysRemaining) || 0;\r\n");
      out.write("                    html += '<div style=\"margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(0,0,0,0.1);\"><strong style=\"color: #2c3e50; font-size: 13px;\">Còn lại:</strong> <span style=\"color: #28a745; font-size: 14px; font-weight: bold;\">' + daysRemaining + ' ngày</span></div>';\r\n");
      out.write("                } else if (ticket.warrantyValid === false && ticket.warrantyDaysRemaining !== undefined && ticket.warrantyDaysRemaining !== null) {\r\n");
      out.write("                    var daysOverdue = Math.abs(parseInt(ticket.warrantyDaysRemaining) || 0);\r\n");
      out.write("                    html += '<div style=\"margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(0,0,0,0.1);\"><strong style=\"color: #2c3e50; font-size: 13px;\">Đã hết hạn:</strong> <span style=\"color: #dc3545; font-size: 14px; font-weight: bold;\">' + daysOverdue + ' ngày</span></div>';\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                html += '</div></div>';\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Mô tả (đã loại bỏ thông tin hợp đồng/sản phẩm)\r\n");
      out.write("            html += '<div style=\"margin-bottom: 20px;\">';\r\n");
      out.write("            html += '<h5 style=\"margin-bottom: 12px;\"><i class=\"fa fa-info-circle\"></i> <strong>Mô tả chi tiết</strong></h5>';\r\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; border-radius: 8px; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; max-width: 100%; line-height: 1.6; color: #2c3e50; border: 1px solid #e0e0e0;\">';\r\n");
      out.write("            html += escapeHtml(cleanDescription || 'Không có mô tả');\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("\r\n");
      out.write("            // Giải pháp / Kết quả xử lý - chỉ hiển thị technicalSolution từ work_order, bỏ qua resolution tự động\r\n");
      out.write("            var solutionText = '';\r\n");
      out.write("            if (ticket.technicalSolution && ticket.technicalSolution.trim() !== '') {\r\n");
      out.write("                solutionText = ticket.technicalSolution;\r\n");
      out.write("            } else if (ticket.resolution && ticket.resolution.trim() !== '' && \r\n");
      out.write("                       !ticket.resolution.includes('Đơn hàng công việc đã hoàn thành:')) {\r\n");
      out.write("                // Chỉ hiển thị resolution nếu không phải là message tự động\r\n");
      out.write("                solutionText = ticket.resolution;\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            if (solutionText) {\r\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\r\n");
      out.write("                html += '<h5><i class=\"fa fa-check-circle\"></i> <strong>Giải pháp / Kết quả xử lý</strong></h5>';\r\n");
      out.write("                html += '<div style=\"background: #d4edda; padding: 10px; border-radius: 3px; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word;\">';\r\n");
      out.write("                html += escapeHtml(solutionText);\r\n");
      out.write("                html += '</div></div>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // Lịch sử\r\n");
      out.write("            if (ticket.history) {\r\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\r\n");
      out.write("                html += '<h5><i class=\"fa fa-history\"></i> <strong>Lịch sử xử lý</strong></h5>';\r\n");
      out.write("                html += '<div style=\"background: #fff3cd; padding: 10px; border-radius: 3px; white-space: pre-wrap; word-wrap: break-word;\">';\r\n");
      out.write("                html += escapeHtml(ticket.history);\r\n");
      out.write("                html += '</div></div>';\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("\r\n");
      out.write("            // Cột phải - Thông tin\r\n");
      out.write("            html += '<div class=\"col-md-4\">';\r\n");
      out.write("            \r\n");
      out.write("            // Thông tin khách hàng\r\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);\">';\r\n");
      out.write("            html += '<h5 style=\"margin-top: 0; margin-bottom: 15px; font-size: 16px; font-weight: 600; color: #2c3e50;\"><i class=\"fa fa-user\"></i> <strong>Thông tin khách hàng</strong></h5>';\r\n");
      out.write("            html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Công ty:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word;\">' + escapeHtml(ticket.customerName) + '</span></p>';\r\n");
      out.write("            html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Người liên hệ:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word;\">' + escapeHtml(ticket.customerContact) + '</span></p>';\r\n");
      out.write("            if (ticket.customerEmail) {\r\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Email:</strong><br><a href=\"mailto:' + escapeHtml(ticket.customerEmail) + '\" style=\"color: #3498db; font-size: 14px; word-break: break-all;\">' + escapeHtml(ticket.customerEmail) + '</a></p>';\r\n");
      out.write("            }\r\n");
      out.write("            if (ticket.customerPhone) {\r\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Số điện thoại:</strong><br><a href=\"tel:' + escapeHtml(ticket.customerPhone) + '\" style=\"color: #3498db; font-size: 14px; word-break: break-all;\">' + escapeHtml(ticket.customerPhone) + '</a></p>';\r\n");
      out.write("            }\r\n");
      out.write("            if (ticket.customerAddress) {\r\n");
      out.write("                html += '<p style=\"margin-bottom: 0; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Địa chỉ:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word; line-height: 1.5;\">' + escapeHtml(ticket.customerAddress) + '</span></p>';\r\n");
      out.write("            }\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("\r\n");
      out.write("            // Thông tin ticket\r\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);\">';\r\n");
      out.write("            html += '<h5 style=\"margin-top: 0; margin-bottom: 15px; font-size: 16px; font-weight: 600; color: #2c3e50;\"><i class=\"fa fa-info\"></i> <strong>Thông tin ticket</strong></h5>';\r\n");
      out.write("            if (ticket.createdAt) {\r\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Ngày tạo:</strong><br><span style=\"color: #2c3e50; font-size: 14px;\">' + ticket.createdAt + '</span></p>';\r\n");
      out.write("            }\r\n");
      out.write("            // Hiển thị deadline - luôn hiển thị, nếu không có thì hiển thị \"Chưa có\"\r\n");
      out.write("            var deadlineDisplay = '';\r\n");
      out.write("            if (ticket.deadline && typeof ticket.deadline === 'string' && ticket.deadline.trim() !== '' && ticket.deadline !== 'null') {\r\n");
      out.write("                deadlineDisplay = escapeHtml(ticket.deadline);\r\n");
      out.write("            } else {\r\n");
      out.write("                deadlineDisplay = '<span style=\"color: #999; font-style: italic;\">Chưa có</span>';\r\n");
      out.write("            }\r\n");
      out.write("            html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Ngày mong muốn hoàn thành:</strong><br><span style=\"color: #2c3e50; font-size: 14px;\">' + deadlineDisplay + '</span></p>';\r\n");
      out.write("            if (ticket.resolvedAt) {\r\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Ngày giải quyết:</strong><br><span style=\"color: #2c3e50; font-size: 14px;\">' + ticket.resolvedAt + '</span></p>';\r\n");
      out.write("            }\r\n");
      out.write("            if (ticket.assignedToName) {\r\n");
      out.write("                html += '<p style=\"margin-bottom: 0; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Người xử lý:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word;\">' + escapeHtml(ticket.assignedToName) + '</span>';\r\n");
      out.write("                if (ticket.assignedToEmail) {\r\n");
      out.write("                    html += '<br><small style=\"display: block; margin-top: 5px;\"><a href=\"mailto:' + escapeHtml(ticket.assignedToEmail) + '\" style=\"color: #3498db; word-break: break-all;\">' + escapeHtml(ticket.assignedToEmail) + '</a></small>';\r\n");
      out.write("                }\r\n");
      out.write("                html += '</p>';\r\n");
      out.write("            }\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("\r\n");
      out.write("            $('#ticketDetailContent').html(html);\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function escapeHtml(text) {\r\n");
      out.write("            if (!text) return '';\r\n");
      out.write("            var map = {\r\n");
      out.write("                '&': '&amp;',\r\n");
      out.write("                '<': '&lt;',\r\n");
      out.write("                '>': '&gt;',\r\n");
      out.write("                '\"': '&quot;',\r\n");
      out.write("                \"'\": '&#039;'\r\n");
      out.write("            };\r\n");
      out.write("            return text.toString().replace(/[&<>\"']/g, function(m) { return map[m]; });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        // Load ticket để edit\r\n");
      out.write("        var currentEditTicketId = null;\r\n");
      out.write("        var currentTicketStatus = null; // Lưu trạng thái hiện tại của ticket\r\n");
      out.write("        var currentTicketCategory = null; // Lưu danh mục hiện tại của ticket\r\n");
      out.write("        \r\n");
      out.write("        function loadTicketForEdit(ticketId) {\r\n");
      out.write("            currentEditTicketId = ticketId;\r\n");
      out.write("            \r\n");
      out.write("            // Hiển thị modal\r\n");
      out.write("            $('#editTicketModal').modal('show');\r\n");
      out.write("            \r\n");
      out.write("            // Reset nội dung\r\n");
      out.write("            $('#editTicketContent').html('<div class=\"text-center\"><i class=\"fa fa-spinner fa-spin fa-3x\"></i><p>Đang tải dữ liệu...</p></div>');\r\n");
      out.write("            \r\n");
      out.write("            // Gọi AJAX\r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: 'support-detail',\r\n");
      out.write("                type: 'GET',\r\n");
      out.write("                data: { id: ticketId },\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    if (response.success) {\r\n");
      out.write("                        currentTicketStatus = response.data.status; // Lưu trạng thái\r\n");
      out.write("                        currentTicketCategory = response.data.category; // Lưu danh mục\r\n");
      out.write("                        \r\n");
      out.write("                        // Kiểm tra nếu ticket đã giải quyết thì không cho phép sửa\r\n");
      out.write("                        if (response.data.status === 'resolved' || response.data.status === 'closed') {\r\n");
      out.write("                            alert('Không thể chỉnh sửa ticket đã giải quyết!');\r\n");
      out.write("                            $('#editTicketModal').modal('hide');\r\n");
      out.write("                            return;\r\n");
      out.write("                        }\r\n");
      out.write("                        \r\n");
      out.write("                        displayEditForm(response.data);\r\n");
      out.write("                    } else {\r\n");
      out.write("                        $('#editTicketContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> ' + response.message + '</div>');\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function() {\r\n");
      out.write("                    $('#editTicketContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> Không thể tải dữ liệu. Vui lòng thử lại!</div>');\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function displayEditForm(ticket) {\r\n");
      out.write("            var html = '<div class=\"row\">';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"col-md-6\">';\r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Mã Ticket:</label>';\r\n");
      out.write("            html += '<input type=\"text\" class=\"form-control\" value=\"' + escapeHtml(ticket.ticketNumber) + '\" readonly>';\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"col-md-6\">';\r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Khách hàng:</label>';\r\n");
      out.write("            html += '<input type=\"text\" class=\"form-control\" value=\"' + escapeHtml(ticket.customerName) + '\" readonly>';\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '</div>'; // end row\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Tiêu đề:</label>';\r\n");
      out.write("            html += '<input type=\"text\" class=\"form-control\" value=\"' + escapeHtml(ticket.subject) + '\" readonly>';\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Mô tả:</label>';\r\n");
      out.write("            html += '<textarea class=\"form-control\" rows=\"4\" readonly>' + escapeHtml(ticket.description) + '</textarea>';\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '<hr>';\r\n");
      out.write("            html += '<h5><i class=\"fa fa-edit\"></i> <strong>Thông tin có thể cập nhật:</strong></h5>';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"row\">';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"col-md-4\">';\r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Danh mục:</label>';\r\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_category\" disabled>';\r\n");
      out.write("            html += '<option value=\"technical\"' + (ticket.category === 'technical' ? ' selected' : '') + '>Kỹ thuật</option>';\r\n");
      out.write("            html += '<option value=\"billing\"' + (ticket.category === 'billing' ? ' selected' : '') + '>Thanh toán</option>';\r\n");
      out.write("            html += '<option value=\"general\"' + (ticket.category === 'general' ? ' selected' : '') + '>Chung</option>';\r\n");
      out.write("            html += '<option value=\"complaint\"' + (ticket.category === 'complaint' ? ' selected' : '') + '>Khiếu nại</option>';\r\n");
      out.write("            html += '</select>';\r\n");
      out.write("            html += '<small class=\"text-muted\">Danh mục không thể thay đổi</small>';\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"col-md-4\">';\r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            // Độ ưu tiên không cho phép sửa - luôn disable\r\n");
      out.write("            html += '<label>Độ ưu tiên:</label>';\r\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_priority\" disabled>';\r\n");
      out.write("            html += '<option value=\"urgent\"' + (ticket.priority === 'urgent' ? ' selected' : '') + '>Khẩn cấp</option>';\r\n");
      out.write("            html += '<option value=\"high\"' + (ticket.priority === 'high' ? ' selected' : '') + '>Cao</option>';\r\n");
      out.write("            html += '<option value=\"medium\"' + (ticket.priority === 'medium' ? ' selected' : '') + '>Trung bình</option>';\r\n");
      out.write("            html += '<option value=\"low\"' + (ticket.priority === 'low' ? ' selected' : '') + '>Thấp</option>';\r\n");
      out.write("            html += '</select>';\r\n");
      out.write("            html += '<small class=\"text-muted\">Độ ưu tiên không thể thay đổi</small>';\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"col-md-4\">';\r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Trạng thái:</label>';\r\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_status\" disabled>';\r\n");
      out.write("            html += '<option value=\"open\"' + (ticket.status === 'open' ? ' selected' : '') + '>Đang chờ</option>';\r\n");
      out.write("            html += '<option value=\"in_progress\"' + (ticket.status === 'in_progress' ? ' selected' : '') + '>Đang xử lý</option>';\r\n");
      out.write("            html += '<option value=\"resolved\"' + (ticket.status === 'resolved' || ticket.status === 'closed' ? ' selected' : '') + '>Đã giải quyết</option>';\r\n");
      out.write("            html += '</select>';\r\n");
      out.write("            html += '<small class=\"text-muted\">Trạng thái không thể thay đổi</small>';\r\n");
      out.write("            html += '</div></div>';\r\n");
      out.write("            \r\n");
      out.write("            html += '</div>'; // end row\r\n");
      out.write("            \r\n");
      out.write("            // Kiểm tra xem ticket đã được chuyển tiếp chưa (có assignedTo)\r\n");
      out.write("            var isAssigned = ticket.assignedTo && ticket.assignedTo !== '' && ticket.assignedTo !== null;\r\n");
      out.write("            // Nếu danh mục là \"general\" (chung) thì không cần assignedTo\r\n");
      out.write("            var isGeneralCategory = ticket.category === 'general';\r\n");
      out.write("            \r\n");
      out.write("            // Chỉ hiển thị \"Người nhận\" nếu category không phải \"general\"\r\n");
      out.write("            if (!isGeneralCategory) {\r\n");
      out.write("                html += '<div class=\"form-group\">';\r\n");
      out.write("                html += '<label>Người nhận (Người xử lý):</label>';\r\n");
      out.write("                html += '<select class=\"form-control\" id=\"edit_assignedTo\" disabled>';\r\n");
      out.write("                html += '<option value=\"\">-- Chưa phân công --</option>';\r\n");
      out.write("                html += '</select>';\r\n");
      out.write("                html += '<small class=\"text-muted\">Người nhận không thể chỉnh sửa. Chỉ có thể thay đổi qua chức năng chuyển tiếp.</small>';\r\n");
      out.write("                html += '</div>';\r\n");
      out.write("                \r\n");
      out.write("                // Load danh sách head technicians vào dropdown (chỉ để hiển thị, không cho chỉnh sửa)\r\n");
      out.write("                loadHeadTechniciansForEdit(ticket.assignedTo);\r\n");
      out.write("            } else {\r\n");
      out.write("                // Với category \"general\", tạo một hidden select để tránh lỗi khi validate\r\n");
      out.write("                html += '<select class=\"form-control\" id=\"edit_assignedTo\" style=\"display: none;\"><option value=\"\"></option></select>';\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            html += '<div class=\"form-group\">';\r\n");
      out.write("            html += '<label>Giải pháp / Kết quả xử lý:</label>';\r\n");
      out.write("            \r\n");
      out.write("            // Nếu category là 'general' thì cho phép chỉnh sửa, nếu không thì readonly\r\n");
      out.write("            if (isGeneralCategory) {\r\n");
      out.write("                html += '<textarea class=\"form-control\" rows=\"5\" id=\"edit_resolution\" placeholder=\"Nhập giải pháp / kết quả xử lý...\" maxlength=\"10000\">' + (ticket.technicalSolution ? escapeHtml(ticket.technicalSolution) : '') + '</textarea>';\r\n");
      out.write("                html += '<small class=\"text-muted\" id=\"resolution_word_count\">Số từ: 0 / 1000 từ</small>';\r\n");
      out.write("            } else {\r\n");
      out.write("                html += '<textarea class=\"form-control\" rows=\"5\" id=\"edit_resolution\" placeholder=\"Giải pháp kỹ thuật từ đơn hàng công việc...\" maxlength=\"10000\" readonly style=\"background-color: #f5f5f5; cursor: not-allowed;\">' + (ticket.technicalSolution ? escapeHtml(ticket.technicalSolution) : '') + '</textarea>';\r\n");
      out.write("                html += '<small class=\"text-muted\" id=\"resolution_word_count\">Số từ: 0 / 1000 từ</small>';\r\n");
      out.write("            }\r\n");
      out.write("            html += '</div>';\r\n");
      out.write("            \r\n");
      out.write("            $('#editTicketContent').html(html);\r\n");
      out.write("            \r\n");
      out.write("            // Disable nút đóng ticket nếu:\r\n");
      out.write("            // 1. Với category \"general\": cho phép đóng ở bất kỳ trạng thái nào (trừ resolved/closed)\r\n");
      out.write("            // 2. Với category khác: phải là \"processed\" và đã được chuyển tiếp\r\n");
      out.write("            var canCloseTicket = false;\r\n");
      out.write("            var disableReason = '';\r\n");
      out.write("            \r\n");
      out.write("            // Không cho phép đóng nếu đã resolved hoặc closed\r\n");
      out.write("            if (ticket.status === 'resolved' || ticket.status === 'closed') {\r\n");
      out.write("                disableReason = 'Ticket đã được đóng rồi.';\r\n");
      out.write("            } else if (isGeneralCategory) {\r\n");
      out.write("                // Category \"general\": cho phép đóng ở bất kỳ trạng thái nào\r\n");
      out.write("                canCloseTicket = true;\r\n");
      out.write("            } else {\r\n");
      out.write("                // Category khác: phải là \"processed\" và đã được chuyển tiếp\r\n");
      out.write("                if (ticket.status !== 'processed') {\r\n");
      out.write("                    disableReason = 'Chỉ có thể đóng ticket khi trạng thái là \"Đã xử lý\" (processed). Trạng thái hiện tại: ' + (ticket.status || 'N/A');\r\n");
      out.write("                } else if (!isAssigned) {\r\n");
      out.write("                    disableReason = 'Ticket chưa được chuyển tiếp. Vui lòng chuyển tiếp ticket trước khi đóng.';\r\n");
      out.write("                } else {\r\n");
      out.write("                    canCloseTicket = true;\r\n");
      out.write("                }\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            if (canCloseTicket) {\r\n");
      out.write("                $('#btnSaveTicket').prop('disabled', false).removeAttr('title');\r\n");
      out.write("            } else {\r\n");
      out.write("                $('#btnSaveTicket').prop('disabled', true).attr('title', disableReason);\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Thêm event listener để đếm số từ real-time\r\n");
      out.write("            $('#edit_resolution').on('input', function() {\r\n");
      out.write("                updateResolutionWordCount();\r\n");
      out.write("            });\r\n");
      out.write("            \r\n");
      out.write("            // Cập nhật số từ ban đầu\r\n");
      out.write("            updateResolutionWordCount();\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        function countWords(text) {\r\n");
      out.write("            if (!text || text.trim() === '') {\r\n");
      out.write("                return 0;\r\n");
      out.write("            }\r\n");
      out.write("            // Loại bỏ các khoảng trắng thừa và đếm số từ\r\n");
      out.write("            var trimmed = text.trim();\r\n");
      out.write("            if (trimmed === '') {\r\n");
      out.write("                return 0;\r\n");
      out.write("            }\r\n");
      out.write("            // Tách theo khoảng trắng và lọc các phần tử rỗng\r\n");
      out.write("            var words = trimmed.split(/\\s+/).filter(function(word) {\r\n");
      out.write("                return word.length > 0;\r\n");
      out.write("            });\r\n");
      out.write("            return words.length;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        function updateResolutionWordCount() {\r\n");
      out.write("            var text = $('#edit_resolution').val() || '';\r\n");
      out.write("            var wordCount = countWords(text);\r\n");
      out.write("            var maxWords = 1000;\r\n");
      out.write("            var remaining = maxWords - wordCount;\r\n");
      out.write("            \r\n");
      out.write("            var countElement = $('#resolution_word_count');\r\n");
      out.write("            if (wordCount > maxWords) {\r\n");
      out.write("                countElement.removeClass('text-muted').addClass('text-danger');\r\n");
      out.write("                countElement.text('Số từ: ' + wordCount + ' / ' + maxWords + ' từ (Vượt quá ' + (wordCount - maxWords) + ' từ)');\r\n");
      out.write("            } else {\r\n");
      out.write("                countElement.removeClass('text-danger').addClass('text-muted');\r\n");
      out.write("                countElement.text('Số từ: ' + wordCount + ' / ' + maxWords + ' từ (Còn lại: ' + remaining + ' từ)');\r\n");
      out.write("            }\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function saveTicketChanges() {\r\n");
      out.write("            if (!currentEditTicketId) {\r\n");
      out.write("                alert('Lỗi: Không tìm thấy ID ticket');\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Kiểm tra trạng thái - không cho phép đóng nếu đã resolved hoặc closed\r\n");
      out.write("            if (currentTicketStatus === 'resolved' || currentTicketStatus === 'closed') {\r\n");
      out.write("                alert('✗ Không thể đóng ticket!\\n\\nTicket đã được đóng rồi.');\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Kiểm tra ticket đã được chuyển tiếp chưa (trừ danh mục \"general\")\r\n");
      out.write("            var assignedTo = $('#edit_assignedTo').val();\r\n");
      out.write("            var isGeneralCategory = currentTicketCategory === 'general';\r\n");
      out.write("            \r\n");
      out.write("            // Với category \"general\": cho phép đóng ở bất kỳ trạng thái nào\r\n");
      out.write("            // Với category khác: phải là \"processed\" và đã được chuyển tiếp\r\n");
      out.write("            if (!isGeneralCategory) {\r\n");
      out.write("                if (currentTicketStatus !== 'processed') {\r\n");
      out.write("                    var statusText = '';\r\n");
      out.write("                    switch(currentTicketStatus) {\r\n");
      out.write("                        case 'open': statusText = 'Đang chờ'; break;\r\n");
      out.write("                        case 'in_progress': statusText = 'Đang xử lý'; break;\r\n");
      out.write("                        case 'resolved': statusText = 'Đã giải quyết'; break;\r\n");
      out.write("                        case 'closed': statusText = 'Đã đóng'; break;\r\n");
      out.write("                        default: statusText = currentTicketStatus || 'N/A';\r\n");
      out.write("                    }\r\n");
      out.write("                    alert('✗ Không thể đóng ticket!\\n\\n' +\r\n");
      out.write("                          'Chỉ có thể đóng ticket khi trạng thái là \"Đã xử lý\" (processed).\\n' +\r\n");
      out.write("                          'Trạng thái hiện tại: ' + statusText + '\\n\\n' +\r\n");
      out.write("                          'Vui lòng đợi ticket được xử lý và chuyển sang trạng thái \"Đã xử lý\" trước khi đóng.');\r\n");
      out.write("                    return;\r\n");
      out.write("                }\r\n");
      out.write("                \r\n");
      out.write("                if (!assignedTo || assignedTo === '' || assignedTo === null) {\r\n");
      out.write("                    alert('Không thể đóng ticket! Ticket chưa được chuyển tiếp (phân công cho người xử lý).\\n\\nVui lòng chuyển tiếp ticket trước khi đóng.');\r\n");
      out.write("                    return;\r\n");
      out.write("                }\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Lấy giải pháp kỹ thuật từ textarea\r\n");
      out.write("            var resolution = $('#edit_resolution').val();\r\n");
      out.write("            \r\n");
      out.write("            // Disable button\r\n");
      out.write("            $('#btnSaveTicket').prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i> Đang xử lý...');\r\n");
      out.write("            \r\n");
      out.write("            // Lấy dữ liệu - nếu category là 'general' thì gửi resolution, nếu không thì chỉ cập nhật status\r\n");
      out.write("            var data = {\r\n");
      out.write("                id: currentEditTicketId,\r\n");
      out.write("                status: 'resolved' // Tự động set status thành resolved khi đóng ticket\r\n");
      out.write("            };\r\n");
      out.write("            \r\n");
      out.write("            // Nếu category là 'general' thì cho phép gửi resolution để lưu\r\n");
      out.write("            if (isGeneralCategory && resolution && resolution.trim() !== '') {\r\n");
      out.write("                data.technicalSolution = resolution.trim();\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Submit AJAX với UTF-8\r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: 'support-update',\r\n");
      out.write("                type: 'POST',\r\n");
      out.write("                data: $.param(data), // Encode data properly\r\n");
      out.write("                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    if (response.success) {\r\n");
      out.write("                        alert('✓ Đóng ticket thành công! Trạng thái đã được cập nhật thành \"Đã giải quyết\".');\r\n");
      out.write("                        $('#editTicketModal').modal('hide');\r\n");
      out.write("                        // Reload trang để cập nhật danh sách\r\n");
      out.write("                        location.reload();\r\n");
      out.write("                    } else {\r\n");
      out.write("                        alert('✗ ' + response.message);\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function() {\r\n");
      out.write("                    alert('✗ Không thể đóng ticket. Vui lòng thử lại!');\r\n");
      out.write("                },\r\n");
      out.write("                complete: function() {\r\n");
      out.write("                    // Enable button\r\n");
      out.write("                    $('#btnSaveTicket').prop('disabled', false).html('<i class=\"fa fa-check-circle\"></i> Đóng ticket');\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        // Load ticket để chuyển tiếp\r\n");
      out.write("        var currentForwardTicketId = null;\r\n");
      out.write("        var currentForwardPriority = null; // Lưu priority hiện tại của ticket\r\n");
      out.write("        \r\n");
      out.write("        function loadTicketForForward(ticketId) {\r\n");
      out.write("            currentForwardTicketId = ticketId;\r\n");
      out.write("            currentForwardPriority = null; // Reset priority\r\n");
      out.write("            \r\n");
      out.write("            // Reset form\r\n");
      out.write("            $('#forward_ticketNumber').val('');\r\n");
      out.write("            $('#forward_subject').val('');\r\n");
      out.write("            $('#forward_ticketId').val('');\r\n");
      out.write("            $('#forward_assignedTo').html('<option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>');\r\n");
      out.write("            $('#forward_priority').val('medium');\r\n");
      out.write("            $('#forward_deadline').val('');\r\n");
      out.write("            $('#forward_deadline').removeAttr('min');\r\n");
      out.write("            \r\n");
      out.write("            // Load thông tin ticket trước để kiểm tra status\r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: 'support-detail',\r\n");
      out.write("                type: 'GET',\r\n");
      out.write("                data: { id: ticketId },\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    if (response.success) {\r\n");
      out.write("                        var ticket = response.data;\r\n");
      out.write("                        \r\n");
      out.write("                        // Kiểm tra: Nếu ticket đã resolved hoặc closed thì không cho phép chuyển tiếp\r\n");
      out.write("                        if (ticket.status === 'resolved' || ticket.status === 'closed') {\r\n");
      out.write("                            alert('✗ Không thể chuyển tiếp yêu cầu đã giải quyết!');\r\n");
      out.write("                            return;\r\n");
      out.write("                        }\r\n");
      out.write("                        \r\n");
      out.write("                        // Lưu priority hiện tại của ticket (không cho phép thay đổi)\r\n");
      out.write("                        currentForwardPriority = ticket.priority || 'medium';\r\n");
      out.write("                        \r\n");
      out.write("                        // Hiển thị modal nếu ticket chưa resolved/closed\r\n");
      out.write("                        $('#forwardTicketModal').modal('show');\r\n");
      out.write("                        \r\n");
      out.write("                        $('#forward_ticketNumber').val(ticket.ticketNumber);\r\n");
      out.write("                        $('#forward_subject').val(ticket.subject);\r\n");
      out.write("                        $('#forward_ticketId').val(ticket.id);\r\n");
      out.write("                        \r\n");
      out.write("                        // Set priority hiện tại (chỉ để hiển thị, không cho sửa)\r\n");
      out.write("                        if (ticket.priority) {\r\n");
      out.write("                            $('#forward_priority').val(ticket.priority);\r\n");
      out.write("                        } else {\r\n");
      out.write("                            $('#forward_priority').val('medium');\r\n");
      out.write("                        }\r\n");
      out.write("                        \r\n");
      out.write("                        // Set deadline (có thể chỉnh sửa) - format từ dd/MM/yyyy hoặc yyyy-MM-dd sang yyyy-MM-dd cho date input\r\n");
      out.write("                        var today = new Date();\r\n");
      out.write("                        var dd = String(today.getDate()).padStart(2, '0');\r\n");
      out.write("                        var mm = String(today.getMonth() + 1).padStart(2, '0');\r\n");
      out.write("                        var yyyy = today.getFullYear();\r\n");
      out.write("                        var todayStr = yyyy + '-' + mm + '-' + dd;\r\n");
      out.write("                        \r\n");
      out.write("                        // Set min date là hôm nay (không cho chọn ngày quá khứ)\r\n");
      out.write("                        $('#forward_deadline').attr('min', todayStr);\r\n");
      out.write("                        \r\n");
      out.write("                        if (ticket.deadline && ticket.deadline.trim() !== '' && ticket.deadline !== 'null') {\r\n");
      out.write("                            var deadlineStr = ticket.deadline.trim();\r\n");
      out.write("                            // Kiểm tra format: nếu là dd/MM/yyyy thì chuyển sang yyyy-MM-dd\r\n");
      out.write("                            if (deadlineStr.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) {\r\n");
      out.write("                                var parts = deadlineStr.split('/');\r\n");
      out.write("                                deadlineStr = parts[2] + '-' + parts[1] + '-' + parts[0]; // yyyy-MM-dd\r\n");
      out.write("                            } else if (deadlineStr.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\r\n");
      out.write("                                // Đã đúng format yyyy-MM-dd\r\n");
      out.write("                                deadlineStr = deadlineStr;\r\n");
      out.write("                            }\r\n");
      out.write("                            // Kiểm tra deadline không được là ngày quá khứ\r\n");
      out.write("                            if (deadlineStr < todayStr) {\r\n");
      out.write("                                // Nếu deadline là quá khứ, set về hôm nay\r\n");
      out.write("                                $('#forward_deadline').val(todayStr);\r\n");
      out.write("                            } else {\r\n");
      out.write("                                $('#forward_deadline').val(deadlineStr);\r\n");
      out.write("                            }\r\n");
      out.write("                        } else {\r\n");
      out.write("                            // Nếu chưa có deadline, set về hôm nay\r\n");
      out.write("                            $('#forward_deadline').val(todayStr);\r\n");
      out.write("                        }\r\n");
      out.write("                        \r\n");
      out.write("                        // Load danh sách head technicians\r\n");
      out.write("                        loadHeadTechnicians();\r\n");
      out.write("                    } else {\r\n");
      out.write("                        alert('✗ Không thể tải thông tin ticket: ' + response.message);\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function() {\r\n");
      out.write("                    alert('✗ Không thể tải thông tin ticket. Vui lòng thử lại!');\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function loadHeadTechnicians() {\r\n");
      out.write("            // Thử dùng URL tương đối trước (giống các API khác)\r\n");
      out.write("            var url1 = 'api/support-stats';\r\n");
      out.write("            // Fallback: dùng context path nếu cần\r\n");
      out.write("            var url2 = ctx + '/api/support-stats';\r\n");
      out.write("            \r\n");
      out.write("            function tryLoad(url, isFallback) {\r\n");
      out.write("                $.ajax({\r\n");
      out.write("                    url: url,\r\n");
      out.write("                    type: 'GET',\r\n");
      out.write("                    data: { action: 'getTechnicalStaff' },\r\n");
      out.write("                    dataType: 'json',\r\n");
      out.write("                    success: function(response) {\r\n");
      out.write("                        if (response && response.success && response.data) {\r\n");
      out.write("                            var select = $('#forward_assignedTo');\r\n");
      out.write("                            select.html('<option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>');\r\n");
      out.write("                            \r\n");
      out.write("                            response.data.forEach(function(tech) {\r\n");
      out.write("                                select.append('<option value=\"' + tech.id + '\">' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\r\n");
      out.write("                            });\r\n");
      out.write("                        } else {\r\n");
      out.write("                            var errorMsg = (response && response.message) ? response.message : 'Không thể tải danh sách trưởng phòng kỹ thuật';\r\n");
      out.write("                            if (!isFallback) {\r\n");
      out.write("                                // Thử fallback nếu chưa thử\r\n");
      out.write("                                tryLoad(url2, true);\r\n");
      out.write("                            } else {\r\n");
      out.write("                                alert('✗ ' + errorMsg);\r\n");
      out.write("                                console.error('Error loading head technicians:', response);\r\n");
      out.write("                            }\r\n");
      out.write("                        }\r\n");
      out.write("                    },\r\n");
      out.write("                    error: function(xhr, status, error) {\r\n");
      out.write("                        console.error('AJAX Error loading head technicians from ' + url + ':', {\r\n");
      out.write("                            status: status,\r\n");
      out.write("                            error: error,\r\n");
      out.write("                            responseText: xhr.responseText,\r\n");
      out.write("                            statusCode: xhr.status\r\n");
      out.write("                        });\r\n");
      out.write("                        if (!isFallback && url !== url2) {\r\n");
      out.write("                            // Thử fallback URL\r\n");
      out.write("                            console.log('Trying fallback URL:', url2);\r\n");
      out.write("                            tryLoad(url2, true);\r\n");
      out.write("                        } else {\r\n");
      out.write("                            // Fallback: thử dùng support-management\r\n");
      out.write("                            console.log('Trying support-management as last resort');\r\n");
      out.write("                            $.ajax({\r\n");
      out.write("                                url: 'support-management',\r\n");
      out.write("                                type: 'GET',\r\n");
      out.write("                                data: { action: 'getHeadTechnicians' },\r\n");
      out.write("                                dataType: 'json',\r\n");
      out.write("                                success: function(response) {\r\n");
      out.write("                                    if (response && response.success && response.data) {\r\n");
      out.write("                                        var select = $('#forward_assignedTo');\r\n");
      out.write("                                        select.html('<option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>');\r\n");
      out.write("                                        response.data.forEach(function(tech) {\r\n");
      out.write("                                            select.append('<option value=\"' + tech.id + '\">' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\r\n");
      out.write("                                        });\r\n");
      out.write("                                    } else {\r\n");
      out.write("                                        alert('✗ Không thể tải danh sách trưởng phòng kỹ thuật. Vui lòng thử lại!');\r\n");
      out.write("                                    }\r\n");
      out.write("                                },\r\n");
      out.write("                                error: function() {\r\n");
      out.write("                                    alert('✗ Không thể tải danh sách trưởng phòng kỹ thuật. Vui lòng thử lại! (Status: ' + xhr.status + ')');\r\n");
      out.write("                                }\r\n");
      out.write("                            });\r\n");
      out.write("                        }\r\n");
      out.write("                    }\r\n");
      out.write("                });\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Bắt đầu với URL tương đối\r\n");
      out.write("            tryLoad(url1, false);\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function forwardTicket() {\r\n");
      out.write("            var ticketId = $('#forward_ticketId').val();\r\n");
      out.write("            var assignedToId = $('#forward_assignedTo').val();\r\n");
      out.write("            // Lấy priority từ ticket hiện tại (không từ form vì đã disabled)\r\n");
      out.write("            var priority = currentForwardPriority || 'medium';\r\n");
      out.write("            // Lấy deadline từ form (có thể chỉnh sửa)\r\n");
      out.write("            var deadline = $('#forward_deadline').val();\r\n");
      out.write("            console.log('DEBUG: deadline from form =', deadline);\r\n");
      out.write("            console.log('DEBUG: deadline type =', typeof deadline);\r\n");
      out.write("            console.log('DEBUG: deadline length =', deadline ? deadline.length : 0);\r\n");
      out.write("            \r\n");
      out.write("            if (!ticketId || !assignedToId) {\r\n");
      out.write("                alert('✗ Vui lòng chọn trưởng phòng kỹ thuật');\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            if (!deadline || deadline.trim() === '') {\r\n");
      out.write("                alert('✗ Vui lòng nhập ngày mong muốn hoàn thành');\r\n");
      out.write("                $('#forward_deadline').focus();\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Validate deadline format (phải là yyyy-MM-dd)\r\n");
      out.write("            var datePattern = /^\\d{4}-\\d{2}-\\d{2}$/;\r\n");
      out.write("            if (!datePattern.test(deadline.trim())) {\r\n");
      out.write("                alert('✗ Định dạng ngày không hợp lệ. Vui lòng chọn lại ngày.');\r\n");
      out.write("                $('#forward_deadline').focus();\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("            \r\n");
      out.write("            // Disable button\r\n");
      out.write("            $('#btnForwardTicket').prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i> Đang chuyển tiếp...');\r\n");
      out.write("            \r\n");
      out.write("            // Chuẩn bị data để gửi\r\n");
      out.write("            var requestData = {\r\n");
      out.write("                action: 'forward',\r\n");
      out.write("                id: ticketId,  // SupportStatsServlet dùng 'id' thay vì 'ticketId'\r\n");
      out.write("                assignedTo: assignedToId,  // SupportStatsServlet dùng 'assignedTo' thay vì 'assignedToId'\r\n");
      out.write("                forwardPriority: priority,  // Dùng priority hiện tại của ticket (không cho phép thay đổi)\r\n");
      out.write("                forwardDeadline: deadline,  // Deadline mới (có thể chỉnh sửa)\r\n");
      out.write("                forwardNote: ''  // Có thể thêm ghi chú nếu cần\r\n");
      out.write("            };\r\n");
      out.write("            \r\n");
      out.write("            console.log('DEBUG: Sending forward request with data:', requestData);\r\n");
      out.write("            \r\n");
      out.write("            // Submit AJAX - gọi SupportStatsServlet\r\n");
      out.write("            // Gửi priority hiện tại của ticket (không cho phép thay đổi) và deadline mới\r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: 'api/support-stats',  // Dùng URL tương đối\r\n");
      out.write("                type: 'POST',\r\n");
      out.write("                data: $.param(requestData),  // Encode data properly để đảm bảo deadline được gửi đúng\r\n");
      out.write("                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    console.log('DEBUG: Forward response:', response);\r\n");
      out.write("                    if (response.success) {\r\n");
      out.write("                        alert('✓ ' + response.message);\r\n");
      out.write("                        $('#forwardTicketModal').modal('hide');\r\n");
      out.write("                        // Reload trang để cập nhật danh sách\r\n");
      out.write("                        location.reload();\r\n");
      out.write("                    } else {\r\n");
      out.write("                        alert('✗ ' + response.message);\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function(xhr, status, error) {\r\n");
      out.write("                    console.error('DEBUG: Forward error:', {xhr: xhr, status: status, error: error});\r\n");
      out.write("                    console.error('DEBUG: Response text:', xhr.responseText);\r\n");
      out.write("                    alert('✗ Không thể chuyển tiếp ticket. Vui lòng thử lại!');\r\n");
      out.write("                },\r\n");
      out.write("                complete: function() {\r\n");
      out.write("                    // Enable button\r\n");
      out.write("                    $('#btnForwardTicket').prop('disabled', false).html('<i class=\"fa fa-share\"></i> Chuyển tiếp');\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        function loadHeadTechniciansForEdit(currentAssignedTo) {\r\n");
      out.write("            // Thử dùng support-management vì getHeadTechnicians vẫn còn trong handleApiRequest\r\n");
      out.write("            $.ajax({\r\n");
      out.write("                url: 'support-management',\r\n");
      out.write("                type: 'GET',\r\n");
      out.write("                data: { action: 'getHeadTechnicians' },\r\n");
      out.write("                dataType: 'json',\r\n");
      out.write("                success: function(response) {\r\n");
      out.write("                    if (response && response.success && response.data) {\r\n");
      out.write("                        var select = $('#edit_assignedTo');\r\n");
      out.write("                        select.html('<option value=\"\">-- Chưa phân công --</option>');\r\n");
      out.write("                        \r\n");
      out.write("                        response.data.forEach(function(tech) {\r\n");
      out.write("                            var selected = (currentAssignedTo && currentAssignedTo == tech.id) ? ' selected' : '';\r\n");
      out.write("                            select.append('<option value=\"' + tech.id + '\"' + selected + '>' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\r\n");
      out.write("                        });\r\n");
      out.write("                    } else {\r\n");
      out.write("                        // Fallback: thử api/support-stats\r\n");
      out.write("                        $.ajax({\r\n");
      out.write("                            url: 'api/support-stats',\r\n");
      out.write("                            type: 'GET',\r\n");
      out.write("                            data: { action: 'getTechnicalStaff' },\r\n");
      out.write("                            dataType: 'json',\r\n");
      out.write("                            success: function(response2) {\r\n");
      out.write("                                if (response2 && response2.success && response2.data) {\r\n");
      out.write("                                    var select = $('#edit_assignedTo');\r\n");
      out.write("                                    select.html('<option value=\"\">-- Chưa phân công --</option>');\r\n");
      out.write("                                    response2.data.forEach(function(tech) {\r\n");
      out.write("                                        var selected = (currentAssignedTo && currentAssignedTo == tech.id) ? ' selected' : '';\r\n");
      out.write("                                        select.append('<option value=\"' + tech.id + '\"' + selected + '>' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\r\n");
      out.write("                                    });\r\n");
      out.write("                                }\r\n");
      out.write("                            },\r\n");
      out.write("                            error: function() {\r\n");
      out.write("                                console.error('Error loading head technicians for edit');\r\n");
      out.write("                            }\r\n");
      out.write("                        });\r\n");
      out.write("                    }\r\n");
      out.write("                },\r\n");
      out.write("                error: function(xhr, status, error) {\r\n");
      out.write("                    console.error('AJAX Error loading head technicians for edit:', {\r\n");
      out.write("                        status: status,\r\n");
      out.write("                        error: error,\r\n");
      out.write("                        responseText: xhr.responseText,\r\n");
      out.write("                        statusCode: xhr.status\r\n");
      out.write("                    });\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("    </script>\r\n");
      out.write("</body>\r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }

  private boolean _jspx_meth_c_005fchoose_005f0(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f0 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f0.setParent(null);
    int _jspx_eval_c_005fchoose_005f0 = _jspx_th_c_005fchoose_005f0.doStartTag();
    if (_jspx_eval_c_005fchoose_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                            ");
        if (_jspx_meth_c_005fwhen_005f0(_jspx_th_c_005fchoose_005f0, _jspx_page_context))
          return true;
        out.write("\r\n");
        out.write("                                            ");
        if (_jspx_meth_c_005fotherwise_005f6(_jspx_th_c_005fchoose_005f0, _jspx_page_context))
          return true;
        out.write("\r\n");
        out.write("                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f0 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f0);
    // /support_management.jsp(338,44) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f0.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${not empty tickets}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f0 = _jspx_th_c_005fwhen_005f0.doStartTag();
    if (_jspx_eval_c_005fwhen_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                ");
        if (_jspx_meth_c_005fforEach_005f0(_jspx_th_c_005fwhen_005f0, _jspx_page_context))
          return true;
        out.write("\r\n");
        out.write("                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fforEach_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fwhen_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:forEach
    org.apache.taglibs.standard.tag.rt.core.ForEachTag _jspx_th_c_005fforEach_005f0 = (org.apache.taglibs.standard.tag.rt.core.ForEachTag) _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvarStatus_005fvar_005fitems.get(org.apache.taglibs.standard.tag.rt.core.ForEachTag.class);
    _jspx_th_c_005fforEach_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fforEach_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fwhen_005f0);
    // /support_management.jsp(339,48) name = var type = java.lang.String reqTime = false required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fforEach_005f0.setVar("ticket");
    // /support_management.jsp(339,48) name = items type = javax.el.ValueExpression reqTime = true required = false fragment = false deferredValue = true expectedTypeName = java.lang.Object deferredMethod = false methodSignature = null
    _jspx_th_c_005fforEach_005f0.setItems(new org.apache.jasper.el.JspValueExpression("/support_management.jsp(339,48) '${tickets}'",_el_expressionfactory.createValueExpression(_jspx_page_context.getELContext(),"${tickets}",java.lang.Object.class)).getValue(_jspx_page_context.getELContext()));
    // /support_management.jsp(339,48) name = varStatus type = java.lang.String reqTime = false required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fforEach_005f0.setVarStatus("loop");
    int[] _jspx_push_body_count_c_005fforEach_005f0 = new int[] { 0 };
    try {
      int _jspx_eval_c_005fforEach_005f0 = _jspx_th_c_005fforEach_005f0.doStartTag();
      if (_jspx_eval_c_005fforEach_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
        do {
          out.write("\r\n");
          out.write("                                                <tr class=\"ticket-priority-");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\">\r\n");
          out.write("                                                    <td>");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${loop.index + 1}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</td>\r\n");
          out.write("                                                    <td class=\"hidden\">\r\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f1(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                    </td>\r\n");
          out.write("                                                    <td><strong>#");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.ticketNumber}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</strong></td>\r\n");
          out.write("                                                    <td>");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${not empty ticket.customerName ? ticket.customerName : 'N/A'}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</td>\r\n");
          out.write("                                                    <td>");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.subject}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</td>\r\n");
          out.write("                                                    <td>\r\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f2(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                    </td>\r\n");
          out.write("                                                    <td>\r\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f3(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                    </td>\r\n");
          out.write("                                                    <td>\r\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f4(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                    </td>\r\n");
          out.write("                                                    <td data-order=\"");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.createdAt != null ? ticket.createdAt.time : 0}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\">\r\n");
          out.write("                                                        ");
          if (_jspx_meth_fmt_005fformatDate_005f0(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                    </td>\r\n");
          out.write("                                                    <td>\r\n");
          out.write("                                                        <button class=\"btn btn-info btn-xs view-ticket-btn\" data-ticket-id=\"");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\" title=\"Xem chi tiết\">\r\n");
          out.write("                                                            <i class=\"fa fa-eye\"></i> Xem\r\n");
          out.write("                                                        </button>\r\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f5(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f6(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\r\n");
          out.write("                                                    </td>\r\n");
          out.write("                                                </tr>\r\n");
          out.write("                                                ");
          int evalDoAfterBody = _jspx_th_c_005fforEach_005f0.doAfterBody();
          if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
            break;
        } while (true);
      }
      if (_jspx_th_c_005fforEach_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
    } catch (java.lang.Throwable _jspx_exception) {
      while (_jspx_push_body_count_c_005fforEach_005f0[0]-- > 0)
        out = _jspx_page_context.popBody();
      _jspx_th_c_005fforEach_005f0.doCatch(_jspx_exception);
    } finally {
      _jspx_th_c_005fforEach_005f0.doFinally();
      _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvarStatus_005fvar_005fitems.reuse(_jspx_th_c_005fforEach_005f0);
    }
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f1 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f1.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f1 = _jspx_th_c_005fchoose_005f1.doStartTag();
    if (_jspx_eval_c_005fchoose_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f1(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f0(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f1.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f1);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f1);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f1 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f1.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    // /support_management.jsp(344,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f1.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'open'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f1 = _jspx_th_c_005fwhen_005f1.doStartTag();
    if (_jspx_eval_c_005fwhen_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write('0');
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f1.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f1);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f1);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f0 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    int _jspx_eval_c_005fotherwise_005f0 = _jspx_th_c_005fotherwise_005f0.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write('1');
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f2 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f2.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f2 = _jspx_th_c_005fchoose_005f2.doStartTag();
    if (_jspx_eval_c_005fchoose_005f2 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f2(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f3(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f4(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f5(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f1(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f2.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f2);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f2);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f2 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f2.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(353,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f2.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'technical'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f2 = _jspx_th_c_005fwhen_005f2.doStartTag();
    if (_jspx_eval_c_005fwhen_005f2 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-info'>Kỹ thuật</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f2.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f2);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f2);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f3 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f3.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(356,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f3.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'billing'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f3 = _jspx_th_c_005fwhen_005f3.doStartTag();
    if (_jspx_eval_c_005fwhen_005f3 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-success'>Thanh toán</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f3.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f3);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f3);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f4 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f4.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(359,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f4.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'general'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f4 = _jspx_th_c_005fwhen_005f4.doStartTag();
    if (_jspx_eval_c_005fwhen_005f4 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-default'>Chung</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f4.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f4);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f4);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f5 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f5.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(362,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f5.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'complaint'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f5 = _jspx_th_c_005fwhen_005f5.doStartTag();
    if (_jspx_eval_c_005fwhen_005f5 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-danger'>Khiếu nại</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f5.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f5);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f5);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f1 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f1.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    int _jspx_eval_c_005fotherwise_005f1 = _jspx_th_c_005fotherwise_005f1.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-default'>");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f1.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f1);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f1);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f3 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f3.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f3 = _jspx_th_c_005fchoose_005f3.doStartTag();
    if (_jspx_eval_c_005fchoose_005f3 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f6(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f7(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f8(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f9(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f2(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f3.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f3);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f3);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f6(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f6 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f6.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f6.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(372,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f6.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'low'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f6 = _jspx_th_c_005fwhen_005f6.doStartTag();
    if (_jspx_eval_c_005fwhen_005f6 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-info'>Thấp</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f6.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f6.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f6);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f6);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f7(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f7 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f7.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f7.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(375,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f7.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'medium'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f7 = _jspx_th_c_005fwhen_005f7.doStartTag();
    if (_jspx_eval_c_005fwhen_005f7 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-warning'>Trung bình</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f7.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f7.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f7);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f7);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f8(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f8 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f8.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f8.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(378,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f8.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'high'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f8 = _jspx_th_c_005fwhen_005f8.doStartTag();
    if (_jspx_eval_c_005fwhen_005f8 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-danger label-priority-high'>Cao</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f8.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f8.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f8);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f8);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f9(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f9 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f9.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f9.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(381,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f9.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'urgent'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f9 = _jspx_th_c_005fwhen_005f9.doStartTag();
    if (_jspx_eval_c_005fwhen_005f9 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-danger label-priority-urgent'>Khẩn cấp</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f9.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f9.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f9);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f9);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f2 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f2.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    int _jspx_eval_c_005fotherwise_005f2 = _jspx_th_c_005fotherwise_005f2.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f2 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-default'>");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f2.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f2);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f2);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f4 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f4.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f4 = _jspx_th_c_005fchoose_005f4.doStartTag();
    if (_jspx_eval_c_005fchoose_005f4 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f10(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f11(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f12(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f13(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f3(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f4.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f4);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f4);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f10(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f10 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f10.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f10.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    // /support_management.jsp(391,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f10.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'open'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f10 = _jspx_th_c_005fwhen_005f10.doStartTag();
    if (_jspx_eval_c_005fwhen_005f10 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-primary'>Đang chờ</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f10.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f10.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f10);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f10);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f11(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f11 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f11.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f11.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    // /support_management.jsp(394,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f11.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'in_progress'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f11 = _jspx_th_c_005fwhen_005f11.doStartTag();
    if (_jspx_eval_c_005fwhen_005f11 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-primary label-status-in_progress'>Đang xử lý</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f11.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f11.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f11);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f11);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f12(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f12 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f12.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f12.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    // /support_management.jsp(397,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f12.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'processed'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f12 = _jspx_th_c_005fwhen_005f12.doStartTag();
    if (_jspx_eval_c_005fwhen_005f12 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-info'>Đã xử lý</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f12.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f12.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f12);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f12);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f13(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f13 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f13.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f13.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    // /support_management.jsp(400,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f13.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'resolved' || ticket.status == 'closed'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f13 = _jspx_th_c_005fwhen_005f13.doStartTag();
    if (_jspx_eval_c_005fwhen_005f13 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-success'>Đã giải quyết</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f13.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f13.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f13);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f13);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f3 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f3.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    int _jspx_eval_c_005fotherwise_005f3 = _jspx_th_c_005fotherwise_005f3.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f3 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <span class='label label-default'>");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("</span>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f3.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f3);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f3);
    return false;
  }

  private boolean _jspx_meth_fmt_005fformatDate_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  fmt:formatDate
    org.apache.taglibs.standard.tag.rt.fmt.FormatDateTag _jspx_th_fmt_005fformatDate_005f0 = (org.apache.taglibs.standard.tag.rt.fmt.FormatDateTag) _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.get(org.apache.taglibs.standard.tag.rt.fmt.FormatDateTag.class);
    _jspx_th_fmt_005fformatDate_005f0.setPageContext(_jspx_page_context);
    _jspx_th_fmt_005fformatDate_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    // /support_management.jsp(409,56) name = value type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_fmt_005fformatDate_005f0.setValue((java.util.Date) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.createdAt}", java.util.Date.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
    // /support_management.jsp(409,56) name = pattern type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_fmt_005fformatDate_005f0.setPattern("dd/MM/yyyy HH:mm");
    int _jspx_eval_fmt_005fformatDate_005f0 = _jspx_th_fmt_005fformatDate_005f0.doStartTag();
    if (_jspx_th_fmt_005fformatDate_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.reuse(_jspx_th_fmt_005fformatDate_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.reuse(_jspx_th_fmt_005fformatDate_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f5 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f5.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f5 = _jspx_th_c_005fchoose_005f5.doStartTag();
    if (_jspx_eval_c_005fchoose_005f5 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f14(_jspx_th_c_005fchoose_005f5, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f4(_jspx_th_c_005fchoose_005f5, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f5.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f5);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f5);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f14(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f5, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f14 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f14.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f14.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f5);
    // /support_management.jsp(416,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f14.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'resolved' || ticket.status == 'closed'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f14 = _jspx_th_c_005fwhen_005f14.doStartTag();
    if (_jspx_eval_c_005fwhen_005f14 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <button class=\"btn btn-warning btn-xs\" disabled title=\"Không thể chỉnh sửa ticket đã giải quyết\">\r\n");
        out.write("                                                                    <i class=\"fa fa-edit\"></i> Sửa\r\n");
        out.write("                                                                </button>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f14.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f14.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f14);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f14);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f5, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f4 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f4.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f5);
    int _jspx_eval_c_005fotherwise_005f4 = _jspx_th_c_005fotherwise_005f4.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f4 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <button class=\"btn btn-warning btn-xs edit-ticket-btn\" data-ticket-id=\"");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("\" title=\"Chỉnh sửa\">\r\n");
        out.write("                                                                    <i class=\"fa fa-edit\"></i> Sửa\r\n");
        out.write("                                                                </button>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f4.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f4);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f4);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f6(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f6 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f6.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f6.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f6 = _jspx_th_c_005fchoose_005f6.doStartTag();
    if (_jspx_eval_c_005fchoose_005f6 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f15(_jspx_th_c_005fchoose_005f6, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f16(_jspx_th_c_005fchoose_005f6, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f17(_jspx_th_c_005fchoose_005f6, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f5(_jspx_th_c_005fchoose_005f6, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f6.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f6.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f6);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f6);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f15(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f6, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f15 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f15.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f15.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f6);
    // /support_management.jsp(428,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f15.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'general'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f15 = _jspx_th_c_005fwhen_005f15.doStartTag();
    if (_jspx_eval_c_005fwhen_005f15 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <!-- Ẩn nút chuyển tiếp cho danh mục \"Chung\" -->\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f15.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f15.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f15);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f15);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f16(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f6, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f16 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f16.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f16.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f6);
    // /support_management.jsp(431,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f16.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'resolved' || ticket.status == 'closed'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f16 = _jspx_th_c_005fwhen_005f16.doStartTag();
    if (_jspx_eval_c_005fwhen_005f16 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <button class=\"btn btn-success btn-xs\" disabled title=\"Không thể chuyển tiếp yêu cầu đã giải quyết\">\r\n");
        out.write("                                                                    <i class=\"fa fa-share\"></i> Chuyển tiếp\r\n");
        out.write("                                                                </button>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f16.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f16.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f16);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f16);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f17(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f6, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f17 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f17.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f17.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f6);
    // /support_management.jsp(436,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f17.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'in_progress'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f17 = _jspx_th_c_005fwhen_005f17.doStartTag();
    if (_jspx_eval_c_005fwhen_005f17 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <button class=\"btn btn-success btn-xs\" disabled style=\"opacity: 0.5; cursor: not-allowed;\" title=\"Không thể chuyển tiếp yêu cầu đang xử lý\">\r\n");
        out.write("                                                                    <i class=\"fa fa-share\"></i> Chuyển tiếp\r\n");
        out.write("                                                                </button>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f17.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f17.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f17);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f17);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f6, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f5 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f5.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f6);
    int _jspx_eval_c_005fotherwise_005f5 = _jspx_th_c_005fotherwise_005f5.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f5 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                <button class=\"btn btn-success btn-xs forward-ticket-btn\" data-ticket-id=\"");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("\" title=\"Chuyển tiếp cho trưởng phòng kỹ thuật\">\r\n");
        out.write("                                                                    <i class=\"fa fa-share\"></i> Chuyển tiếp\r\n");
        out.write("                                                                </button>\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f5.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f5);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f5);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f6(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f6 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f6.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f6.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f0);
    int _jspx_eval_c_005fotherwise_005f6 = _jspx_th_c_005fotherwise_005f6.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f6 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                <tr>\r\n");
        out.write("                                                    <td colspan=\"10\" class=\"text-center\">\r\n");
        out.write("                                                        <i class=\"fa fa-info-circle\"></i> \r\n");
        out.write("                                                        ");
        if (_jspx_meth_c_005fchoose_005f7(_jspx_th_c_005fotherwise_005f6, _jspx_page_context))
          return true;
        out.write("\r\n");
        out.write("                                                    </td>\r\n");
        out.write("                                                </tr>\r\n");
        out.write("                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f6.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f6.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f6);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f6);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f7(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fotherwise_005f6, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f7 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f7.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f7.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fotherwise_005f6);
    int _jspx_eval_c_005fchoose_005f7 = _jspx_th_c_005fchoose_005f7.doStartTag();
    if (_jspx_eval_c_005fchoose_005f7 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f18(_jspx_th_c_005fchoose_005f7, _jspx_page_context))
          return true;
        out.write("\r\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f7(_jspx_th_c_005fchoose_005f7, _jspx_page_context))
          return true;
        out.write("\r\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f7.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f7.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f7);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f7);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f18(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f7, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f18 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f18.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f18.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f7);
    // /support_management.jsp(456,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f18.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${not empty param.status or not empty param.priority or not empty param.category}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f18 = _jspx_th_c_005fwhen_005f18.doStartTag();
    if (_jspx_eval_c_005fwhen_005f18 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                Không tìm thấy yêu cầu hỗ trợ phù hợp với bộ lọc\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f18.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f18.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f18);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f18);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f7(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f7, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f7 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f7.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f7.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f7);
    int _jspx_eval_c_005fotherwise_005f7 = _jspx_th_c_005fotherwise_005f7.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f7 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("                                                                Không có yêu cầu hỗ trợ nào\r\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f7.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f7.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f7);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f7);
    return false;
  }
}

/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2025-11-12 09:56:47 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.util.Set;

public final class support_005fmanagement_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fchoose;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvar_005fitems;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fotherwise;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fc_005fchoose = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvar_005fitems = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fc_005fotherwise = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fc_005fchoose.release();
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.release();
    _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvar_005fitems.release();
    _005fjspx_005ftagPool_005fc_005fotherwise.release();
    _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");

    // Kiểm tra đăng nhập
    String username = (String) session.getAttribute("username");
    Boolean isLoggedIn = (Boolean) session.getAttribute("isLoggedIn");
    String userRole = (String) session.getAttribute("userRole");
    
    if (username == null || isLoggedIn == null || !isLoggedIn) {
        response.sendRedirect(request.getContextPath() + "/login.jsp");
        return;
    }
    
    // Kiểm tra quyền: chỉ người có quyền manage_support_requests mới truy cập được
    @SuppressWarnings("unchecked")
    Set<String> userPermissions = (Set<String>) session.getAttribute("userPermissions");
    if (userPermissions == null || !userPermissions.contains("manage_support_requests")) {
        response.sendRedirect(request.getContextPath() + "/error/403.jsp");
        return;
    }

      out.write("\n");
      out.write("<!DOCTYPE html>\n");
      out.write("<html>\n");
      out.write("<head>\n");
      out.write("    <meta charset=\"UTF-8\">\n");
      out.write("    <title>Quản Lý Yêu Cầu Hỗ Trợ | Bảng Điều Khiển</title>\n");
      out.write("    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>\n");
      out.write("    \n");
      out.write("    <!-- bootstrap 3.0.2 -->\n");
      out.write("    <link href=\"css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n");
      out.write("    <!-- font Awesome -->\n");
      out.write("    <link href=\"css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n");
      out.write("    <!-- Ionicons -->\n");
      out.write("    <link href=\"css/ionicons.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n");
      out.write("    <!-- DataTables -->\n");
      out.write("    <link href=\"css/datatables/dataTables.bootstrap.css\" rel=\"stylesheet\" type=\"text/css\" />\n");
      out.write("    <!-- Theme style -->\n");
      out.write("    <link href=\"css/style.css\" rel=\"stylesheet\" type=\"text/css\" />\n");
      out.write("\n");
      out.write("    <style>\n");
      out.write("         .filter-section {\n");
      out.write("             background: #f9f9f9;\n");
      out.write("            padding: 15px;\n");
      out.write("             margin-bottom: 20px;\n");
      out.write("            border-radius: 5px;\n");
      out.write("         }\n");
      out.write("         .ticket-priority-urgent { border-left: 4px solid #d9534f; }\n");
      out.write("         .ticket-priority-high { border-left: 4px solid #d9534f; }\n");
      out.write("         .ticket-priority-medium { border-left: 4px solid #5bc0de; }\n");
      out.write("         .ticket-priority-low { border-left: 4px solid #5cb85c; }\n");
      out.write("         \n");
      out.write("         /* Màu cho độ ưu tiên và trạng thái - đồng nhất */\n");
      out.write("         .label-priority-high { background-color: #d9534f !important; }\n");
      out.write("         .label-priority-urgent { background-color: #d9534f !important; }\n");
      out.write("         .label-status-in_progress { background-color: #337ab7 !important; }\n");
      out.write("         \n");
      out.write("         /* Tối ưu cho tiếng Việt */\n");
      out.write("         #detailDescription {\n");
      out.write("             font-family: 'Segoe UI', Tahoma, Arial, sans-serif;\n");
      out.write("             line-height: 1.5;\n");
      out.write("             direction: ltr;\n");
      out.write("             unicode-bidi: embed;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Placeholder styling cho tiếng Việt */\n");
      out.write("         #detailDescription::placeholder {\n");
      out.write("             color: #999;\n");
      out.write("             font-style: italic;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Styling cho các trường bị khóa */\n");
      out.write("         input[readonly], textarea[readonly], select[disabled] {\n");
      out.write("             background-color: #f5f5f5;\n");
      out.write("             color: #666;\n");
      out.write("             cursor: not-allowed;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Styling cho các trường được phép chỉnh sửa */\n");
      out.write("         input:not([readonly]), textarea:not([readonly]), select:not([disabled]) {\n");
      out.write("             background-color: #fff;\n");
      out.write("             border-color: #5bc0de;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Label styling để phân biệt */\n");
      out.write("         .form-group label {\n");
      out.write("             font-weight: bold;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         .form-group label:after {\n");
      out.write("             content: \" *\";\n");
      out.write("             color: #5bc0de;\n");
      out.write("             font-weight: normal;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Loại bỏ dấu * cho các trường readonly */\n");
      out.write("         input[readonly] + label:after,\n");
      out.write("         textarea[readonly] + label:after,\n");
      out.write("         select[disabled] + label:after {\n");
      out.write("             display: none;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Ẩn phần \"records per page\" của DataTables */\n");
      out.write("         .dataTables_length {\n");
      out.write("             display: none !important;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Tối ưu hiển thị cho modal chi tiết ticket - tránh tràn chữ */\n");
      out.write("         .ticket-detail-view {\n");
      out.write("             word-wrap: break-word;\n");
      out.write("             overflow-wrap: break-word;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         .ticket-detail-view * {\n");
      out.write("             max-width: 100%;\n");
      out.write("             box-sizing: border-box;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         .ticket-detail-view h5 {\n");
      out.write("             margin-top: 0;\n");
      out.write("             margin-bottom: 12px;\n");
      out.write("             font-size: 16px;\n");
      out.write("             font-weight: 600;\n");
      out.write("             color: #2c3e50;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Tối ưu cho phần hợp đồng và sản phẩm */\n");
      out.write("         .contract-product-section {\n");
      out.write("             word-wrap: break-word;\n");
      out.write("             word-break: break-word;\n");
      out.write("             overflow-wrap: break-word;\n");
      out.write("             white-space: normal;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Responsive cho modal */\n");
      out.write("         @media (max-width: 768px) {\n");
      out.write("             .ticket-detail-view .row {\n");
      out.write("                 margin-left: 0;\n");
      out.write("                 margin-right: 0;\n");
      out.write("             }\n");
      out.write("             \n");
      out.write("             .ticket-detail-view .col-md-8,\n");
      out.write("             .ticket-detail-view .col-md-4 {\n");
      out.write("                 padding-left: 0;\n");
      out.write("                 padding-right: 0;\n");
      out.write("                 width: 100%;\n");
      out.write("             }\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("         /* Tối ưu cho các box thông tin */\n");
      out.write("         .ticket-detail-view > div[style*=\"background\"] {\n");
      out.write("             word-wrap: break-word;\n");
      out.write("             overflow-wrap: break-word;\n");
      out.write("         }\n");
      out.write("         \n");
      out.write("    </style>\n");
      out.write("</head>\n");
      out.write("<body class=\"skin-black\">\n");
      out.write("    <!-- header logo: style can be found in header.less -->\n");
      out.write("    <header class=\"header\">\n");
      out.write("        <a href=\"support-management\" class=\"logo\">\n");
      out.write("            Quản Lý Yêu Cầu Hỗ Trợ\n");
      out.write("        </a>\n");
      out.write("        <!-- Header Navbar: style can be found in header.less -->\n");
      out.write("        <nav class=\"navbar navbar-static-top\" role=\"navigation\">\n");
      out.write("            <!-- Sidebar toggle button-->\n");
      out.write("            <a href=\"#\" class=\"navbar-btn sidebar-toggle\" data-toggle=\"offcanvas\" role=\"button\">\n");
      out.write("                <span class=\"sr-only\">Toggle navigation</span>\n");
      out.write("                <span class=\"icon-bar\"></span>\n");
      out.write("                <span class=\"icon-bar\"></span>\n");
      out.write("                <span class=\"icon-bar\"></span>\n");
      out.write("            </a>\n");
      out.write("            <div class=\"navbar-right\">\n");
      out.write("                <ul class=\"nav navbar-nav\">\n");
      out.write("                    <!-- User Account: style can be found in dropdown.less -->\n");
      out.write("                    <li class=\"dropdown user user-menu\">\n");
      out.write("                        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n");
      out.write("                            <i class=\"fa fa-user\"></i>\n");
      out.write("                            <span>");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${sessionScope.username}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(" <i class=\"caret\"></i></span>\n");
      out.write("                        </a>\n");
      out.write("                        <ul class=\"dropdown-menu dropdown-custom dropdown-menu-right\">\n");
      out.write("                            <li class=\"dropdown-header text-center\">Tài khoản</li>\n");
      out.write("                            <li>\n");
      out.write("                                <a href=\"profile.jsp\">\n");
      out.write("                                <i class=\"fa fa-user fa-fw pull-right\"></i>\n");
      out.write("                                    Hồ sơ\n");
      out.write("                                </a>\n");
      out.write("                                <a href=\"settings.jsp\">\n");
      out.write("                                <i class=\"fa fa-cog fa-fw pull-right\"></i>\n");
      out.write("                                    Cài đặt cá nhân\n");
      out.write("                                </a>\n");
      out.write("                            </li>\n");
      out.write("                            <li class=\"divider\"></li>\n");
      out.write("                            <li>\n");
      out.write("                                <a href=\"logout\"><i class=\"fa fa-ban fa-fw pull-right\"></i> Đăng xuất</a>\n");
      out.write("                            </li>\n");
      out.write("                        </ul>\n");
      out.write("                    </li>\n");
      out.write("                </ul>\n");
      out.write("            </div>\n");
      out.write("        </nav>\n");
      out.write("    </header>\n");
      out.write("    \n");
      out.write("    <div class=\"wrapper row-offcanvas row-offcanvas-left\">\n");
      out.write("        <!-- Left side column. contains the logo and sidebar -->\n");
      out.write("\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "partials/sidebar.jsp", out, false);
      out.write("\n");
      out.write("\n");
      out.write("        <aside class=\"right-side\">\n");
      out.write("            <!-- Main content -->\n");
      out.write("            <section class=\"content\">\n");
      out.write("                <!-- Filter Section -->\n");
      out.write("                <div class=\"filter-section\">\n");
      out.write("                    <form method=\"GET\" action=\"support-management\">\n");
      out.write("                <div class=\"row\">\n");
      out.write("                        <div class=\"col-md-3\">\n");
      out.write("                            <label>Trạng thái:</label>\n");
      out.write("                                <select name=\"status\" class=\"form-control\">\n");
      out.write("                                            <option value=\"\">Tất cả</option>\n");
      out.write("                                    <option value=\"open\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.status == 'open' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Đang chờ</option>\n");
      out.write("                                    <option value=\"in_progress\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.status == 'in_progress' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Đang xử lý</option>\n");
      out.write("                                    <option value=\"resolved\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.status == 'resolved' || param.status == 'closed' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Đã giải quyết</option>\n");
      out.write("                                        </select>\n");
      out.write("                                    </div>\n");
      out.write("                        <div class=\"col-md-3\">\n");
      out.write("                            <label>Độ ưu tiên:</label>\n");
      out.write("                                <select name=\"priority\" class=\"form-control\">\n");
      out.write("                                            <option value=\"\">Tất cả</option>\n");
      out.write("                                    <option value=\"urgent\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'urgent' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Khẩn cấp</option>\n");
      out.write("                                    <option value=\"high\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'high' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Cao</option>\n");
      out.write("                                    <option value=\"medium\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'medium' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Trung bình</option>\n");
      out.write("                                    <option value=\"low\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.priority == 'low' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Thấp</option>\n");
      out.write("                                        </select>\n");
      out.write("                                    </div>\n");
      out.write("                        <div class=\"col-md-3\">\n");
      out.write("                            <label>Danh mục:</label>\n");
      out.write("                                <select name=\"category\" class=\"form-control\">\n");
      out.write("                                <option value=\"\">Tất cả</option>\n");
      out.write("                                    <option value=\"technical\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'technical' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Kỹ thuật</option>\n");
      out.write("                                    <option value=\"billing\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'billing' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Thanh toán</option>\n");
      out.write("                                    <option value=\"general\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'general' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Chung</option>\n");
      out.write("                                    <option value=\"complaint\" ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.category == 'complaint' ? 'selected' : ''}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(">Khiếu nại</option>\n");
      out.write("                            </select>\n");
      out.write("                                    </div>\n");
      out.write("                        <div class=\"col-md-3\">\n");
      out.write("                            <label>&nbsp;</label><br>\n");
      out.write("                                <button type=\"submit\" class=\"btn btn-primary\">\n");
      out.write("                                        <i class=\"fa fa-filter\"></i> Lọc\n");
      out.write("                                    </button>\n");
      out.write("                                <a href=\"support-management\" class=\"btn btn-default\">\n");
      out.write("                                 <i class=\"fa fa-refresh\"></i> Xóa bộ lọc\n");
      out.write("                                </a>\n");
      out.write("                            </div>\n");
      out.write("                        </div>\n");
      out.write("                    </form>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("                <!-- Tickets Table -->\n");
      out.write("                <div class=\"row\">\n");
      out.write("                    <div class=\"col-md-12\">\n");
      out.write("                        <section class=\"panel\">\n");
      out.write("                            <header class=\"panel-heading\">\n");
      out.write("                                <h3>Danh sách yêu cầu hỗ trợ</h3>\n");
      out.write("                            </header>\n");
      out.write("                            <div class=\"panel-body\">\n");
      out.write("                                <div class=\"table-responsive\">\n");
      out.write("                                    <table id=\"ticketsTable\" class=\"table table-striped table-bordered table-hover\">\n");
      out.write("                                    <thead>\n");
      out.write("                                        <tr>\n");
      out.write("                                                <th>ID</th>\n");
      out.write("                                                <th>Mã Ticket</th>\n");
      out.write("                                            <th>Khách hàng</th>\n");
      out.write("                                            <th>Tiêu đề</th>\n");
      out.write("                                                <th>Danh mục</th>\n");
      out.write("                                                <th>Độ ưu tiên</th>\n");
      out.write("                                                <th>Trạng thái</th>\n");
      out.write("                                                <th>Ngày tạo</th>\n");
      out.write("                                                <th>Thao tác</th>\n");
      out.write("                                        </tr>\n");
      out.write("                                    </thead>\n");
      out.write("                                    <tbody>\n");
      out.write("                                        ");
      if (_jspx_meth_c_005fchoose_005f0(_jspx_page_context))
        return;
      out.write("\n");
      out.write("                                    </tbody>\n");
      out.write("                                </table>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("            </section>\n");
      out.write("                            </div>\n");
      out.write("                        </div>\n");
      out.write("            </section><!-- /.content -->\n");
      out.write("        </aside><!-- /.right-side -->\n");
      out.write("    </div><!-- ./wrapper -->\n");
      out.write("\n");
      out.write("    <!-- Modal Xem Chi Tiết Ticket -->\n");
      out.write("    <div class=\"modal fade\" id=\"viewTicketModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"viewTicketModalLabel\">\n");
      out.write("        <div class=\"modal-dialog modal-lg\" role=\"document\">\n");
      out.write("            <div class=\"modal-content\">\n");
      out.write("                <div class=\"modal-header\" style=\"background-color: #3c8dbc; color: white;\">\n");
      out.write("                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" style=\"color: white; opacity: 0.8;\">\n");
      out.write("                        <span aria-hidden=\"true\">&times;</span>\n");
      out.write("                    </button>\n");
      out.write("                    <h4 class=\"modal-title\" id=\"viewTicketModalLabel\">\n");
      out.write("                        <i class=\"fa fa-ticket\"></i> Chi Tiết Yêu Cầu Hỗ Trợ\n");
      out.write("                    </h4>\n");
      out.write("                </div>\n");
      out.write("                <div class=\"modal-body\" id=\"ticketDetailContent\">\n");
      out.write("                    <div class=\"text-center\">\n");
      out.write("                        <i class=\"fa fa-spinner fa-spin fa-3x\"></i>\n");
      out.write("                        <p>Đang tải dữ liệu...</p>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("                <div class=\"modal-footer\">\n");
      out.write("                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">\n");
      out.write("                        <i class=\"fa fa-times\"></i> Đóng\n");
      out.write("                    </button>\n");
      out.write("                </div>\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("    </div>\n");
      out.write("\n");
      out.write("    <!-- Modal Sửa Ticket -->\n");
      out.write("    <div class=\"modal fade\" id=\"editTicketModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"editTicketModalLabel\">\n");
      out.write("        <div class=\"modal-dialog modal-lg\" role=\"document\">\n");
      out.write("            <div class=\"modal-content\">\n");
      out.write("                <div class=\"modal-header\" style=\"background-color: #f39c12; color: white;\">\n");
      out.write("                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" style=\"color: white; opacity: 0.8;\">\n");
      out.write("                        <span aria-hidden=\"true\">&times;</span>\n");
      out.write("                    </button>\n");
      out.write("                    <h4 class=\"modal-title\" id=\"editTicketModalLabel\">\n");
      out.write("                        <i class=\"fa fa-edit\"></i> Cập Nhật Yêu Cầu Hỗ Trợ\n");
      out.write("                    </h4>\n");
      out.write("                </div>\n");
      out.write("                <form id=\"editTicketForm\">\n");
      out.write("                    <div class=\"modal-body\" id=\"editTicketContent\">\n");
      out.write("                        <div class=\"text-center\">\n");
      out.write("                            <i class=\"fa fa-spinner fa-spin fa-3x\"></i>\n");
      out.write("                            <p>Đang tải dữ liệu...</p>\n");
      out.write("                        </div>\n");
      out.write("                    </div>\n");
      out.write("                    <div class=\"modal-footer\">\n");
      out.write("                        <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">\n");
      out.write("                            <i class=\"fa fa-times\"></i> Hủy\n");
      out.write("                        </button>\n");
      out.write("                        <button type=\"submit\" class=\"btn btn-warning\" id=\"btnSaveTicket\">\n");
      out.write("                            <i class=\"fa fa-check-circle\"></i> Đóng ticket\n");
      out.write("                        </button>\n");
      out.write("                    </div>\n");
      out.write("                </form>\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("    </div>\n");
      out.write("\n");
      out.write("    <!-- Modal Chuyển tiếp Ticket -->\n");
      out.write("    <div class=\"modal fade\" id=\"forwardTicketModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"forwardTicketModalLabel\">\n");
      out.write("        <div class=\"modal-dialog\" role=\"document\">\n");
      out.write("            <div class=\"modal-content\">\n");
      out.write("                <div class=\"modal-header\" style=\"background-color: #5cb85c; color: white;\">\n");
      out.write("                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" style=\"color: white; opacity: 0.8;\">\n");
      out.write("                        <span aria-hidden=\"true\">&times;</span>\n");
      out.write("                    </button>\n");
      out.write("                    <h4 class=\"modal-title\" id=\"forwardTicketModalLabel\">\n");
      out.write("                        <i class=\"fa fa-share\"></i> Chuyển tiếp Ticket cho Trưởng phòng Kỹ thuật\n");
      out.write("                    </h4>\n");
      out.write("                </div>\n");
      out.write("                <form id=\"forwardTicketForm\">\n");
      out.write("                    <div class=\"modal-body\">\n");
      out.write("                        <div class=\"form-group\">\n");
      out.write("                            <label>Mã Ticket:</label>\n");
      out.write("                            <input type=\"text\" class=\"form-control\" id=\"forward_ticketNumber\" readonly>\n");
      out.write("                            <input type=\"hidden\" id=\"forward_ticketId\">\n");
      out.write("                        </div>\n");
      out.write("                        <div class=\"form-group\">\n");
      out.write("                            <label>Tiêu đề:</label>\n");
      out.write("                            <input type=\"text\" class=\"form-control\" id=\"forward_subject\" readonly>\n");
      out.write("                        </div>\n");
      out.write("                        <div class=\"form-group\">\n");
      out.write("                            <label>Trưởng phòng Kỹ thuật nhận: <span class=\"text-danger\">*</span></label>\n");
      out.write("                            <select class=\"form-control\" id=\"forward_assignedTo\" required>\n");
      out.write("                                <option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>\n");
      out.write("                            </select>\n");
      out.write("                            <small class=\"text-muted\">Mỗi ticket sẽ được gửi riêng biệt cho từng trưởng phòng kỹ thuật</small>\n");
      out.write("                        </div>\n");
      out.write("                        <div class=\"form-group\">\n");
      out.write("                            <label>Độ ưu tiên:</label>\n");
      out.write("                            <select class=\"form-control\" id=\"forward_priority\" disabled>\n");
      out.write("                                <option value=\"urgent\">Khẩn cấp</option>\n");
      out.write("                                <option value=\"high\">Cao</option>\n");
      out.write("                                <option value=\"medium\" selected>Trung bình</option>\n");
      out.write("                                <option value=\"low\">Thấp</option>\n");
      out.write("                            </select>\n");
      out.write("                            <small class=\"text-muted\">Độ ưu tiên không thể thay đổi khi chuyển tiếp</small>\n");
      out.write("                        </div>\n");
      out.write("                        <div class=\"form-group\">\n");
      out.write("                            <label>Ngày mong muốn hoàn thành:</label>\n");
      out.write("                            <input type=\"text\" class=\"form-control\" id=\"forward_deadline\" readonly>\n");
      out.write("                            <small class=\"text-muted\">Ngày mong muốn hoàn thành của ticket</small>\n");
      out.write("                        </div>\n");
      out.write("                    </div>\n");
      out.write("                    <div class=\"modal-footer\">\n");
      out.write("                        <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">\n");
      out.write("                            <i class=\"fa fa-times\"></i> Hủy\n");
      out.write("                        </button>\n");
      out.write("                        <button type=\"submit\" class=\"btn btn-success\" id=\"btnForwardTicket\">\n");
      out.write("                            <i class=\"fa fa-share\"></i> Chuyển tiếp\n");
      out.write("                        </button>\n");
      out.write("                    </div>\n");
      out.write("                </form>\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("    </div>\n");
      out.write("\n");
      out.write("\n");
      out.write("    <!-- jQuery 2.0.2 -->\n");
      out.write("    <script src=\"http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js\"></script>\n");
      out.write("    <script src=\"js/jquery.min.js\" type=\"text/javascript\"></script>\n");
      out.write("    <!-- jQuery UI 1.10.3 -->\n");
      out.write("    <script src=\"js/jquery-ui-1.10.3.min.js\" type=\"text/javascript\"></script>\n");
      out.write("    <!-- Bootstrap -->\n");
      out.write("    <script src=\"js/bootstrap.min.js\" type=\"text/javascript\"></script>\n");
      out.write("    <!-- DataTables -->\n");
      out.write("    <script src=\"js/plugins/datatables/jquery.dataTables.js\" type=\"text/javascript\"></script>\n");
      out.write("    <script src=\"js/plugins/datatables/dataTables.bootstrap.js\" type=\"text/javascript\"></script>\n");
      out.write("    <!-- Director App -->\n");
      out.write("    <script src=\"js/Director/app.js\" type=\"text/javascript\"></script>\n");
      out.write("\n");
      out.write("    <script>\n");
      out.write("        // Lấy context path để dùng trong AJAX calls\n");
      out.write("        var ctx = '");
      out.print(request.getContextPath());
      out.write("';\n");
      out.write("        // Đảm bảo context path không có dấu slash thừa\n");
      out.write("        if (ctx && ctx.endsWith('/')) {\n");
      out.write("            ctx = ctx.substring(0, ctx.length - 1);\n");
      out.write("        }\n");
      out.write("        \n");
      out.write("        $(document).ready(function() {\n");
      out.write("            // Kiểm tra xem có dữ liệu không trước khi khởi tạo DataTable\n");
      out.write("            var table = $('#ticketsTable');\n");
      out.write("            var hasData = table.find('tbody tr').length > 0 && \n");
      out.write("                         !table.find('tbody tr:first td[colspan]').length;\n");
      out.write("            \n");
      out.write("            if (hasData) {\n");
      out.write("                // Khởi tạo DataTable với dữ liệu đã có sẵn trong HTML\n");
      out.write("                table.DataTable({\n");
      out.write("                    \"language\": {\n");
      out.write("                        \"url\": \"//cdn.datatables.net/plug-ins/1.10.24/i18n/Vietnamese.json\"\n");
      out.write("                    },\n");
      out.write("                    \"pageLength\": 10, // Hiển thị 10 bản ghi mỗi trang\n");
      out.write("                    \"lengthChange\": false, // Ẩn dropdown \"records per page\"\n");
      out.write("                    \"paging\": true, // Bật phân trang\n");
      out.write("                    \"pagingType\": \"full_numbers\", // Hiển thị số trang đầy đủ\n");
      out.write("                    \"order\": [[7, \"desc\"]], // Sort by Ngày tạo (column 7) giảm dần - mới nhất lên đầu\n");
      out.write("                    \"columnDefs\": [\n");
      out.write("                        { \"orderable\": false, \"targets\": [0, 8] }, // Không sort cột ID và Thao tác\n");
      out.write("                        { \"orderData\": [7], \"targets\": 7 } // Sử dụng data-order attribute cho cột Ngày tạo để sắp xếp đúng\n");
      out.write("                    ],\n");
      out.write("                    \"autoWidth\": false,\n");
      out.write("                    \"responsive\": false,\n");
      out.write("                    \"processing\": false,\n");
      out.write("                    \"serverSide\": false,\n");
      out.write("                    \"deferRender\": false,\n");
      out.write("                    \"info\": true,\n");
      out.write("                    \"searching\": true\n");
      out.write("                });\n");
      out.write("            } else {\n");
      out.write("                // Nếu không có dữ liệu, vẫn khởi tạo DataTable để hiển thị thông báo\n");
      out.write("                table.DataTable({\n");
      out.write("                    \"language\": {\n");
      out.write("                        \"url\": \"//cdn.datatables.net/plug-ins/1.10.24/i18n/Vietnamese.json\"\n");
      out.write("                    },\n");
      out.write("                    \"paging\": false,\n");
      out.write("                    \"searching\": false,\n");
      out.write("                    \"info\": false\n");
      out.write("                });\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Xử lý click nút Xem\n");
      out.write("            $(document).on('click', '.view-ticket-btn', function() {\n");
      out.write("                var ticketId = $(this).data('ticket-id');\n");
      out.write("                loadTicketDetail(ticketId);\n");
      out.write("            });\n");
      out.write("\n");
      out.write("            // Xử lý click nút Sửa\n");
      out.write("            $(document).on('click', '.edit-ticket-btn', function() {\n");
      out.write("                var ticketId = $(this).data('ticket-id');\n");
      out.write("                loadTicketForEdit(ticketId);\n");
      out.write("            });\n");
      out.write("\n");
      out.write("            // Xử lý click nút Chuyển tiếp\n");
      out.write("            $(document).on('click', '.forward-ticket-btn', function() {\n");
      out.write("                var ticketId = $(this).data('ticket-id');\n");
      out.write("                loadTicketForForward(ticketId);\n");
      out.write("            });\n");
      out.write("\n");
      out.write("            // Xử lý submit form sửa\n");
      out.write("            $('#editTicketForm').on('submit', function(e) {\n");
      out.write("                e.preventDefault();\n");
      out.write("                saveTicketChanges();\n");
      out.write("            });\n");
      out.write("\n");
      out.write("            // Xử lý submit form chuyển tiếp\n");
      out.write("            $('#forwardTicketForm').on('submit', function(e) {\n");
      out.write("                e.preventDefault();\n");
      out.write("                forwardTicket();\n");
      out.write("            });\n");
      out.write("        });\n");
      out.write("\n");
      out.write("        function loadTicketDetail(ticketId) {\n");
      out.write("            // Hiển thị modal\n");
      out.write("            $('#viewTicketModal').modal('show');\n");
      out.write("            \n");
      out.write("            // Reset nội dung\n");
      out.write("            $('#ticketDetailContent').html('<div class=\"text-center\"><i class=\"fa fa-spinner fa-spin fa-3x\"></i><p>Đang tải dữ liệu...</p></div>');\n");
      out.write("            \n");
      out.write("            // Gọi AJAX\n");
      out.write("            $.ajax({\n");
      out.write("                url: 'support-detail',\n");
      out.write("                type: 'GET',\n");
      out.write("                data: { id: ticketId },\n");
      out.write("                dataType: 'json',\n");
      out.write("                success: function(response) {\n");
      out.write("                    if (response.success) {\n");
      out.write("                        console.log('Ticket data received:', response.data);\n");
      out.write("                        console.log('Deadline value:', response.data.deadline);\n");
      out.write("                        displayTicketDetail(response.data);\n");
      out.write("                    } else {\n");
      out.write("                        $('#ticketDetailContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> ' + response.message + '</div>');\n");
      out.write("                    }\n");
      out.write("                },\n");
      out.write("                error: function() {\n");
      out.write("                    $('#ticketDetailContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> Không thể tải dữ liệu. Vui lòng thử lại!</div>');\n");
      out.write("                }\n");
      out.write("            });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function displayTicketDetail(ticket) {\n");
      out.write("            // Định dạng category\n");
      out.write("            var categoryBadge = '';\n");
      out.write("            switch(ticket.category) {\n");
      out.write("                case 'technical': categoryBadge = '<span class=\"label label-info\">Kỹ thuật</span>'; break;\n");
      out.write("                case 'billing': categoryBadge = '<span class=\"label label-success\">Thanh toán</span>'; break;\n");
      out.write("                case 'general': categoryBadge = '<span class=\"label label-default\">Chung</span>'; break;\n");
      out.write("                case 'complaint': categoryBadge = '<span class=\"label label-danger\">Khiếu nại</span>'; break;\n");
      out.write("                default: categoryBadge = '<span class=\"label label-default\">' + ticket.category + '</span>';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Định dạng priority\n");
      out.write("            var priorityBadge = '';\n");
      out.write("            switch(ticket.priority) {\n");
      out.write("                case 'low': priorityBadge = '<span class=\"label label-info\">Thấp</span>'; break;\n");
      out.write("                case 'medium': priorityBadge = '<span class=\"label label-warning\">Trung bình</span>'; break;\n");
      out.write("                case 'high': priorityBadge = '<span class=\"label label-danger label-priority-high\">Cao</span>'; break;\n");
      out.write("                case 'urgent': priorityBadge = '<span class=\"label label-danger label-priority-urgent\">Khẩn cấp</span>'; break;\n");
      out.write("                default: priorityBadge = '<span class=\"label label-default\">' + ticket.priority + '</span>';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Định dạng status\n");
      out.write("            var statusBadge = '';\n");
      out.write("            switch(ticket.status) {\n");
      out.write("                case 'open': statusBadge = '<span class=\"label label-primary\">Đang chờ</span>'; break;\n");
      out.write("                case 'in_progress': statusBadge = '<span class=\"label label-primary label-status-in_progress\">Đang xử lý</span>'; break;\n");
      out.write("                case 'resolved':\n");
      out.write("                case 'closed': statusBadge = '<span class=\"label label-success\">Đã giải quyết</span>'; break;\n");
      out.write("                default: statusBadge = '<span class=\"label label-default\">' + ticket.status + '</span>';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Tách thông tin hợp đồng và sản phẩm từ description\n");
      out.write("            var description = ticket.description || '';\n");
      out.write("            var contractInfo = '';\n");
      out.write("            var productInfo = '';\n");
      out.write("            var cleanDescription = description;\n");
      out.write("            \n");
      out.write("            // Tìm thông tin hợp đồng: [Hợp đồng: ...]\n");
      out.write("            var contractMatch = description.match(/\\[Hợp đồng:([^\\]]+)\\]/);\n");
      out.write("            if (contractMatch) {\n");
      out.write("                contractInfo = contractMatch[1].trim();\n");
      out.write("                cleanDescription = cleanDescription.replace(/\\[Hợp đồng:[^\\]]+\\]\\s*/g, '').trim();\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Tìm thông tin sản phẩm: [Sản phẩm: ...]\n");
      out.write("            var productMatch = description.match(/\\[Sản phẩm:([^\\]]+)\\]/);\n");
      out.write("            if (productMatch) {\n");
      out.write("                productInfo = productMatch[1].trim();\n");
      out.write("                cleanDescription = cleanDescription.replace(/\\[Sản phẩm:[^\\]]+\\]\\s*/g, '').trim();\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            var html = '<div class=\"ticket-detail-view\">';\n");
      out.write("            \n");
      out.write("            // Header\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; margin-bottom: 20px; border-radius: 5px; border-left: 5px solid #3c8dbc;\">';\n");
      out.write("            html += '<h4 style=\"margin-top: 0;\"><strong>#' + escapeHtml(ticket.ticketNumber) + '</strong></h4>';\n");
      out.write("            html += '<h5>' + escapeHtml(ticket.subject) + '</h5>';\n");
      out.write("            html += '<div style=\"margin-top: 10px;\">';\n");
      out.write("            html += 'Trạng thái: ' + statusBadge + ' &nbsp; ';\n");
      out.write("            html += 'Độ ưu tiên: ' + priorityBadge + ' &nbsp; ';\n");
      out.write("            html += 'Danh mục: ' + categoryBadge;\n");
      out.write("            html += '</div></div>';\n");
      out.write("\n");
      out.write("            // Row 2 cột\n");
      out.write("            html += '<div class=\"row\">';\n");
      out.write("            \n");
      out.write("            // Cột trái - Chi tiết\n");
      out.write("            html += '<div class=\"col-md-8\">';\n");
      out.write("            \n");
      out.write("            // Hợp đồng và Sản phẩm (nếu có)\n");
      out.write("            if (contractInfo || productInfo) {\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\n");
      out.write("                html += '<h5 style=\"margin-bottom: 12px;\"><i class=\"fa fa-file-text\"></i> <strong>Hợp đồng & Sản phẩm</strong></h5>';\n");
      out.write("                html += '<div style=\"background: linear-gradient(135deg, #e7f3ff 0%, #d6e9f5 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #3c8dbc; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">';\n");
      out.write("                \n");
      out.write("                if (contractInfo) {\n");
      out.write("                    html += '<div style=\"margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid rgba(60, 141, 188, 0.2);\">';\n");
      out.write("                    html += '<div style=\"display: flex; align-items: flex-start; gap: 10px;\">';\n");
      out.write("                    html += '<div style=\"flex-shrink: 0; color: #3c8dbc; font-size: 18px; margin-top: 2px;\"><i class=\"fa fa-file-text-o\"></i></div>';\n");
      out.write("                    html += '<div style=\"flex: 1; min-width: 0;\">';\n");
      out.write("                    html += '<strong style=\"display: block; margin-bottom: 5px; color: #2c3e50; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px;\">Hợp đồng</strong>';\n");
      out.write("                    html += '<div style=\"word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; white-space: normal; font-size: 14px; color: #34495e; line-height: 1.5; max-width: 100%;\">' + escapeHtml(contractInfo) + '</div>';\n");
      out.write("                    html += '</div></div></div>';\n");
      out.write("                }\n");
      out.write("                \n");
      out.write("                if (productInfo) {\n");
      out.write("                    html += '<div style=\"padding-top: 0;\">';\n");
      out.write("                    html += '<div style=\"display: flex; align-items: flex-start; gap: 10px;\">';\n");
      out.write("                    html += '<div style=\"flex-shrink: 0; color: #27ae60; font-size: 18px; margin-top: 2px;\"><i class=\"fa fa-cube\"></i></div>';\n");
      out.write("                    html += '<div style=\"flex: 1; min-width: 0;\">';\n");
      out.write("                    html += '<strong style=\"display: block; margin-bottom: 5px; color: #2c3e50; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px;\">Sản phẩm</strong>';\n");
      out.write("                    html += '<div style=\"word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; white-space: normal; font-size: 14px; color: #34495e; line-height: 1.5; max-width: 100%;\">' + escapeHtml(productInfo) + '</div>';\n");
      out.write("                    html += '</div></div></div>';\n");
      out.write("                }\n");
      out.write("                \n");
      out.write("                html += '</div></div>';\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Mô tả (đã loại bỏ thông tin hợp đồng/sản phẩm)\n");
      out.write("            html += '<div style=\"margin-bottom: 20px;\">';\n");
      out.write("            html += '<h5 style=\"margin-bottom: 12px;\"><i class=\"fa fa-info-circle\"></i> <strong>Mô tả chi tiết</strong></h5>';\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; border-radius: 8px; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; overflow-wrap: break-word; max-width: 100%; line-height: 1.6; color: #2c3e50; border: 1px solid #e0e0e0;\">';\n");
      out.write("            html += escapeHtml(cleanDescription || 'Không có mô tả');\n");
      out.write("            html += '</div></div>';\n");
      out.write("\n");
      out.write("            // Giải pháp\n");
      out.write("            if (ticket.resolution) {\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\n");
      out.write("                html += '<h5><i class=\"fa fa-check-circle\"></i> <strong>Giải pháp / Kết quả xử lý</strong></h5>';\n");
      out.write("                html += '<div style=\"background: #d4edda; padding: 10px; border-radius: 3px; white-space: pre-wrap; word-wrap: break-word;\">';\n");
      out.write("                html += escapeHtml(ticket.resolution);\n");
      out.write("                html += '</div></div>';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Lịch sử\n");
      out.write("            if (ticket.history) {\n");
      out.write("                html += '<div style=\"margin-bottom: 20px;\">';\n");
      out.write("                html += '<h5><i class=\"fa fa-history\"></i> <strong>Lịch sử xử lý</strong></h5>';\n");
      out.write("                html += '<div style=\"background: #fff3cd; padding: 10px; border-radius: 3px; white-space: pre-wrap; word-wrap: break-word;\">';\n");
      out.write("                html += escapeHtml(ticket.history);\n");
      out.write("                html += '</div></div>';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            html += '</div>';\n");
      out.write("\n");
      out.write("            // Cột phải - Thông tin\n");
      out.write("            html += '<div class=\"col-md-4\">';\n");
      out.write("            \n");
      out.write("            // Thông tin khách hàng\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);\">';\n");
      out.write("            html += '<h5 style=\"margin-top: 0; margin-bottom: 15px; font-size: 16px; font-weight: 600; color: #2c3e50;\"><i class=\"fa fa-user\"></i> <strong>Thông tin khách hàng</strong></h5>';\n");
      out.write("            html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Công ty:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word;\">' + escapeHtml(ticket.customerName) + '</span></p>';\n");
      out.write("            html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Người liên hệ:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word;\">' + escapeHtml(ticket.customerContact) + '</span></p>';\n");
      out.write("            if (ticket.customerEmail) {\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Email:</strong><br><a href=\"mailto:' + escapeHtml(ticket.customerEmail) + '\" style=\"color: #3498db; font-size: 14px; word-break: break-all;\">' + escapeHtml(ticket.customerEmail) + '</a></p>';\n");
      out.write("            }\n");
      out.write("            if (ticket.customerPhone) {\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Số điện thoại:</strong><br><a href=\"tel:' + escapeHtml(ticket.customerPhone) + '\" style=\"color: #3498db; font-size: 14px; word-break: break-all;\">' + escapeHtml(ticket.customerPhone) + '</a></p>';\n");
      out.write("            }\n");
      out.write("            if (ticket.customerAddress) {\n");
      out.write("                html += '<p style=\"margin-bottom: 0; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Địa chỉ:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word; line-height: 1.5;\">' + escapeHtml(ticket.customerAddress) + '</span></p>';\n");
      out.write("            }\n");
      out.write("            html += '</div>';\n");
      out.write("\n");
      out.write("            // Thông tin ticket\n");
      out.write("            html += '<div style=\"background: #f9f9f9; padding: 15px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);\">';\n");
      out.write("            html += '<h5 style=\"margin-top: 0; margin-bottom: 15px; font-size: 16px; font-weight: 600; color: #2c3e50;\"><i class=\"fa fa-info\"></i> <strong>Thông tin ticket</strong></h5>';\n");
      out.write("            if (ticket.createdAt) {\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Ngày tạo:</strong><br><span style=\"color: #2c3e50; font-size: 14px;\">' + ticket.createdAt + '</span></p>';\n");
      out.write("            }\n");
      out.write("            // Hiển thị deadline - luôn hiển thị, nếu không có thì hiển thị \"Chưa có\"\n");
      out.write("            var deadlineDisplay = '';\n");
      out.write("            if (ticket.deadline && typeof ticket.deadline === 'string' && ticket.deadline.trim() !== '' && ticket.deadline !== 'null') {\n");
      out.write("                deadlineDisplay = escapeHtml(ticket.deadline);\n");
      out.write("            } else {\n");
      out.write("                deadlineDisplay = '<span style=\"color: #999; font-style: italic;\">Chưa có</span>';\n");
      out.write("            }\n");
      out.write("            html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Ngày mong muốn hoàn thành:</strong><br><span style=\"color: #2c3e50; font-size: 14px;\">' + deadlineDisplay + '</span></p>';\n");
      out.write("            if (ticket.resolvedAt) {\n");
      out.write("                html += '<p style=\"margin-bottom: 12px; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Ngày giải quyết:</strong><br><span style=\"color: #2c3e50; font-size: 14px;\">' + ticket.resolvedAt + '</span></p>';\n");
      out.write("            }\n");
      out.write("            if (ticket.assignedToName) {\n");
      out.write("                html += '<p style=\"margin-bottom: 0; word-wrap: break-word; overflow-wrap: break-word;\"><strong style=\"color: #34495e; font-size: 13px;\">Người xử lý:</strong><br><span style=\"color: #2c3e50; font-size: 14px; word-break: break-word;\">' + escapeHtml(ticket.assignedToName) + '</span>';\n");
      out.write("                if (ticket.assignedToEmail) {\n");
      out.write("                    html += '<br><small style=\"display: block; margin-top: 5px;\"><a href=\"mailto:' + escapeHtml(ticket.assignedToEmail) + '\" style=\"color: #3498db; word-break: break-all;\">' + escapeHtml(ticket.assignedToEmail) + '</a></small>';\n");
      out.write("                }\n");
      out.write("                html += '</p>';\n");
      out.write("            }\n");
      out.write("            html += '</div>';\n");
      out.write("\n");
      out.write("            html += '</div>';\n");
      out.write("            html += '</div>';\n");
      out.write("            html += '</div>';\n");
      out.write("\n");
      out.write("            $('#ticketDetailContent').html(html);\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function escapeHtml(text) {\n");
      out.write("            if (!text) return '';\n");
      out.write("            var map = {\n");
      out.write("                '&': '&amp;',\n");
      out.write("                '<': '&lt;',\n");
      out.write("                '>': '&gt;',\n");
      out.write("                '\"': '&quot;',\n");
      out.write("                \"'\": '&#039;'\n");
      out.write("            };\n");
      out.write("            return text.toString().replace(/[&<>\"']/g, function(m) { return map[m]; });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        // Load ticket để edit\n");
      out.write("        var currentEditTicketId = null;\n");
      out.write("        var currentTicketStatus = null; // Lưu trạng thái hiện tại của ticket\n");
      out.write("        \n");
      out.write("        function loadTicketForEdit(ticketId) {\n");
      out.write("            currentEditTicketId = ticketId;\n");
      out.write("            \n");
      out.write("            // Hiển thị modal\n");
      out.write("            $('#editTicketModal').modal('show');\n");
      out.write("            \n");
      out.write("            // Reset nội dung\n");
      out.write("            $('#editTicketContent').html('<div class=\"text-center\"><i class=\"fa fa-spinner fa-spin fa-3x\"></i><p>Đang tải dữ liệu...</p></div>');\n");
      out.write("            \n");
      out.write("            // Gọi AJAX\n");
      out.write("            $.ajax({\n");
      out.write("                url: 'support-detail',\n");
      out.write("                type: 'GET',\n");
      out.write("                data: { id: ticketId },\n");
      out.write("                dataType: 'json',\n");
      out.write("                success: function(response) {\n");
      out.write("                    if (response.success) {\n");
      out.write("                        currentTicketStatus = response.data.status; // Lưu trạng thái\n");
      out.write("                        displayEditForm(response.data);\n");
      out.write("                    } else {\n");
      out.write("                        $('#editTicketContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> ' + response.message + '</div>');\n");
      out.write("                    }\n");
      out.write("                },\n");
      out.write("                error: function() {\n");
      out.write("                    $('#editTicketContent').html('<div class=\"alert alert-danger\"><i class=\"fa fa-exclamation-triangle\"></i> Không thể tải dữ liệu. Vui lòng thử lại!</div>');\n");
      out.write("                }\n");
      out.write("            });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function displayEditForm(ticket) {\n");
      out.write("            var html = '<div class=\"row\">';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"col-md-6\">';\n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Mã Ticket:</label>';\n");
      out.write("            html += '<input type=\"text\" class=\"form-control\" value=\"' + escapeHtml(ticket.ticketNumber) + '\" readonly>';\n");
      out.write("            html += '</div></div>';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"col-md-6\">';\n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Khách hàng:</label>';\n");
      out.write("            html += '<input type=\"text\" class=\"form-control\" value=\"' + escapeHtml(ticket.customerName) + '\" readonly>';\n");
      out.write("            html += '</div></div>';\n");
      out.write("            \n");
      out.write("            html += '</div>'; // end row\n");
      out.write("            \n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Tiêu đề:</label>';\n");
      out.write("            html += '<input type=\"text\" class=\"form-control\" value=\"' + escapeHtml(ticket.subject) + '\" readonly>';\n");
      out.write("            html += '</div>';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Mô tả:</label>';\n");
      out.write("            html += '<textarea class=\"form-control\" rows=\"4\" readonly>' + escapeHtml(ticket.description) + '</textarea>';\n");
      out.write("            html += '</div>';\n");
      out.write("            \n");
      out.write("            html += '<hr>';\n");
      out.write("            html += '<h5><i class=\"fa fa-edit\"></i> <strong>Thông tin có thể cập nhật:</strong></h5>';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"row\">';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"col-md-4\">';\n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Danh mục:</label>';\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_category\" disabled>';\n");
      out.write("            html += '<option value=\"technical\"' + (ticket.category === 'technical' ? ' selected' : '') + '>Kỹ thuật</option>';\n");
      out.write("            html += '<option value=\"billing\"' + (ticket.category === 'billing' ? ' selected' : '') + '>Thanh toán</option>';\n");
      out.write("            html += '<option value=\"general\"' + (ticket.category === 'general' ? ' selected' : '') + '>Chung</option>';\n");
      out.write("            html += '<option value=\"complaint\"' + (ticket.category === 'complaint' ? ' selected' : '') + '>Khiếu nại</option>';\n");
      out.write("            html += '</select>';\n");
      out.write("            html += '<small class=\"text-muted\">Danh mục không thể thay đổi</small>';\n");
      out.write("            html += '</div></div>';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"col-md-4\">';\n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            // Độ ưu tiên không cho phép sửa - luôn disable\n");
      out.write("            html += '<label>Độ ưu tiên:</label>';\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_priority\" disabled>';\n");
      out.write("            html += '<option value=\"urgent\"' + (ticket.priority === 'urgent' ? ' selected' : '') + '>Khẩn cấp</option>';\n");
      out.write("            html += '<option value=\"high\"' + (ticket.priority === 'high' ? ' selected' : '') + '>Cao</option>';\n");
      out.write("            html += '<option value=\"medium\"' + (ticket.priority === 'medium' ? ' selected' : '') + '>Trung bình</option>';\n");
      out.write("            html += '<option value=\"low\"' + (ticket.priority === 'low' ? ' selected' : '') + '>Thấp</option>';\n");
      out.write("            html += '</select>';\n");
      out.write("            html += '<small class=\"text-muted\">Độ ưu tiên không thể thay đổi</small>';\n");
      out.write("            html += '</div></div>';\n");
      out.write("            \n");
      out.write("            html += '<div class=\"col-md-4\">';\n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Trạng thái:</label>';\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_status\" disabled>';\n");
      out.write("            html += '<option value=\"open\"' + (ticket.status === 'open' ? ' selected' : '') + '>Đang chờ</option>';\n");
      out.write("            html += '<option value=\"in_progress\"' + (ticket.status === 'in_progress' ? ' selected' : '') + '>Đang xử lý</option>';\n");
      out.write("            html += '<option value=\"resolved\"' + (ticket.status === 'resolved' || ticket.status === 'closed' ? ' selected' : '') + '>Đã giải quyết</option>';\n");
      out.write("            html += '</select>';\n");
      out.write("            html += '<small class=\"text-muted\">Trạng thái không thể thay đổi</small>';\n");
      out.write("            html += '</div></div>';\n");
      out.write("            \n");
      out.write("            html += '</div>'; // end row\n");
      out.write("            \n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Người nhận (Người xử lý):</label>';\n");
      out.write("            html += '<select class=\"form-control\" id=\"edit_assignedTo\" disabled>';\n");
      out.write("            html += '<option value=\"\">-- Chưa phân công --</option>';\n");
      out.write("            html += '</select>';\n");
      out.write("            html += '<small class=\"text-muted\">Người nhận không thể chỉnh sửa. Chỉ có thể thay đổi qua chức năng chuyển tiếp.</small>';\n");
      out.write("            html += '</div>';\n");
      out.write("            \n");
      out.write("            // Load danh sách head technicians vào dropdown (chỉ để hiển thị, không cho chỉnh sửa)\n");
      out.write("            loadHeadTechniciansForEdit(ticket.assignedTo);\n");
      out.write("            \n");
      out.write("            // Kiểm tra xem ticket đã được chuyển tiếp chưa (có assignedTo)\n");
      out.write("            var isAssigned = ticket.assignedTo && ticket.assignedTo !== '' && ticket.assignedTo !== null;\n");
      out.write("            \n");
      out.write("            html += '<div class=\"form-group\">';\n");
      out.write("            html += '<label>Giải pháp / Kết quả xử lý:</label>';\n");
      out.write("            if (!isAssigned) {\n");
      out.write("                html += '<div class=\"alert alert-warning\" style=\"margin-bottom: 10px;\">';\n");
      out.write("                html += '<i class=\"fa fa-exclamation-triangle\"></i> <strong>Lưu ý:</strong> Chỉ có thể nhập giải pháp và đóng ticket sau khi ticket đã được chuyển tiếp (phân công cho người xử lý).';\n");
      out.write("                html += '</div>';\n");
      out.write("            }\n");
      out.write("            html += '<textarea class=\"form-control\" rows=\"5\" id=\"edit_resolution\" placeholder=\"Nhập giải pháp hoặc kết quả xử lý...\" maxlength=\"10000\" ' + (isAssigned ? '' : 'readonly') + '>' + (ticket.resolution ? escapeHtml(ticket.resolution) : '') + '</textarea>';\n");
      out.write("            html += '<small class=\"text-muted\" id=\"resolution_word_count\">Số từ: 0 / 1000 từ</small>';\n");
      out.write("            html += '</div>';\n");
      out.write("            \n");
      out.write("            $('#editTicketContent').html(html);\n");
      out.write("            \n");
      out.write("            // Disable nút đóng ticket nếu chưa được chuyển tiếp\n");
      out.write("            if (!isAssigned) {\n");
      out.write("                $('#btnSaveTicket').prop('disabled', true).attr('title', 'Ticket chưa được chuyển tiếp. Vui lòng chuyển tiếp ticket trước khi đóng.');\n");
      out.write("            } else {\n");
      out.write("                $('#btnSaveTicket').prop('disabled', false).removeAttr('title');\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Thêm event listener để đếm số từ real-time\n");
      out.write("            $('#edit_resolution').on('input', function() {\n");
      out.write("                updateResolutionWordCount();\n");
      out.write("            });\n");
      out.write("            \n");
      out.write("            // Cập nhật số từ ban đầu\n");
      out.write("            updateResolutionWordCount();\n");
      out.write("        }\n");
      out.write("        \n");
      out.write("        function countWords(text) {\n");
      out.write("            if (!text || text.trim() === '') {\n");
      out.write("                return 0;\n");
      out.write("            }\n");
      out.write("            // Loại bỏ các khoảng trắng thừa và đếm số từ\n");
      out.write("            var trimmed = text.trim();\n");
      out.write("            if (trimmed === '') {\n");
      out.write("                return 0;\n");
      out.write("            }\n");
      out.write("            // Tách theo khoảng trắng và lọc các phần tử rỗng\n");
      out.write("            var words = trimmed.split(/\\s+/).filter(function(word) {\n");
      out.write("                return word.length > 0;\n");
      out.write("            });\n");
      out.write("            return words.length;\n");
      out.write("        }\n");
      out.write("        \n");
      out.write("        function updateResolutionWordCount() {\n");
      out.write("            var text = $('#edit_resolution').val() || '';\n");
      out.write("            var wordCount = countWords(text);\n");
      out.write("            var maxWords = 1000;\n");
      out.write("            var remaining = maxWords - wordCount;\n");
      out.write("            \n");
      out.write("            var countElement = $('#resolution_word_count');\n");
      out.write("            if (wordCount > maxWords) {\n");
      out.write("                countElement.removeClass('text-muted').addClass('text-danger');\n");
      out.write("                countElement.text('Số từ: ' + wordCount + ' / ' + maxWords + ' từ (Vượt quá ' + (wordCount - maxWords) + ' từ)');\n");
      out.write("            } else {\n");
      out.write("                countElement.removeClass('text-danger').addClass('text-muted');\n");
      out.write("                countElement.text('Số từ: ' + wordCount + ' / ' + maxWords + ' từ (Còn lại: ' + remaining + ' từ)');\n");
      out.write("            }\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function saveTicketChanges() {\n");
      out.write("            if (!currentEditTicketId) {\n");
      out.write("                alert('Lỗi: Không tìm thấy ID ticket');\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Kiểm tra ticket đã được chuyển tiếp chưa\n");
      out.write("            var assignedTo = $('#edit_assignedTo').val();\n");
      out.write("            if (!assignedTo || assignedTo === '' || assignedTo === null) {\n");
      out.write("                alert('Không thể đóng ticket! Ticket chưa được chuyển tiếp (phân công cho người xử lý).\\n\\nVui lòng chuyển tiếp ticket trước khi đóng.');\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Kiểm tra giải pháp xử lý\n");
      out.write("            var resolution = $('#edit_resolution').val();\n");
      out.write("            if (!resolution || resolution.trim() === '') {\n");
      out.write("                alert('Vui lòng nhập giải pháp xử lý trước khi đóng ticket!');\n");
      out.write("                $('#edit_resolution').focus();\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Kiểm tra số từ (tối đa 1000 từ)\n");
      out.write("            var wordCount = countWords(resolution);\n");
      out.write("            if (wordCount > 1000) {\n");
      out.write("                alert('Giải pháp xử lý không được vượt quá 1000 từ. Hiện tại bạn đã nhập ' + wordCount + ' từ. Vui lòng rút gọn nội dung.');\n");
      out.write("                $('#edit_resolution').focus();\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Disable button\n");
      out.write("            $('#btnSaveTicket').prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i> Đang xử lý...');\n");
      out.write("            \n");
      out.write("            // Lấy dữ liệu - nếu có resolution thì tự động set status = resolved\n");
      out.write("            var data = {\n");
      out.write("                id: currentEditTicketId,\n");
      out.write("                resolution: resolution,\n");
      out.write("                status: 'resolved' // Tự động set status thành resolved khi có resolution\n");
      out.write("            };\n");
      out.write("            \n");
      out.write("            // Submit AJAX với UTF-8\n");
      out.write("            $.ajax({\n");
      out.write("                url: 'support-update',\n");
      out.write("                type: 'POST',\n");
      out.write("                data: $.param(data), // Encode data properly\n");
      out.write("                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\n");
      out.write("                dataType: 'json',\n");
      out.write("                success: function(response) {\n");
      out.write("                    if (response.success) {\n");
      out.write("                        alert('✓ Đóng ticket thành công! Trạng thái đã được cập nhật thành \"Đã giải quyết\".');\n");
      out.write("                        $('#editTicketModal').modal('hide');\n");
      out.write("                        // Reload trang để cập nhật danh sách\n");
      out.write("                        location.reload();\n");
      out.write("                    } else {\n");
      out.write("                        alert('✗ ' + response.message);\n");
      out.write("                    }\n");
      out.write("                },\n");
      out.write("                error: function() {\n");
      out.write("                    alert('✗ Không thể đóng ticket. Vui lòng thử lại!');\n");
      out.write("                },\n");
      out.write("                complete: function() {\n");
      out.write("                    // Enable button\n");
      out.write("                    $('#btnSaveTicket').prop('disabled', false).html('<i class=\"fa fa-check-circle\"></i> Đóng ticket');\n");
      out.write("                }\n");
      out.write("            });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        // Load ticket để chuyển tiếp\n");
      out.write("        var currentForwardTicketId = null;\n");
      out.write("        var currentForwardPriority = null; // Lưu priority hiện tại của ticket\n");
      out.write("        \n");
      out.write("        function loadTicketForForward(ticketId) {\n");
      out.write("            currentForwardTicketId = ticketId;\n");
      out.write("            currentForwardPriority = null; // Reset priority\n");
      out.write("            \n");
      out.write("            // Reset form\n");
      out.write("            $('#forward_ticketNumber').val('');\n");
      out.write("            $('#forward_subject').val('');\n");
      out.write("            $('#forward_ticketId').val('');\n");
      out.write("            $('#forward_assignedTo').html('<option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>');\n");
      out.write("            $('#forward_priority').val('medium');\n");
      out.write("            $('#forward_deadline').val('');\n");
      out.write("            \n");
      out.write("            // Load thông tin ticket trước để kiểm tra status\n");
      out.write("            $.ajax({\n");
      out.write("                url: 'support-detail',\n");
      out.write("                type: 'GET',\n");
      out.write("                data: { id: ticketId },\n");
      out.write("                dataType: 'json',\n");
      out.write("                success: function(response) {\n");
      out.write("                    if (response.success) {\n");
      out.write("                        var ticket = response.data;\n");
      out.write("                        \n");
      out.write("                        // Kiểm tra: Nếu ticket đã resolved hoặc closed thì không cho phép chuyển tiếp\n");
      out.write("                        if (ticket.status === 'resolved' || ticket.status === 'closed') {\n");
      out.write("                            alert('✗ Không thể chuyển tiếp yêu cầu đã giải quyết!');\n");
      out.write("                            return;\n");
      out.write("                        }\n");
      out.write("                        \n");
      out.write("                        // Lưu priority hiện tại của ticket (không cho phép thay đổi)\n");
      out.write("                        currentForwardPriority = ticket.priority || 'medium';\n");
      out.write("                        \n");
      out.write("                        // Hiển thị modal nếu ticket chưa resolved/closed\n");
      out.write("                        $('#forwardTicketModal').modal('show');\n");
      out.write("                        \n");
      out.write("                        $('#forward_ticketNumber').val(ticket.ticketNumber);\n");
      out.write("                        $('#forward_subject').val(ticket.subject);\n");
      out.write("                        $('#forward_ticketId').val(ticket.id);\n");
      out.write("                        \n");
      out.write("                        // Set priority hiện tại (chỉ để hiển thị, không cho sửa)\n");
      out.write("                        if (ticket.priority) {\n");
      out.write("                            $('#forward_priority').val(ticket.priority);\n");
      out.write("                        } else {\n");
      out.write("                            $('#forward_priority').val('medium');\n");
      out.write("                        }\n");
      out.write("                        \n");
      out.write("                        // Set deadline (chỉ để hiển thị)\n");
      out.write("                        if (ticket.deadline && ticket.deadline.trim() !== '' && ticket.deadline !== 'null') {\n");
      out.write("                            $('#forward_deadline').val(ticket.deadline);\n");
      out.write("                        } else {\n");
      out.write("                            $('#forward_deadline').val('Chưa có');\n");
      out.write("                        }\n");
      out.write("                        \n");
      out.write("                        // Load danh sách head technicians\n");
      out.write("                        loadHeadTechnicians();\n");
      out.write("                    } else {\n");
      out.write("                        alert('✗ Không thể tải thông tin ticket: ' + response.message);\n");
      out.write("                    }\n");
      out.write("                },\n");
      out.write("                error: function() {\n");
      out.write("                    alert('✗ Không thể tải thông tin ticket. Vui lòng thử lại!');\n");
      out.write("                }\n");
      out.write("            });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function loadHeadTechnicians() {\n");
      out.write("            // Thử dùng URL tương đối trước (giống các API khác)\n");
      out.write("            var url1 = 'api/support-stats';\n");
      out.write("            // Fallback: dùng context path nếu cần\n");
      out.write("            var url2 = ctx + '/api/support-stats';\n");
      out.write("            \n");
      out.write("            function tryLoad(url, isFallback) {\n");
      out.write("                $.ajax({\n");
      out.write("                    url: url,\n");
      out.write("                    type: 'GET',\n");
      out.write("                    data: { action: 'getTechnicalStaff' },\n");
      out.write("                    dataType: 'json',\n");
      out.write("                    success: function(response) {\n");
      out.write("                        if (response && response.success && response.data) {\n");
      out.write("                            var select = $('#forward_assignedTo');\n");
      out.write("                            select.html('<option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>');\n");
      out.write("                            \n");
      out.write("                            response.data.forEach(function(tech) {\n");
      out.write("                                select.append('<option value=\"' + tech.id + '\">' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\n");
      out.write("                            });\n");
      out.write("                        } else {\n");
      out.write("                            var errorMsg = (response && response.message) ? response.message : 'Không thể tải danh sách trưởng phòng kỹ thuật';\n");
      out.write("                            if (!isFallback) {\n");
      out.write("                                // Thử fallback nếu chưa thử\n");
      out.write("                                tryLoad(url2, true);\n");
      out.write("                            } else {\n");
      out.write("                                alert('✗ ' + errorMsg);\n");
      out.write("                                console.error('Error loading head technicians:', response);\n");
      out.write("                            }\n");
      out.write("                        }\n");
      out.write("                    },\n");
      out.write("                    error: function(xhr, status, error) {\n");
      out.write("                        console.error('AJAX Error loading head technicians from ' + url + ':', {\n");
      out.write("                            status: status,\n");
      out.write("                            error: error,\n");
      out.write("                            responseText: xhr.responseText,\n");
      out.write("                            statusCode: xhr.status\n");
      out.write("                        });\n");
      out.write("                        if (!isFallback && url !== url2) {\n");
      out.write("                            // Thử fallback URL\n");
      out.write("                            console.log('Trying fallback URL:', url2);\n");
      out.write("                            tryLoad(url2, true);\n");
      out.write("                        } else {\n");
      out.write("                            // Fallback: thử dùng support-management\n");
      out.write("                            console.log('Trying support-management as last resort');\n");
      out.write("                            $.ajax({\n");
      out.write("                                url: 'support-management',\n");
      out.write("                                type: 'GET',\n");
      out.write("                                data: { action: 'getHeadTechnicians' },\n");
      out.write("                                dataType: 'json',\n");
      out.write("                                success: function(response) {\n");
      out.write("                                    if (response && response.success && response.data) {\n");
      out.write("                                        var select = $('#forward_assignedTo');\n");
      out.write("                                        select.html('<option value=\"\">-- Chọn trưởng phòng kỹ thuật --</option>');\n");
      out.write("                                        response.data.forEach(function(tech) {\n");
      out.write("                                            select.append('<option value=\"' + tech.id + '\">' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\n");
      out.write("                                        });\n");
      out.write("                                    } else {\n");
      out.write("                                        alert('✗ Không thể tải danh sách trưởng phòng kỹ thuật. Vui lòng thử lại!');\n");
      out.write("                                    }\n");
      out.write("                                },\n");
      out.write("                                error: function() {\n");
      out.write("                                    alert('✗ Không thể tải danh sách trưởng phòng kỹ thuật. Vui lòng thử lại! (Status: ' + xhr.status + ')');\n");
      out.write("                                }\n");
      out.write("                            });\n");
      out.write("                        }\n");
      out.write("                    }\n");
      out.write("                });\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Bắt đầu với URL tương đối\n");
      out.write("            tryLoad(url1, false);\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function forwardTicket() {\n");
      out.write("            var ticketId = $('#forward_ticketId').val();\n");
      out.write("            var assignedToId = $('#forward_assignedTo').val();\n");
      out.write("            // Lấy priority từ ticket hiện tại (không từ form vì đã disabled)\n");
      out.write("            var priority = currentForwardPriority || 'medium';\n");
      out.write("            \n");
      out.write("            if (!ticketId || !assignedToId) {\n");
      out.write("                alert('✗ Vui lòng chọn trưởng phòng kỹ thuật');\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("            // Disable button\n");
      out.write("            $('#btnForwardTicket').prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i> Đang chuyển tiếp...');\n");
      out.write("            \n");
      out.write("            // Submit AJAX - gọi SupportStatsServlet\n");
      out.write("            // Gửi priority hiện tại của ticket (không cho phép thay đổi)\n");
      out.write("            $.ajax({\n");
      out.write("                url: 'api/support-stats',  // Dùng URL tương đối\n");
      out.write("                type: 'POST',\n");
      out.write("                data: {\n");
      out.write("                    action: 'forward',\n");
      out.write("                    id: ticketId,  // SupportStatsServlet dùng 'id' thay vì 'ticketId'\n");
      out.write("                    assignedTo: assignedToId,  // SupportStatsServlet dùng 'assignedTo' thay vì 'assignedToId'\n");
      out.write("                    forwardPriority: priority,  // Dùng priority hiện tại của ticket (không cho phép thay đổi)\n");
      out.write("                    forwardNote: ''  // Có thể thêm ghi chú nếu cần\n");
      out.write("                },\n");
      out.write("                dataType: 'json',\n");
      out.write("                success: function(response) {\n");
      out.write("                    if (response.success) {\n");
      out.write("                        alert('✓ ' + response.message);\n");
      out.write("                        $('#forwardTicketModal').modal('hide');\n");
      out.write("                        // Reload trang để cập nhật danh sách\n");
      out.write("                        location.reload();\n");
      out.write("                    } else {\n");
      out.write("                        alert('✗ ' + response.message);\n");
      out.write("                    }\n");
      out.write("                },\n");
      out.write("                error: function() {\n");
      out.write("                    alert('✗ Không thể chuyển tiếp ticket. Vui lòng thử lại!');\n");
      out.write("                },\n");
      out.write("                complete: function() {\n");
      out.write("                    // Enable button\n");
      out.write("                    $('#btnForwardTicket').prop('disabled', false).html('<i class=\"fa fa-share\"></i> Chuyển tiếp');\n");
      out.write("                }\n");
      out.write("            });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("        function loadHeadTechniciansForEdit(currentAssignedTo) {\n");
      out.write("            // Thử dùng support-management vì getHeadTechnicians vẫn còn trong handleApiRequest\n");
      out.write("            $.ajax({\n");
      out.write("                url: 'support-management',\n");
      out.write("                type: 'GET',\n");
      out.write("                data: { action: 'getHeadTechnicians' },\n");
      out.write("                dataType: 'json',\n");
      out.write("                success: function(response) {\n");
      out.write("                    if (response && response.success && response.data) {\n");
      out.write("                        var select = $('#edit_assignedTo');\n");
      out.write("                        select.html('<option value=\"\">-- Chưa phân công --</option>');\n");
      out.write("                        \n");
      out.write("                        response.data.forEach(function(tech) {\n");
      out.write("                            var selected = (currentAssignedTo && currentAssignedTo == tech.id) ? ' selected' : '';\n");
      out.write("                            select.append('<option value=\"' + tech.id + '\"' + selected + '>' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\n");
      out.write("                        });\n");
      out.write("                    } else {\n");
      out.write("                        // Fallback: thử api/support-stats\n");
      out.write("                        $.ajax({\n");
      out.write("                            url: 'api/support-stats',\n");
      out.write("                            type: 'GET',\n");
      out.write("                            data: { action: 'getTechnicalStaff' },\n");
      out.write("                            dataType: 'json',\n");
      out.write("                            success: function(response2) {\n");
      out.write("                                if (response2 && response2.success && response2.data) {\n");
      out.write("                                    var select = $('#edit_assignedTo');\n");
      out.write("                                    select.html('<option value=\"\">-- Chưa phân công --</option>');\n");
      out.write("                                    response2.data.forEach(function(tech) {\n");
      out.write("                                        var selected = (currentAssignedTo && currentAssignedTo == tech.id) ? ' selected' : '';\n");
      out.write("                                        select.append('<option value=\"' + tech.id + '\"' + selected + '>' + escapeHtml(tech.name) + ' (' + escapeHtml(tech.email) + ')</option>');\n");
      out.write("                                    });\n");
      out.write("                                }\n");
      out.write("                            },\n");
      out.write("                            error: function() {\n");
      out.write("                                console.error('Error loading head technicians for edit');\n");
      out.write("                            }\n");
      out.write("                        });\n");
      out.write("                    }\n");
      out.write("                },\n");
      out.write("                error: function(xhr, status, error) {\n");
      out.write("                    console.error('AJAX Error loading head technicians for edit:', {\n");
      out.write("                        status: status,\n");
      out.write("                        error: error,\n");
      out.write("                        responseText: xhr.responseText,\n");
      out.write("                        statusCode: xhr.status\n");
      out.write("                    });\n");
      out.write("                }\n");
      out.write("            });\n");
      out.write("        }\n");
      out.write("\n");
      out.write("    </script>\n");
      out.write("</body>\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }

  private boolean _jspx_meth_c_005fchoose_005f0(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f0 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f0.setParent(null);
    int _jspx_eval_c_005fchoose_005f0 = _jspx_th_c_005fchoose_005f0.doStartTag();
    if (_jspx_eval_c_005fchoose_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                            ");
        if (_jspx_meth_c_005fwhen_005f0(_jspx_th_c_005fchoose_005f0, _jspx_page_context))
          return true;
        out.write("\n");
        out.write("                                            ");
        if (_jspx_meth_c_005fotherwise_005f4(_jspx_th_c_005fchoose_005f0, _jspx_page_context))
          return true;
        out.write("\n");
        out.write("                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f0 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f0);
    // /support_management.jsp(284,44) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f0.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${not empty tickets}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f0 = _jspx_th_c_005fwhen_005f0.doStartTag();
    if (_jspx_eval_c_005fwhen_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                ");
        if (_jspx_meth_c_005fforEach_005f0(_jspx_th_c_005fwhen_005f0, _jspx_page_context))
          return true;
        out.write("\n");
        out.write("                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fforEach_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fwhen_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:forEach
    org.apache.taglibs.standard.tag.rt.core.ForEachTag _jspx_th_c_005fforEach_005f0 = (org.apache.taglibs.standard.tag.rt.core.ForEachTag) _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvar_005fitems.get(org.apache.taglibs.standard.tag.rt.core.ForEachTag.class);
    _jspx_th_c_005fforEach_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fforEach_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fwhen_005f0);
    // /support_management.jsp(285,48) name = var type = java.lang.String reqTime = false required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fforEach_005f0.setVar("ticket");
    // /support_management.jsp(285,48) name = items type = javax.el.ValueExpression reqTime = true required = false fragment = false deferredValue = true expectedTypeName = java.lang.Object deferredMethod = false methodSignature = null
    _jspx_th_c_005fforEach_005f0.setItems(new org.apache.jasper.el.JspValueExpression("/support_management.jsp(285,48) '${tickets}'",_el_expressionfactory.createValueExpression(_jspx_page_context.getELContext(),"${tickets}",java.lang.Object.class)).getValue(_jspx_page_context.getELContext()));
    int[] _jspx_push_body_count_c_005fforEach_005f0 = new int[] { 0 };
    try {
      int _jspx_eval_c_005fforEach_005f0 = _jspx_th_c_005fforEach_005f0.doStartTag();
      if (_jspx_eval_c_005fforEach_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
        do {
          out.write("\n");
          out.write("                                                <tr class=\"ticket-priority-");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\">\n");
          out.write("                                                    <td>");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</td>\n");
          out.write("                                                    <td><strong>#");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.ticketNumber}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</strong></td>\n");
          out.write("                                                    <td>");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${not empty ticket.customerName ? ticket.customerName : 'N/A'}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</td>\n");
          out.write("                                                    <td>");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.subject}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("</td>\n");
          out.write("                                                    <td>\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f1(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\n");
          out.write("                                                    </td>\n");
          out.write("                                                    <td>\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f2(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\n");
          out.write("                                                    </td>\n");
          out.write("                                                    <td>\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f3(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\n");
          out.write("                                                    </td>\n");
          out.write("                                                    <td data-order=\"");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.createdAt != null ? ticket.createdAt.time : 0}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\">\n");
          out.write("                                                        ");
          if (_jspx_meth_fmt_005fformatDate_005f0(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\n");
          out.write("                                                    </td>\n");
          out.write("                                                    <td>\n");
          out.write("                                                        <button class=\"btn btn-info btn-xs view-ticket-btn\" data-ticket-id=\"");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\" title=\"Xem chi tiết\">\n");
          out.write("                                                            <i class=\"fa fa-eye\"></i> Xem\n");
          out.write("                                                        </button>\n");
          out.write("                                                        <button class=\"btn btn-warning btn-xs edit-ticket-btn\" data-ticket-id=\"");
          out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
          out.write("\" title=\"Chỉnh sửa\">\n");
          out.write("                                                            <i class=\"fa fa-edit\"></i> Sửa\n");
          out.write("                                                        </button>\n");
          out.write("                                                        ");
          if (_jspx_meth_c_005fchoose_005f4(_jspx_th_c_005fforEach_005f0, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
            return true;
          out.write("\n");
          out.write("                                                    </td>\n");
          out.write("                                                </tr>\n");
          out.write("                                                ");
          int evalDoAfterBody = _jspx_th_c_005fforEach_005f0.doAfterBody();
          if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
            break;
        } while (true);
      }
      if (_jspx_th_c_005fforEach_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
    } catch (java.lang.Throwable _jspx_exception) {
      while (_jspx_push_body_count_c_005fforEach_005f0[0]-- > 0)
        out = _jspx_page_context.popBody();
      _jspx_th_c_005fforEach_005f0.doCatch(_jspx_exception);
    } finally {
      _jspx_th_c_005fforEach_005f0.doFinally();
      _005fjspx_005ftagPool_005fc_005fforEach_0026_005fvar_005fitems.reuse(_jspx_th_c_005fforEach_005f0);
    }
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f1 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f1.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f1 = _jspx_th_c_005fchoose_005f1.doStartTag();
    if (_jspx_eval_c_005fchoose_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f1(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f2(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f3(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f4(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f0(_jspx_th_c_005fchoose_005f1, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f1.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f1);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f1);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f1 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f1.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    // /support_management.jsp(293,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f1.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'technical'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f1 = _jspx_th_c_005fwhen_005f1.doStartTag();
    if (_jspx_eval_c_005fwhen_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-info'>Kỹ thuật</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f1.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f1);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f1);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f2 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f2.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    // /support_management.jsp(296,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f2.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'billing'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f2 = _jspx_th_c_005fwhen_005f2.doStartTag();
    if (_jspx_eval_c_005fwhen_005f2 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-success'>Thanh toán</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f2.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f2);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f2);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f3 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f3.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    // /support_management.jsp(299,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f3.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'general'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f3 = _jspx_th_c_005fwhen_005f3.doStartTag();
    if (_jspx_eval_c_005fwhen_005f3 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-default'>Chung</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f3.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f3);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f3);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f4 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f4.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    // /support_management.jsp(302,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f4.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category == 'complaint'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f4 = _jspx_th_c_005fwhen_005f4.doStartTag();
    if (_jspx_eval_c_005fwhen_005f4 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-danger'>Khiếu nại</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f4.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f4);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f4);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f1, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f0 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f0.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f1);
    int _jspx_eval_c_005fotherwise_005f0 = _jspx_th_c_005fotherwise_005f0.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-default'>");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.category}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f2 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f2.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f2 = _jspx_th_c_005fchoose_005f2.doStartTag();
    if (_jspx_eval_c_005fchoose_005f2 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f5(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f6(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f7(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f8(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f1(_jspx_th_c_005fchoose_005f2, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f2.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f2);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f2);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f5 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f5.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(312,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f5.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'low'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f5 = _jspx_th_c_005fwhen_005f5.doStartTag();
    if (_jspx_eval_c_005fwhen_005f5 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-info'>Thấp</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f5.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f5);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f5);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f6(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f6 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f6.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f6.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(315,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f6.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'medium'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f6 = _jspx_th_c_005fwhen_005f6.doStartTag();
    if (_jspx_eval_c_005fwhen_005f6 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-warning'>Trung bình</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f6.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f6.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f6);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f6);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f7(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f7 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f7.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f7.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(318,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f7.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'high'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f7 = _jspx_th_c_005fwhen_005f7.doStartTag();
    if (_jspx_eval_c_005fwhen_005f7 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-danger label-priority-high'>Cao</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f7.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f7.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f7);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f7);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f8(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f8 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f8.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f8.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    // /support_management.jsp(321,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f8.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority == 'urgent'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f8 = _jspx_th_c_005fwhen_005f8.doStartTag();
    if (_jspx_eval_c_005fwhen_005f8 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-danger label-priority-urgent'>Khẩn cấp</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f8.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f8.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f8);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f8);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f2, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f1 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f1.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f2);
    int _jspx_eval_c_005fotherwise_005f1 = _jspx_th_c_005fotherwise_005f1.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-default'>");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.priority}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f1.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f1);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f1);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f3 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f3.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f3 = _jspx_th_c_005fchoose_005f3.doStartTag();
    if (_jspx_eval_c_005fchoose_005f3 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f9(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f10(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f11(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f2(_jspx_th_c_005fchoose_005f3, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f3.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f3);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f3);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f9(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f9 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f9.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f9.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(331,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f9.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'open'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f9 = _jspx_th_c_005fwhen_005f9.doStartTag();
    if (_jspx_eval_c_005fwhen_005f9 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-primary'>Đang chờ</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f9.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f9.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f9);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f9);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f10(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f10 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f10.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f10.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(334,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f10.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'in_progress'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f10 = _jspx_th_c_005fwhen_005f10.doStartTag();
    if (_jspx_eval_c_005fwhen_005f10 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-primary label-status-in_progress'>Đang xử lý</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f10.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f10.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f10);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f10);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f11(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f11 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f11.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f11.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    // /support_management.jsp(337,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f11.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'resolved' || ticket.status == 'closed'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f11 = _jspx_th_c_005fwhen_005f11.doStartTag();
    if (_jspx_eval_c_005fwhen_005f11 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-success'>Đã giải quyết</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f11.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f11.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f11);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f11);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f3, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f2 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f2.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f3);
    int _jspx_eval_c_005fotherwise_005f2 = _jspx_th_c_005fotherwise_005f2.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f2 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <span class='label label-default'>");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("</span>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f2.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f2);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f2);
    return false;
  }

  private boolean _jspx_meth_fmt_005fformatDate_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  fmt:formatDate
    org.apache.taglibs.standard.tag.rt.fmt.FormatDateTag _jspx_th_fmt_005fformatDate_005f0 = (org.apache.taglibs.standard.tag.rt.fmt.FormatDateTag) _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.get(org.apache.taglibs.standard.tag.rt.fmt.FormatDateTag.class);
    _jspx_th_fmt_005fformatDate_005f0.setPageContext(_jspx_page_context);
    _jspx_th_fmt_005fformatDate_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    // /support_management.jsp(346,56) name = value type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_fmt_005fformatDate_005f0.setValue((java.util.Date) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.createdAt}", java.util.Date.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
    // /support_management.jsp(346,56) name = pattern type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_fmt_005fformatDate_005f0.setPattern("dd/MM/yyyy HH:mm");
    int _jspx_eval_fmt_005fformatDate_005f0 = _jspx_th_fmt_005fformatDate_005f0.doStartTag();
    if (_jspx_th_fmt_005fformatDate_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.reuse(_jspx_th_fmt_005fformatDate_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005ffmt_005fformatDate_0026_005fvalue_005fpattern_005fnobody.reuse(_jspx_th_fmt_005fformatDate_005f0);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fforEach_005f0, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f4 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f4.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fforEach_005f0);
    int _jspx_eval_c_005fchoose_005f4 = _jspx_th_c_005fchoose_005f4.doStartTag();
    if (_jspx_eval_c_005fchoose_005f4 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f12(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f3(_jspx_th_c_005fchoose_005f4, _jspx_page_context, _jspx_push_body_count_c_005fforEach_005f0))
          return true;
        out.write("\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f4.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f4);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f4);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f12(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f12 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f12.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f12.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    // /support_management.jsp(356,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f12.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.status == 'resolved' || ticket.status == 'closed'}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f12 = _jspx_th_c_005fwhen_005f12.doStartTag();
    if (_jspx_eval_c_005fwhen_005f12 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <button class=\"btn btn-success btn-xs\" disabled title=\"Không thể chuyển tiếp yêu cầu đã giải quyết\">\n");
        out.write("                                                                    <i class=\"fa fa-share\"></i> Chuyển tiếp\n");
        out.write("                                                                </button>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f12.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f12.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f12);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f12);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f4, javax.servlet.jsp.PageContext _jspx_page_context, int[] _jspx_push_body_count_c_005fforEach_005f0)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f3 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f3.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f4);
    int _jspx_eval_c_005fotherwise_005f3 = _jspx_th_c_005fotherwise_005f3.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f3 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                <button class=\"btn btn-success btn-xs forward-ticket-btn\" data-ticket-id=\"");
        out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ticket.id}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
        out.write("\" title=\"Chuyển tiếp cho trưởng phòng kỹ thuật\">\n");
        out.write("                                                                    <i class=\"fa fa-share\"></i> Chuyển tiếp\n");
        out.write("                                                                </button>\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f3.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f3);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f3);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f4 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f4.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f0);
    int _jspx_eval_c_005fotherwise_005f4 = _jspx_th_c_005fotherwise_005f4.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f4 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                <tr>\n");
        out.write("                                                    <td colspan=\"9\" class=\"text-center\">\n");
        out.write("                                                        <i class=\"fa fa-info-circle\"></i> \n");
        out.write("                                                        ");
        if (_jspx_meth_c_005fchoose_005f5(_jspx_th_c_005fotherwise_005f4, _jspx_page_context))
          return true;
        out.write("\n");
        out.write("                                                    </td>\n");
        out.write("                                                </tr>\n");
        out.write("                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f4.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f4);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f4);
    return false;
  }

  private boolean _jspx_meth_c_005fchoose_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fotherwise_005f4, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:choose
    org.apache.taglibs.standard.tag.common.core.ChooseTag _jspx_th_c_005fchoose_005f5 = (org.apache.taglibs.standard.tag.common.core.ChooseTag) _005fjspx_005ftagPool_005fc_005fchoose.get(org.apache.taglibs.standard.tag.common.core.ChooseTag.class);
    _jspx_th_c_005fchoose_005f5.setPageContext(_jspx_page_context);
    _jspx_th_c_005fchoose_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fotherwise_005f4);
    int _jspx_eval_c_005fchoose_005f5 = _jspx_th_c_005fchoose_005f5.doStartTag();
    if (_jspx_eval_c_005fchoose_005f5 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fwhen_005f13(_jspx_th_c_005fchoose_005f5, _jspx_page_context))
          return true;
        out.write("\n");
        out.write("                                                            ");
        if (_jspx_meth_c_005fotherwise_005f5(_jspx_th_c_005fchoose_005f5, _jspx_page_context))
          return true;
        out.write("\n");
        out.write("                                                        ");
        int evalDoAfterBody = _jspx_th_c_005fchoose_005f5.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fchoose_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f5);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fchoose.reuse(_jspx_th_c_005fchoose_005f5);
    return false;
  }

  private boolean _jspx_meth_c_005fwhen_005f13(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f5, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:when
    org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f13 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
    _jspx_th_c_005fwhen_005f13.setPageContext(_jspx_page_context);
    _jspx_th_c_005fwhen_005f13.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f5);
    // /support_management.jsp(376,60) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_c_005fwhen_005f13.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${not empty param.status or not empty param.priority or not empty param.category}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
    int _jspx_eval_c_005fwhen_005f13 = _jspx_th_c_005fwhen_005f13.doStartTag();
    if (_jspx_eval_c_005fwhen_005f13 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                Không tìm thấy yêu cầu hỗ trợ phù hợp với bộ lọc\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fwhen_005f13.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fwhen_005f13.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f13);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f13);
    return false;
  }

  private boolean _jspx_meth_c_005fotherwise_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f5, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:otherwise
    org.apache.taglibs.standard.tag.common.core.OtherwiseTag _jspx_th_c_005fotherwise_005f5 = (org.apache.taglibs.standard.tag.common.core.OtherwiseTag) _005fjspx_005ftagPool_005fc_005fotherwise.get(org.apache.taglibs.standard.tag.common.core.OtherwiseTag.class);
    _jspx_th_c_005fotherwise_005f5.setPageContext(_jspx_page_context);
    _jspx_th_c_005fotherwise_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f5);
    int _jspx_eval_c_005fotherwise_005f5 = _jspx_th_c_005fotherwise_005f5.doStartTag();
    if (_jspx_eval_c_005fotherwise_005f5 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\n");
        out.write("                                                                Chưa có yêu cầu hỗ trợ nào\n");
        out.write("                                                            ");
        int evalDoAfterBody = _jspx_th_c_005fotherwise_005f5.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_c_005fotherwise_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f5);
      return true;
    }
    _005fjspx_005ftagPool_005fc_005fotherwise.reuse(_jspx_th_c_005fotherwise_005f5);
    return false;
  }
}
